<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[ç¼–è¯‘microä¸€æ³¢ä¸‰æŠ˜]]></title>
    <url>%2F2019%2F07%2F12%2F%E7%BC%96%E8%AF%91micro%E4%B8%80%E6%B3%A2%E4%B8%89%E6%8A%98%2F</url>
    <content type="text"><![CDATA[èƒŒæ™¯ç”±äºŽæœ¬æœºä¸Šmicroç‰ˆæœ¬è¾ƒä½Žï¼Œå…¶å®žæœ¬æœºç‰ˆæœ¬æ˜¯0.13.0ï¼Œç„¶åŽç”¨è¿™ä¸ªç‰ˆæœ¬å‘½ä»¤è¡Œè°ƒç”¨è¿œç¨‹rpcä¸€ç›´æŠ¥ï¼š 123456&#123; "id": "go.micro.client.codec", "code": 500, "detail": "json: cannot unmarshal string into Go struct field clientResponse.id of type uint64", "status": "Internal Server Error"&#125; æ•…éœ€è¦å‡çº§æœ¬æœºmicroç‰ˆæœ¬ã€‚ å‡çº§ç‰ˆæœ¬: 1.5.0 å‡çº§è¿‡ç¨‹å¯è°“ä¸€æ³¢ä¸‰æŠ˜ï¼Œå‘ä¸­æœ‰å‘å•Šã€‚ä»¥ä¸‹å†…å®¹å¯èƒ½ä¼šè®©ä½ æœ‰ç ¸ç”µè„‘çš„å†²åŠ¨ï¼Œè¯·ä¸‰æ€è€ŒåŽè¡Œ1234567891011121314151617181920212223242526272829303132333435363738394041424344## ä¸‹é¢ç®€å•ä»‹ç»ä¸€ä¸‹å‡çº§è¿‡ç¨‹```// æ‹‰å–microæºç åˆ°æœ¬åœ°git clone https://github.com/micro/micro.git// åˆ‡æ¢åˆ°v1.6.0ç‰ˆæœ¬git checkout v1.6.0// æœ¬åœ°åŸºäºŽv1.6.0ç‰ˆæœ¬åˆ›å»ºä¸€ä¸ªæ–°çš„v1.6.0ç‰ˆæœ¬åˆ†æ”¯git checkout -b v1.6.0```ä»¥ä¸Šæ­¥éª¤æ“ä½œå®Œæˆä¹‹åŽå·²åœ¨æœ¬åœ°åˆ›å»ºäº†microçš„v1.6.0ç‰ˆæœ¬åˆ†æ”¯ï¼Œä¸‹é¢æˆ‘ä»¬ä¼šåŸºäºŽè¿™ä¸ªåˆ†æ”¯æ¥ç¼–è¯‘microã€‚------------------ç”±äºŽæœ¬åœ°é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†microçš„ç¬¬ä¸‰æ–¹pluginï¼Œå…·ä½“åŒ…å«:**registry** ï¼š`etcdv3` **transport** ï¼š`tcp`æ‰€ä»¥åœ¨ç¼–è¯‘microçš„æ—¶å€™éœ€è¦å°†è¿™ä¸¤ä¸ªæ’ä»¶åŒ…å«è¿›æ¥ã€‚æˆ‘ä»¬éœ€è¦åœ¨æºç ç›®å½•ä¸­åˆ›å»º `plugins.go` æ–‡ä»¶ç”¨æ¥å¼•ç”¨è¿™äº›pluginï¼Œæ–‡ä»¶ç›®å½•ä¸ºmicroæºç æ ¹ç›®å½•ï¼Œå¦‚ä¸‹ï¼š```Dockerfile README.md bot cmd go.sum main.go new plugins.go scripts webLICENSE api cli go.mod internal network plugin proxy service```åœ¨æºç ç›®å½•ä¸­æ–°å¢žäº†ä¸€ä¸ª `plugins.go` æ–‡ä»¶ï¼Œ æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š```golangpackage mainimport ( _ &quot;github.com/micro/go-plugins/registry/etcdv3&quot; _ &quot;github.com/micro/go-plugins/transport/tcp&quot;)```æ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œåªè¦å°†ä¾èµ–çš„æ’ä»¶åŒ…å¼•ç”¨è¿›æ¥å³å¯ï¼Œ666~~~ å¥½äº†ï¼Œä¸Šé¢æ–‡ä»¶å·²ç»åˆ›å»ºå¥½äº†ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å°è¯•ç¼–è¯‘microäº†ï¼Œè¯ä¸å¤šè¯´ï¼Œè¡ŒåŠ¨èµ·æ¥å§ 12// åœ¨æºç æ ¹ç›®å½•è¿è¡Œå¦‚ä¸‹å‘½ä»¤GO111MODULE=on go build -i -o micro main.go plugins.go ä½†æ˜¯ï¼ŒçŽ°å®žæ€»æ˜¯æ®‹é…·çš„ï¼Œæˆ‘ä»¬çœ‹åˆ°æŠ¥äº†å¦‚ä¸‹é”™è¯¯ï¼š 1234567go: finding github.com/micro/go-plugins/registry/etcdv3 latestgo: finding github.com/micro/go-plugins/transport/tcp latestgo: finding github.com/micro/go-plugins/registry latestgo: finding github.com/micro/go-plugins/transport latestgo: finding github.com/nats-io/nats.go v1.8.2-0.20190607221125-9f4d16fe7c2dgo: github.com/nats-io/nats.go@v1.8.2-0.20190607221125-9f4d16fe7c2d: unknown revision 9f4d16fe7c2dgo: error loading module requirements å‘çŽ°æ— æ³•è¯†åˆ« github.com/nats-io/nats.go@v1.8.2-0.20190607221125-9f4d16fe7c2d ä»Žgithubä¸­æŸ¥çœ‹github.com/nats-io/nats.goä»“åº“ï¼Œå‘çŽ°ç›®å‰æœ€æ–°çš„releaseç‰ˆæœ¬ä¸ºv1.8.1ï¼ŒåŽ‹æ ¹å„¿å°±æ²¡æœ‰v1.8.2ç‰ˆæœ¬ã€‚ ç„¶åŽå¼€å§‹ä»Žæºç ä¸­æŸ¥æ‰¾å“ªé‡Œä¾èµ–äº†è¿™ä¸ªç‰ˆæœ¬çš„ä»“åº“ï¼Œå‘çŽ° go-plugins@v1.1.1 ä¾èµ–äº†ã€‚ å°è¯•å¦‚ä½•è§£å†³ï¼Œé¦–å…ˆæŸ¥çœ‹microæºç ä¸­çš„go.modæ–‡ä»¶ä¸­æ˜¯å¦æœ‰ä¾èµ– go-plugins@v1.1.1ï¼Œ å†…å®¹å¦‚ä¸‹ï¼š 1234567891011121314151617module github.com/micro/microgo 1.12require ( github.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e github.com/golang/protobuf v1.3.1 github.com/google/uuid v1.1.1 github.com/gorilla/mux v1.7.2 github.com/micro/cli v0.2.0 github.com/micro/go-micro v1.6.0 github.com/serenize/snaker v0.0.0-20171204205717-a683aaf2d516 github.com/xlab/treeprint v0.0.0-20181112141820-a009c3971eca golang.org/x/net v0.0.0-20190606173856-1492cefac77f google.golang.org/genproto v0.0.0-20180831171423-11092d34479b // indirect google.golang.org/grpc v1.21.1) å‘çŽ°å¹¶æ²¡æœ‰ä¾èµ–ï¼Œæ‰€ä»¥ä¹‹å‰ç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨äº†æœ€æ–°çš„ç‰ˆæœ¬ã€‚æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹go-pluginsç‰ˆæœ¬ï¼š 123456789101112131415161718module github.com/micro/microgo 1.12require ( github.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e github.com/golang/protobuf v1.3.1 github.com/google/uuid v1.1.1 github.com/gorilla/mux v1.7.2 github.com/micro/cli v0.2.0 github.com/micro/go-micro v1.6.0 github.com/serenize/snaker v0.0.0-20171204205717-a683aaf2d516 github.com/xlab/treeprint v0.0.0-20181112141820-a009c3971eca golang.org/x/net v0.0.0-20190606173856-1492cefac77f google.golang.org/genproto v0.0.0-20180831171423-11092d34479b // indirect google.golang.org/grpc v1.21.1 github.com/micro/go-plugins v1.1.0) å†æ¬¡ç¼–è¯‘â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.. å“‡å‘€å‘€å‘€å‘€å‘€å‘€~~~~~~~ åˆæŠ¥é”™äº†/(ã„’oã„’)/~~ 123go: github.com/golang/lint@v0.0.0-20190313153728-d0100b6bd8b3: parsing go.mod: unexpected module path &quot;golang.org/x/lint&quot;go: github.com/testcontainers/testcontainer-go@v0.0.2: parsing go.mod: unexpected module path &quot;github.com/testcontainers/testcontainers-go&quot;go: error loading module requirements å¥½åœ¨è¿™ä¸ªé—®é¢˜å·²ç»æœ‰äººè¸©è¿‡å‘äº†ï¼Œå‚è€ƒé“¾æŽ¥ï¼šhttps://github.com/golang/lint/issues/446#issuecomment-483638233 è¿™ä¸ªåªæ˜¯lintçš„è§£å†³æ–¹æ¡ˆï¼ŒtestcontainersåŒç†ï¼Œä¿®æ”¹ä¹‹åŽçš„go.modå¦‚ä¸‹ï¼š 12345678910111213141516171819202122module github.com/micro/microgo 1.12require ( github.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e github.com/golang/protobuf v1.3.1 github.com/google/uuid v1.1.1 github.com/gorilla/mux v1.7.2 github.com/micro/cli v0.2.0 github.com/micro/go-micro v1.6.0 github.com/serenize/snaker v0.0.0-20171204205717-a683aaf2d516 github.com/xlab/treeprint v0.0.0-20181112141820-a009c3971eca golang.org/x/net v0.0.0-20190606173856-1492cefac77f google.golang.org/genproto v0.0.0-20180831171423-11092d34479b // indirect google.golang.org/grpc v1.21.1 github.com/micro/go-plugins v1.1.0)replace github.com/golang/lint =&gt; golang.org/x/lint v0.0.0-20190409202823-959b441ac422replace github.com/testcontainers/testcontainer-go =&gt; github.com/testcontainers/testcontainers-go v0.0.0-20181115231424-8e868ca12c0f å¿ƒæƒ³è¿™å›žåº”è¯¥å¯ä»¥å¤§åŠŸå‘Šæˆäº†å§ï¼Œæˆ‘ä»¬å†æ¥ä¸€éã€‚ ðŸ¤®ðŸ¤®ðŸ¤®ðŸ¤®ðŸ¤®ðŸ¤®ðŸ¤®ï¼Œâ€ä¸­æ¯’èº«äº¡â€ 123build command-line-arguments: cannot load github.com/hashicorp/consul/api: ambiguous import: found github.com/hashicorp/consul/api in multiple modules: github.com/hashicorp/consul v1.4.4 (/Users/doublesouth/Documents/mycode/golang/lib/pkg/mod/github.com/hashicorp/consul@v1.4.4/api) github.com/hashicorp/consul/api v1.1.0 (/Users/doublesouth/Documents/mycode/golang/lib/pkg/mod/github.com/hashicorp/consul/api@v1.1.0) è¿˜æœ‰æœ€åŽä¸€å£æ°”ï¼Œæˆ‘ä»¬å†åšæŒä¸€ä¸‹â€¦ åˆæ˜¯å„ç§ç½‘ä¸ŠæŸ¥æ‰¾ æœ€åŽåŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼šhttps://github.com/hashicorp/consul/issues/6019#issuecomment-505782870 githubçœŸçš„æ˜¯ä¸ªå¾ˆç¥žå¥‡çš„ç½‘ç«™ðŸ˜ï¼Œå†æ¬¡ä¿®æ”¹go.mod: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354module github.com/micro/microgo 1.12require ( github.com/SAP/go-hdb v0.14.1 // indirect github.com/StackExchange/wmi v0.0.0-20181212234831-e0a55b97c705 // indirect github.com/armon/circbuf v0.0.0-20190214190532-5111143e8da2 // indirect github.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e github.com/coredns/coredns v1.4.0 // indirect github.com/envoyproxy/go-control-plane v0.6.9 // indirect github.com/go-ole/go-ole v1.2.4 // indirect github.com/golang/protobuf v1.3.1 github.com/google/btree v1.0.0 // indirect github.com/google/uuid v1.1.1 github.com/gorilla/mux v1.7.2 github.com/hashicorp/consul v1.4.4 // indirect github.com/hashicorp/go-gcp-common v0.5.0 // indirect github.com/hashicorp/go-memdb v1.0.0 // indirect github.com/hashicorp/go-plugin v1.0.0 // indirect github.com/hashicorp/go-retryablehttp v0.5.3 // indirect github.com/hashicorp/hil v0.0.0-20190212132231-97b3a9cdfa93 // indirect github.com/hashicorp/raft-boltdb v0.0.0-20171010151810-6e5ba93211ea // indirect github.com/hashicorp/vault v1.1.0 // indirect github.com/hashicorp/vault-plugin-auth-alicloud v0.0.0-20190320211238-36e70c54375f // indirect github.com/hashicorp/vault-plugin-auth-azure v0.0.0-20190320211138-f34b96803f04 // indirect github.com/hashicorp/vault-plugin-auth-centrify v0.0.0-20190320211357-44eb061bdfd8 // indirect github.com/hashicorp/vault-plugin-auth-kubernetes v0.0.0-20190328163920-79931ee7aad5 // indirect github.com/hashicorp/vault-plugin-secrets-ad v0.0.0-20190327182327-ed2c3d4c3d95 // indirect github.com/hashicorp/vault-plugin-secrets-alicloud v0.0.0-20190320213517-3307bdf683cb // indirect github.com/hashicorp/vault-plugin-secrets-azure v0.0.0-20190320211922-2dc8a8a5e490 // indirect github.com/hashicorp/vault-plugin-secrets-gcp v0.0.0-20190320211452-71903323ecb4 // indirect github.com/hashicorp/vault-plugin-secrets-gcpkms v0.0.0-20190320213325-9e326a9e802d // indirect github.com/influxdata/influxdb v1.7.5 // indirect github.com/lyft/protoc-gen-validate v0.0.14 // indirect github.com/mattn/go-colorable v0.1.1 // indirect github.com/micro/cli v0.2.0 github.com/micro/go-micro v1.6.0 github.com/micro/go-plugins v1.1.0 github.com/pascaldekloe/goe v0.1.0 // indirect github.com/serenize/snaker v0.0.0-20171204205717-a683aaf2d516 github.com/shirou/gopsutil v2.18.12+incompatible // indirect github.com/ugorji/go/codec v0.0.0-20190320090025-2dc34c0b8780 // indirect github.com/xlab/treeprint v0.0.0-20181112141820-a009c3971eca golang.org/x/net v0.0.0-20190606173856-1492cefac77f google.golang.org/grpc v1.21.1 layeh.com/radius v0.0.0-20190322222518-890bc1058917 // indirect)replace github.com/golang/lint =&gt; golang.org/x/lint v0.0.0-20190409202823-959b441ac422replace github.com/testcontainers/testcontainer-go =&gt; github.com/testcontainers/testcontainers-go v0.0.0-20181115231424-8e868ca12c0freplace github.com/hashicorp/consul =&gt; github.com/hashicorp/consul v1.5.1 å¥½å•¦ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘ä¸€ä¸‹ï¼Œç»ˆäºŽå¤§åŠŸå‘Šæˆäº†ã€‚]]></content>
      <categories>
        <category>go-micro</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>go-micro</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[go-moduleåˆè¯•]]></title>
    <url>%2F2019%2F04%2F30%2Fgo-module%E5%88%9D%E8%AF%95%2F</url>
    <content type="text"><![CDATA[go module go module æ˜¯goå®˜æ–¹æä¾›çš„åŒ…ç®¡ç†å·¥å…·ï¼Œç›¸æ¯”glideï¼Œdepè¿™äº›åŒ…ç®¡ç†å·¥å…·ï¼Œgo modè¿˜æ˜¯æ¯”è¾ƒæ–°çš„ï¼Œç›®å‰è¿˜æ²¡æœ‰è¢«å¤§èŒƒå›´ä½¿ç”¨ã€‚æœ¬äººæ¯”è¾ƒå–œæ¬¢å°é²œï¼Œå·²ç»åœ¨é¡¹ç›®ä¸­å°è¯•ä½¿ç”¨äº†ï¼ŒæœŸé—´ä¹Ÿé‡åˆ°ä¸€äº›å‘ï¼Œä¸è¿‡ç›®å‰ä½¿ç”¨ä¸‹æ¥ä¹ŸåŸºæœ¬æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸‹é¢å°±æŠŠä½¿ç”¨è¿‡ç¨‹å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹å§ï¼ è¿è¡Œç›®å½•å¯¹æ¯” ä¸ä½¿ç”¨mod åªèƒ½è¿è¡Œåœ¨go pathä¸‹é¢ ä½¿ç”¨mod å¯è¿è¡Œåœ¨ä»»ä½•ç›®å½•ï¼Œä¸ä¾èµ–go path å¦‚æžœè¦åœ¨go pathä¸‹è¿è¡Œéœ€é…ç½®GO111MODULE=onçŽ¯å¢ƒå˜é‡ å‡ ä¸ªå…³é”®å‘½ä»¤ go mod init initialize new module in current directory go mod tidy add missing and remove unused modules go mod vendor make vendored copy of dependencies ç¿»è¯‘ä¸€ä¸‹ï¼š go mod init ç”¨æ¥å°†å½“å‰ç›®å½•åˆå§‹åŒ–æˆ go mod ç®¡ç†çš„ç›®å½•go mod tidy ç”¨æ¥æ›´æ–°é¡¹ç›®ä¸­çš„ä¾èµ–go mod vendor ç”¨æ¥å°†é¡¹ç›®ä¸­çš„ä¾èµ–åŒ…å…¨éƒ¨copyåˆ°vendorç›®å½•ä¸‹ï¼Œæ–¹ä¾¿é¡¹ç›®åœ¨å…¶ä»–æ²¡æœ‰ go mod çš„çŽ¯å¢ƒä¸Šç¼–è¯‘ å‡ ä¸ªå‘çš„åœ°æ–¹ è¿è¡Œ go mod init ä¼šæŠ¥ go: cannot determine module path for source directoryï¼Œéœ€è¦åœ¨main.goä¸­å£°æ˜Žå¯¼å…¥çš„ä¾èµ– æœ¬åœ°åŒ…ä¾èµ–æ–¹å¼ï¼Œåœ¨go.modæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š 1234replace com.test.a =&gt; ../aå…¶ä¸­ com.test.a ä¸ºé¡¹ç›®ä¸­ä½¿ç”¨çš„åŒ…å../a ä¸ºè¯¥åŒ…åœ¨å½“å‰æœºå™¨ä»£ç çš„ç›¸å¯¹è·¯å¾„]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>go module</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¦‚ä½•ä½¿ç”¨golangæ“ä½œmongo]]></title>
    <url>%2F2019%2F01%2F28%2F%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8golang%E6%93%8D%E4%BD%9Cmongo%2F</url>
    <content type="text"><![CDATA[mongoä»‹ç» ç‰¹æ€§ åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶ é—®é¢˜æ€»ç»“ Official Go Driver ä»£ç ç¤ºä¾‹ å‚è€ƒé“¾æŽ¥ mongoä»‹ç»ç‰¹æ€§ é«˜æ€§èƒ½ ä¸°å¯Œçš„æŸ¥è¯¢è¯­è¨€ é«˜å¯ç”¨ æ°´å¹³ä¼¸ç¼© æ”¯æŒå¤šç§å­˜å‚¨å¼•æ“Ž åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶ mongos æ•°æ®åº“é›†ç¾¤è¯·æ±‚çš„å…¥å£ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½é€šè¿‡mongosè¿›è¡Œåè°ƒï¼Œä¸éœ€è¦åœ¨åº”ç”¨ç¨‹åºæ·»åŠ ä¸€ä¸ªè·¯ç”±é€‰æ‹©å™¨ï¼Œmongosè‡ªå·±å°±æ˜¯ä¸€ä¸ªè¯·æ±‚åˆ†å‘ä¸­å¿ƒï¼Œå®ƒè´Ÿè´£æŠŠå¯¹åº”çš„æ•°æ®è¯·æ±‚è¯·æ±‚è½¬å‘åˆ°å¯¹åº”çš„shardæœåŠ¡å™¨ä¸Šã€‚åœ¨ç”Ÿäº§çŽ¯å¢ƒé€šå¸¸æœ‰å¤šmongosä½œä¸ºè¯·æ±‚çš„å…¥å£ï¼Œé˜²æ­¢å…¶ä¸­ä¸€ä¸ªæŒ‚æŽ‰æ‰€æœ‰çš„mongodbè¯·æ±‚éƒ½æ²¡æœ‰åŠžæ³•æ“ä½œã€‚ config server é…ç½®æœåŠ¡å™¨ï¼Œå­˜å‚¨æ‰€æœ‰æ•°æ®åº“å…ƒä¿¡æ¯ï¼ˆè·¯ç”±ã€åˆ†ç‰‡ï¼‰çš„é…ç½®ã€‚mongosæœ¬èº«æ²¡æœ‰ç‰©ç†å­˜å‚¨åˆ†ç‰‡æœåŠ¡å™¨å’Œæ•°æ®è·¯ç”±ä¿¡æ¯ï¼Œåªæ˜¯ç¼“å­˜åœ¨å†…å­˜é‡Œï¼Œé…ç½®æœåŠ¡å™¨åˆ™å®žé™…å­˜å‚¨è¿™äº›æ•°æ®ã€‚mongosç¬¬ä¸€æ¬¡å¯åŠ¨æˆ–è€…å…³æŽ‰é‡å¯å°±ä¼šä»Ž config server åŠ è½½é…ç½®ä¿¡æ¯ï¼Œä»¥åŽå¦‚æžœé…ç½®æœåŠ¡å™¨ä¿¡æ¯å˜åŒ–ä¼šé€šçŸ¥åˆ°æ‰€æœ‰çš„ mongos æ›´æ–°è‡ªå·±çš„çŠ¶æ€ï¼Œè¿™æ · mongos å°±èƒ½ç»§ç»­å‡†ç¡®è·¯ç”±ã€‚åœ¨ç”Ÿäº§çŽ¯å¢ƒé€šå¸¸æœ‰å¤šä¸ª config server é…ç½®æœåŠ¡å™¨ï¼Œå› ä¸ºå®ƒå­˜å‚¨äº†åˆ†ç‰‡è·¯ç”±çš„å…ƒæ•°æ®ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ï¼ shard åˆ†ç‰‡ï¼ˆshardingï¼‰æ˜¯æŒ‡å°†æ•°æ®åº“æ‹†åˆ†ï¼Œå°†å…¶åˆ†æ•£åœ¨ä¸åŒçš„æœºå™¨ä¸Šçš„è¿‡ç¨‹ã€‚å°†æ•°æ®åˆ†æ•£åˆ°ä¸åŒçš„æœºå™¨ä¸Šï¼Œä¸éœ€è¦åŠŸèƒ½å¼ºå¤§çš„æœåŠ¡å™¨å°±å¯ä»¥å­˜å‚¨æ›´å¤šçš„æ•°æ®å’Œå¤„ç†æ›´å¤§çš„è´Ÿè½½ã€‚åŸºæœ¬æ€æƒ³å°±æ˜¯å°†é›†åˆåˆ‡æˆå°å—ï¼Œè¿™äº›å—åˆ†æ•£åˆ°è‹¥å¹²ç‰‡é‡Œï¼Œæ¯ä¸ªç‰‡åªè´Ÿè´£æ€»æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œæœ€åŽé€šè¿‡ä¸€ä¸ªå‡è¡¡å™¨æ¥å¯¹å„ä¸ªåˆ†ç‰‡è¿›è¡Œå‡è¡¡ï¼ˆæ•°æ®è¿ç§»ï¼‰ã€‚ replia set shardçš„å¤‡ä»½ï¼Œé˜²æ­¢shardæŒ‚æŽ‰ä¹‹åŽæ•°æ®ä¸¢å¤±ã€‚å¤åˆ¶æä¾›äº†æ•°æ®çš„å†—ä½™å¤‡ä»½ï¼Œå¹¶åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šå­˜å‚¨æ•°æ®å‰¯æœ¬ï¼Œæé«˜äº†æ•°æ®çš„å¯ç”¨æ€§ï¼Œ å¹¶å¯ä»¥ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚ é—®é¢˜æ€»ç»“ åœ¨adminåº“ä¸­åˆ›å»ºç”¨æˆ·æŠ¥ Error: couldn&#39;t add user: Use of SCRAM-SHA-256 requires undigested passwords è§£å†³æ–¹æ³•ï¼š ä½¿ç”¨å¦‚ä¸‹è„šæœ¬åˆ›å»ºç”¨æˆ· 12345678db.createUser( &#123; user: "username", pwd: "password", roles: [&#123;role:"root",db:"admin"&#125;], mechanisms: ["SCRAM-SHA-1"] &#125;); å¯åŠ¨mongoæŠ¥é”™ WiredTiger.wt: handle-open: open: No such file or directory è§£å†³æ–¹æ³•ï¼šåˆ é™¤æŽ‰dbPathç›®å½•, ç„¶åŽé‡å¯mongo å¦‚æžœèŽ·å–è¶…è¿‡101æ¡è®°å½•ï¼Œmongodbä¸ä¼šä¸€æ¬¡æ€§å…¨éƒ¨loadå¹¶è¿”å›žç»™clientï¼Œæ¯æ¬¡åªè¿”å›žbatchsizeæ¡è®°å½•ï¼ŒéåŽ†å®Œä¹‹åŽå†é€šè¿‡ç½‘ç»œèŽ·å–ã€‚ Official Go Drivermongo-go-driver ä»£ç ç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112package mainimport ( "context" "fmt" "github.com/mongodb/mongo-go-driver/bson" "github.com/mongodb/mongo-go-driver/mongo" "os" "os/signal" "time")var MongoClient *mongo.Clientfunc main() &#123; // ç»ˆç«¯ä¿¡å·é€šé“ signalChan := make(chan os.Signal, 1) signal.Notify(signalChan, os.Interrupt) // åˆå§‹åŒ–mongo client initMongoClient() collection := MongoClient.Database("test").Collection("doublesouth_test") //testCollectionInsertOne(collection) testCollectionFind(collection) for range signalChan &#123; fmt.Println("æ”¶åˆ°ç»ˆç«¯ä¿¡å·ï¼Œå‡†å¤‡æ–­å¼€mongoè¿žæŽ¥...") if err := destroyMongoClient(); err != nil &#123; fmt.Println("æ–­å¼€mongoè¿žæŽ¥å¤±è´¥", err) &#125; else &#123; fmt.Println("å·²æ–­å¼€mongoè¿žæŽ¥") &#125; break &#125;&#125;func initMongoClient() &#123; client, err := mongo.NewClient("mongodb://username:password@localhost:20000") if err != nil &#123; panic(err) &#125; ctx, cancel := context.WithTimeout(context.Background(), 20*time.Second) defer cancel() err = client.Connect(ctx) if err != nil &#123; panic(err) &#125; MongoClient = client&#125;func destroyMongoClient() error &#123; return MongoClient.Disconnect(context.Background())&#125;func testCollectionInsertOne(collection *mongo.Collection) &#123; res, err := collection.InsertOne(context.Background(), bson.M&#123; "name": "å¤§è™¾3", "age": int32(18), "sex": "å¥³", "hobby": []string&#123;"çŽ©æ¸¸æˆ", "çœ‹ç”µå½±"&#125;, &#125;) if err != nil &#123; fmt.Println(err) return &#125; fmt.Println("_id:", res.InsertedID)&#125;func testCollectionFind(collection *mongo.Collection) &#123; ctx := context.Background() fmt.Println("findall-------------------------------------------") cur, err := collection.Find(ctx, nil) defer cur.Close(ctx) if err != nil &#123; fmt.Println(err) return &#125; for cur.Next(ctx) &#123; raw, err := cur.DecodeBytes() if err != nil &#123; fmt.Println(err) return &#125; fmt.Println(raw.String()) &#125; fmt.Println("findone-------------------------------------") result := bson.Raw&#123;&#125; filter := bson.D&#123;&#123;"name", "å¤§è™¾3"&#125;&#125; err = collection.FindOne(context.Background(), filter).Decode(&amp;result) if err != nil &#123; fmt.Println(err) &#125; fmt.Println(result.String()) res := struct &#123; Name string Age int32 Sex string Hobby []string &#125;&#123;&#125; err = collection.FindOne(context.Background(), filter).Decode(&amp;res) if err != nil &#123; fmt.Println(err) &#125; fmt.Println(res)&#125; å‚è€ƒé“¾æŽ¥Mac mongo å¯è§†åŒ–å®¢æˆ·ç«¯ Robo 3TMongoDBå®˜æ–¹æ–‡æ¡£Mongodb ä¸Ž MySQLæ€§èƒ½å¯¹æ¯”mongodbå‰¯æœ¬é›†åŠ åˆ†ç‰‡é›†ç¾¤å®‰å…¨è®¤è¯ä½¿ç”¨è´¦å·å¯†ç ç™»å½•mongodb 3.4 é›†ç¾¤æ­å»ºï¼šåˆ†ç‰‡+å‰¯æœ¬é›†MongoDBè®¤è¯å’ŒæŽˆæƒè¯¦è§£MongoDB åˆ†ç‰‡é›†ç¾¤æŠ€æœ¯Mongodb æ•™ç¨‹What is the difference between readPreference and readConcern in MongoDB?mongodb 3.4ä¸Ž mongodb 3.2æ€§èƒ½å¯¹æ¯”]]></content>
      <categories>
        <category>mongo</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>go</tag>
        <tag>mongo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[go-microå­¦ä¹ ç¬”è®°]]></title>
    <url>%2F2019%2F01%2F06%2Fgo-micro%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[ç‰¹æ€§ micro toolkit é—®é¢˜ ä½¿ç”¨ å¦‚ä½•ä½¿ç”¨ å®‰è£…æœåŠ¡æ³¨å†Œå‘çŽ°ä¸­å¿ƒ æœåŠ¡ç«¯ å®¢æˆ·ç«¯ è¸©è¿‡çš„å‘ å‚è€ƒæ–‡æ¡£ ç‰¹æ€§æœåŠ¡å‘çŽ° è‡ªåŠ¨æœåŠ¡æ³¨å†Œå’Œå‘çŽ°ã€‚é»˜è®¤ä½¿ç”¨consulä½œä¸ºæœåŠ¡å‘çŽ°å’Œæ³¨å†Œä¸­å¿ƒï¼Œå¯é€šè¿‡æ’ä»¶åŒ–ä¿®æ”¹ä¸ºå…¶ä»–çš„æ³¨å†Œä¸­å¿ƒï¼Œæ¯”å¦‚etcdï¼Œzookeeperç­‰ã€‚ è´Ÿè½½å‡è¡¡ åŸºäºŽæœåŠ¡å‘çŽ°çš„å®¢æˆ·ç«¯è´Ÿè½½å¹³è¡¡ã€‚ æ¶ˆæ¯ç¼–ç  åŸºäºŽå†…å®¹ç±»åž‹çš„åŠ¨æ€æ¶ˆæ¯ç¼–ç ã€‚ å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å°†æ ¹æ®å†…å®¹ç±»åž‹ä½¿ç”¨å¯¹åº”çš„ç¼–è§£ç å™¨ã€‚ åŒæ­¥æµ åŸºäºŽRPCçš„è¯·æ±‚/å“åº”ï¼Œæ”¯æŒåŒå‘æµã€‚æä¾›äº†åŒæ­¥é€šè®¯çš„æŠ½è±¡ã€‚å‘æœåŠ¡å‘å‡ºçš„è¯·æ±‚å°†è¢«è‡ªåŠ¨è§£æžã€è´Ÿè½½å¹³è¡¡ã€æ‹¨å·å’Œæµå¤„ç†ã€‚ é»˜è®¤å€¼å¯ç”¨tlsæ—¶ï¼Œtransportä¸ºhttp / 1.1æˆ–http2ã€‚ å¼‚æ­¥æ¶ˆæ¯ PubSubæ˜¯ä½œä¸ºå¼‚æ­¥é€šä¿¡å’Œäº‹ä»¶é©±åŠ¨æž¶æž„çš„ä¸€ç­‰å…¬æ°‘è€Œæž„å»ºçš„ã€‚äº‹ä»¶é€šçŸ¥æ˜¯å¾®æœåŠ¡å¼€å‘çš„æ ¸å¿ƒæ¨¡å¼ã€‚å¯ç”¨tlsæ—¶ï¼Œé»˜è®¤æ¶ˆæ¯ä¼ é€’æ˜¯ç‚¹å¯¹ç‚¹http1.1æˆ–http2ã€‚ å¯æ’æ‹”æŽ¥å£ Go Microä¸ºæ¯ä¸ªåˆ†å¸ƒå¼ç³»ç»ŸæŠ½è±¡å‡ºGoæŽ¥å£ã€‚è¿™äº›æŽ¥å£æ˜¯å¯æ’æ‹”çš„ï¼Œå¹¶ä¸”å…è®¸Go Microä¸ä¾èµ–äºŽè¿è¡Œæ—¶ã€‚æ‚¨å¯ä»¥æ’å…¥ä»»ä½•åº•å±‚æŠ€æœ¯ã€‚ micro toolkitmicroæ˜¯ä¸€ä¸ªå·¥å…·åŒ…ã€‚æä¾›äº†ä¸€äº›å·¥å…·æ–¹ä¾¿åœ¨go-microå¾®æœåŠ¡æž¶æž„ä¸­ä½¿ç”¨ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869~ micro -hNAME: micro - A cloud-native toolkitUSAGE: micro [global options] command [command options] [arguments...]VERSION: 0.13.0COMMANDS: api Run the micro API bot Run the micro bot cli Start the interactive cli registry Query registry call Call a service or function query Deprecated: Use call instead stream Create a service or function stream publish Publish a message to a topic health Query the health of a service stats Query the stats of a service list List items in registry register Register an item in the registry deregister Deregister an item in the registry get Get item from registry proxy Run the micro proxy new Create a new micro service by specifying a directory path relative to your $GOPATH web Run the micro web appGLOBAL OPTIONS: --client Client for go-micro; rpc [$MICRO_CLIENT] --client_request_timeout Sets the client request timeout. e.g 500ms, 5s, 1m. Default: 5s [$MICRO_CLIENT_REQUEST_TIMEOUT] --client_retries &quot;0&quot; Sets the client retries. Default: 1 [$MICRO_CLIENT_RETRIES] --client_pool_size &quot;0&quot; Sets the client connection pool size. Default: 1 [$MICRO_CLIENT_POOL_SIZE] --client_pool_ttl Sets the client connection pool ttl. e.g 500ms, 5s, 1m. Default: 1m [$MICRO_CLIENT_POOL_TTL] --register_ttl &quot;0&quot; Register TTL in seconds [$MICRO_REGISTER_TTL] --register_interval &quot;0&quot; Register interval in seconds [$MICRO_REGISTER_INTERVAL] --server Server for go-micro; rpc [$MICRO_SERVER] --server_name Name of the server. go.micro.srv.example [$MICRO_SERVER_NAME] --server_version Version of the server. 1.1.0 [$MICRO_SERVER_VERSION] --server_id Id of the server. Auto-generated if not specified [$MICRO_SERVER_ID] --server_address Bind address for the server. 127.0.0.1:8080 [$MICRO_SERVER_ADDRESS] --server_advertise Used instead of the server_address when registering with discovery. 127.0.0.1:8080 [$MICRO_SERVER_ADVERTISE] --server_metadata [--server_metadata option --server_metadata option] A list of key-value pairs defining metadata. version=1.0.0 [$MICRO_SERVER_METADATA] --broker Broker for pub/sub. http, nats, rabbitmq [$MICRO_BROKER] --broker_address Comma-separated list of broker addresses [$MICRO_BROKER_ADDRESS] --registry Registry for discovery. consul, mdns [$MICRO_REGISTRY] --registry_address Comma-separated list of registry addresses [$MICRO_REGISTRY_ADDRESS] --selector &quot;cache&quot; Selector used to pick nodes for querying [$MICRO_SELECTOR] --transport Transport mechanism used; http [$MICRO_TRANSPORT] --transport_address Comma-separated list of transport addresses [$MICRO_TRANSPORT_ADDRESS] --enable_acme Enables ACME support via Let&apos;s Encrypt. ACME hosts should also be specified. [$MICRO_ENABLE_ACME] --acme_hosts Comma separated list of hostnames to manage ACME certs for [$MICRO_ACME_HOSTS] --enable_tls Enable TLS support. Expects cert and key file to be specified [$MICRO_ENABLE_TLS] --tls_cert_file Path to the TLS Certificate file [$MICRO_TLS_CERT_FILE] --tls_key_file Path to the TLS Key file [$MICRO_TLS_KEY_FILE] --tls_client_ca_file Path to the TLS CA file to verify clients against [$MICRO_TLS_CLIENT_CA_FILE] --api_address Set the api address e.g 0.0.0.0:8080 [$MICRO_API_ADDRESS] --proxy_address Proxy requests via the HTTP address specified [$MICRO_PROXY_ADDRESS] --web_address Set the web UI address e.g 0.0.0.0:8082 [$MICRO_WEB_ADDRESS] --api_handler Specify the request handler to be used for mapping HTTP requests to services; &#123;api, proxy, rpc&#125; [$MICRO_API_HANDLER] --api_namespace Set the namespace used by the API e.g. com.example.api [$MICRO_API_NAMESPACE] --web_namespace Set the namespace used by the Web proxy e.g. com.example.web [$MICRO_WEB_NAMESPACE] --api_cors Comma separated whitelist of allowed origins for CORS [$MICRO_API_CORS] --web_cors Comma separated whitelist of allowed origins for CORS [$MICRO_WEB_CORS] --proxy_cors Comma separated whitelist of allowed origins for CORS [$MICRO_PROXY_CORS] --enable_stats Enable stats [$MICRO_ENABLE_STATS] --help, -h show help --version print the version é—®é¢˜ä½¿ç”¨micro toolkitï¼Œå®‰è£…å…¶ä»–æ’ä»¶ï¼Œç¬¬ä¸€æ¬¡buildç¼ºå°‘ç›¸å…³åŒ…ï¼Œgo get ä¸‹æ¥ï¼ŒbuildæˆåŠŸä¹‹åŽè¿è¡Œå‘½ä»¤ï¼ŒæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š 12345panic: /debug/requests is already registered. You may have two independent copies of golang.org/x/net/trace in your binary, trying to maintain separate state. This may involve a vendored copy of golang.org/x/net/trace.goroutine 1 [running]:go.etcd.io/etcd/vendor/golang.org/x/net/trace.init.0() /Users/doublesouth/Documents/mycode/golang/lib/src/go.etcd.io/etcd/vendor/golang.org/x/net/trace/trace.go:116 +0x16c è§£å†³æ–¹æ³•å‚è€ƒè¯¥é“¾æŽ¥ï¼šhttps://github.com/etcd-io/etcd/issues/9357#issuecomment-377560659 ä½¿ç”¨ æ‰‹åŠ¨å–æ¶ˆæ³¨å†Œ 1micro deregister service '&#123;"name":"&lt;service.name&gt;","version":"&lt;service.version&gt;","nodes":[&#123;"id":"&lt;node.id&gt;"&#125;]&#125;' å¦‚ä½•ä½¿ç”¨å®‰è£…æœåŠ¡æ³¨å†Œå‘çŽ°ä¸­å¿ƒæœ¬åœ°ä½¿ç”¨dockerå®‰è£…consulï¼š æœ¬åœ°å®‰è£…docker è¿è¡Œ docker pull consul å‘½ä»¤ä»Ždocker hubä¸Šæ‹‰å–æœ€æ–°å®˜æ–¹consulé•œåƒ è¿è¡Œ docker run -d --name=local-consul -e CONSUL_BIND_INTERFACE=eth0 -p 8500:8500 consul å‘½ä»¤å¯åŠ¨dockerå®¹å™¨ï¼Œéœ€è¦æš´éœ²8500ç«¯å£ï¼Œå¦åˆ™æœ¬åœ°æœåŠ¡æ— æ³•æ³¨å†Œåˆ°consul æœåŠ¡ç«¯1234567891011121314151617181920212223242526type HelloWorld struct &#123; &#125;// å®žçŽ°hello_world serviceä¸­çš„Helloæ–¹æ³•func (g *HelloWorld) Hello(ctx context.Context, req *hello_world.HelloRequest, rsp *hello_world.HelloResponse) error &#123; rsp.Greeting = "Hello World: " + req.Name return nil&#125;func main() &#123; service := micro.NewService( micro.Name("hello_world"), micro.Version("latest"), micro.Metadata(map[string]string&#123; "type": "helloworld", &#125;), ) service.Init() hello_world.RegisterHelloWorldHandler(service.Server(), new(HelloWorld)) if err := service.Run(); err != nil &#123; fmt.Println(err) &#125;&#125; å®¢æˆ·ç«¯12345678910111213141516171819202122func main() &#123; service := micro.NewService( micro.Name("hello_world"), micro.Version("latest"), micro.Metadata(map[string]string&#123; "type": "helloworld", &#125;), ) service.Init() greeter := hello_world.NewHelloWorldClient("hello_world", service.Client()) rsp, err := greeter.Hello(context.TODO(), &amp;hello_world.HelloRequest&#123;Name: "Alice"&#125;) if err != nil &#123; fmt.Println(err) return &#125; fmt.Println(rsp.Greeting)&#125; è¸©è¿‡çš„å‘ go-microæ¡†æž¶å®¢æˆ·ç«¯è¿žæŽ¥æ± å¤§å°é…ç½®ä¸æ˜¯åªå»ºè¿™ä¹ˆå¤šçš„è¿žæŽ¥ï¼Œæºç ä¸­çš„å¤„ç†æœºåˆ¶æ˜¯æ¯æ¬¡å‘èµ·å®¢æˆ·ç«¯è¯·æ±‚é¦–å…ˆæ£€æŸ¥æ± ä¸­æœ‰æ²¡æœ‰è¿žæŽ¥ï¼Œå¦‚æžœæ²¡æœ‰è¿žæŽ¥ä¼šç›´æŽ¥æ–°å»ºä¸€ä¸ªè¿žæŽ¥å‘èµ·è¯·æ±‚ï¼Œè¿žæŽ¥ç”¨å®Œé‡Šæ”¾è¿žæŽ¥çš„æ—¶å€™ä¼šæ£€æŸ¥æ± ä¸­çš„è¿žæŽ¥æ•°æ˜¯è¾¾åˆ°é…ç½®çš„è¿žæŽ¥æ•°ï¼Œå¦‚æžœè¾¾åˆ°é…ç½®çš„è¿žæŽ¥æ•°ç›´æŽ¥å…³é—­è¯¥è¿žæŽ¥ï¼Œå¦‚æžœæœªè¾¾åˆ°æ‰å°†è¯¥è¿žæŽ¥æ”¾åˆ°æ± ä¸­ã€‚è¿™å°±ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æžœè¯·æ±‚é‡è¿‡å¤§ä¼šå¯¼è‡´è¿žæŽ¥ä¸€ç›´åœ¨åˆ›å»ºï¼Œæœ€ç»ˆä¼šæŠ¥ too many open files é”™è¯¯ã€‚ ä¸‹é¢æ˜¯go-microæ¡†æž¶ä¸­clientç«¯èŽ·å–è¿žæŽ¥å’Œé‡Šæ”¾è¿žæŽ¥çš„æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859// èŽ·å–è¿žæŽ¥func (p *pool) getConn(addr string, tr transport.Transport, opts ...transport.DialOption) (*poolConn, error) &#123; p.Lock() conns := p.conns[addr] now := time.Now().Unix() // while we have conns check age and then return one // otherwise we'll create a new conn // 1. é¦–å…ˆæ£€æŸ¥æ± ä¸­å¯ç”¨è¿žæŽ¥æ•°æ˜¯å¦å¤§äºŽ1 for len(conns) &gt; 0 &#123; conn := conns[len(conns)-1] conns = conns[:len(conns)-1] p.conns[addr] = conns // if conn is old kill it and move on if d := now - conn.created; d &gt; p.ttl &#123; conn.Client.Close() continue &#125; // we got a good conn, lets unlock and return it p.Unlock() // 2. ç›´æŽ¥è¿”å›žæ± ä¸­è¿žæŽ¥ return conn, nil &#125; p.Unlock() // create new conn // 3. å¦‚æžœæ± ä¸­æ²¡æœ‰è¿žæŽ¥äº†ï¼Œè¿™æ—¶æ–°å»ºä¸€ä¸ªè¿žæŽ¥å¹¶è¿”å›ž c, err := tr.Dial(addr, opts...) if err != nil &#123; return nil, err &#125; return &amp;poolConn&#123;c, time.Now().Unix()&#125;, nil&#125;// é‡Šæ”¾è¿žæŽ¥func (p *pool) release(addr string, conn *poolConn, err error) &#123; // don't store the conn if it has errored if err != nil &#123; conn.Client.Close() return &#125; // otherwise put it back for reuse p.Lock() conns := p.conns[addr] // 1. æ£€æŸ¥æ± ä¸­è¿žæŽ¥æ•°æ˜¯å¦å·²è¾¾åˆ°æœ€å¤§ï¼Œå¦‚æžœè¾¾åˆ°æœ€å¤§ç›´æŽ¥å…³é—­è¿žæŽ¥ if len(conns) &gt;= p.size &#123; p.Unlock() conn.Client.Close() return &#125; // 2. æœªè¾¾åˆ°æ± ä¸­æœ€å¤§è¿žæŽ¥æ•°å°†è¯¥è¿žæŽ¥æ”¾å…¥æ± ä¸­ p.conns[addr] = append(conns, conn) p.Unlock()&#125; å®¢æˆ·ç«¯é…ç½®registerç›´æŽ¥æ”¾åˆ°mainæ–¹æ³•èŽ·å–æµ‹è¯•ç”¨ä¾‹ä¸­éƒ½å¯ä»¥è°ƒç”¨åˆ°æœåŠ¡ç«¯ï¼Œä½†æ˜¯æœ¬åœ°åŒæ ·å¯ä¸ªæœåŠ¡ç«¯ç„¶åŽåœ¨æœåŠ¡é‡Œé¢é…ç½®å®¢æˆ·ç«¯registerå‘çŽ°æœªç”Ÿæ•ˆï¼Œä¸€ç›´ä½¿ç”¨é»˜è®¤çš„consulã€‚ æœ¬åœ°æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425// è¿™ç§æ–¹å¼åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­æ˜¯å¯ä»¥è°ƒç”¨æˆåŠŸçš„// ä½†æ˜¯å¦‚æžœå’Œserverä¸€èµ·å¯åŠ¨ï¼Œå°±ä¼šåˆå§‹åŒ–å¤±è´¥ï¼Œä½¿ç”¨çš„registerå§‹ç»ˆéƒ½æ˜¯é»˜è®¤çš„consulfunc TestClient(t *testing.T) &#123; var c client.Client r := etcdv3.NewRegistry(registry.Addrs("127.0.0.1:2379")) c = client.NewClient() c.Init(client.Selector( selector.NewSelector(selector.Registry(r))), client.PoolSize(100), //è¿žæŽ¥æ± å¤§å° client.PoolTTL(5*time.Minute), //é•¿è¿žæŽ¥ç¼“å­˜æ—¶é—´ client.Retries(3), //é‡è¯•æ¬¡æ•° client.RequestTimeout(30*time.Second), //è¯·æ±‚è¶…æ—¶ client.DialTimeout(2*time.Second), //å®¢æˆ·ç«¯è¿žæŽ¥è¶…æ—¶ client.Transport(tcp.NewTransport()), ) Client = service.NewDemoService("demo.service", c) rsp, err := Client.Do(context.TODO(), &amp;Request&#123; Say: "hello", &#125;) if err != nil &#123; t.Errorf("err %v\n", err) &#125;&#125; è¿™ç¯‡åšå®¢åªæ˜¯å…³äºŽgo-microçš„ä¸€ä¸ªç®€å•ä»‹ç»ä»¥åŠå…¥é—¨ä½¿ç”¨ï¼Œç¬”è€…ä¹Ÿåœ¨å­¦ä¹ é˜¶æ®µï¼Œéšç€ç ”ç©¶çš„æ·±å…¥ä¹Ÿä¼šåˆ†äº«æ›´å¤šå…³äºŽgo-microçš„åªæ˜¯ç»™å¤§å®¶ã€‚ å‚è€ƒæ–‡æ¡£Micro Documentation[go-micro]Micro Documentation[function]Micro examples repositorygo-micro æ¡†æž¶ä»‹ç»Micro-Apiæ–‡æ¡£]]></content>
      <categories>
        <category>go-micro</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>go-micro</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[glideè¸©å‘è®°]]></title>
    <url>%2F2018%2F12%2F10%2Fglide%E8%B8%A9%E5%9D%91%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[å‘ä½ glide æˆ‘å°±ä¸åšè¿‡å¤šä»‹ç»äº†ï¼Œå®ƒæ˜¯golangçš„åŒ…ç®¡ç†å·¥å…·ä¹‹ä¸€ï¼Œç”±äºŽè¯¥å·¥å…·githubä¸Šé¢ä¸åœ¨ç»´æŠ¤ï¼Œå®˜æ–¹ä¹ŸæŽ¨èä½¿ç”¨depï¼Œæ‰€ä»¥ä¹‹å‰ä¹Ÿä½¿ç”¨è¿‡depï¼Œä½†æ˜¯ç”±äºŽ dep ä¸€ç›´æ‹‰å–ä¸äº† golang.org/x ç›¸å…³ä¾èµ–ï¼Œæ— å¥ˆåªèƒ½åˆåˆ‡å›ž glideã€‚ å‘ä½ æ‹‰å– golang.org/x ç›¸å…³åŒ…åŒæ ·å¤±è´¥ï¼ŒæŠ¥ Cannot detect VCS è§£å†³æ–¹æ¡ˆ 12345678// æ›¿æ¢æ‹‰å–é•œåƒglide mirror set https://golang.org/x/mobile https://github.com/golang/mobile --vcs gitglide mirror set https://golang.org/x/crypto https://github.com/golang/crypto --vcs gitglide mirror set https://golang.org/x/net https://github.com/golang/net --vcs gitglide mirror set https://golang.org/x/tools https://github.com/golang/tools --vcs gitglide mirror set https://golang.org/x/text https://github.com/golang/text --vcs gitglide mirror set https://golang.org/x/image https://github.com/golang/image --vcs gitglide mirror set https://golang.org/x/sys https://github.com/golang/sys --vcs git ç§åº“çš„åŒ…æ‹‰å–ä¸äº† è§£å†³æ–¹æ¡ˆ 12// åŒæ ·æ›¿æ¢æ‹‰å–é•œåƒglide mirror set [æœ¬åœ°ä»£ç ä¸­importçš„åŒ…å,ä¾‹å¦‚ï¼štest/keng] [å¯¹åº”ç§åº“çš„åœ°å€ï¼ˆhttp://host/test/keng] --vcs git æ— æ³•æ‹‰å–å­åŒ… å‡è®¾ä½ è¦æ‹‰å–çš„åŒ…åœ¨glide.yamlä¸­é…ç½®å¦‚ä¸‹ï¼š 1- package: golang.org/x/net/context æ­¤æ—¶åŒæ ·ä¼šæŠ¥ Cannot detect VCSï¼Œå› ä¸ºä¸æ”¯æŒæ‹‰å–å­åŒ… è§£å†³æ–¹æ¡ˆ ä¿®æ”¹glide.yamlä¸­çš„é…ç½®å¦‚ä¸‹ï¼š 123- package: golang.org/x/net subpackages: - context]]></content>
      <categories>
        <category>golang</category>
      </categories>
      <tags>
        <tag>glide</tag>
        <tag>golang</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[goland debug æŠ¥ include nested too deeply é—®é¢˜æŽ’æŸ¥]]></title>
    <url>%2F2018%2F11%2F29%2Fgoland%E8%B0%83%E8%AF%95(debug)%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%2F</url>
    <content type="text"><![CDATA[çŽ¯å¢ƒè¯´æ˜Žç³»ç»Ÿï¼šMacOS10.14.1golandç‰ˆæœ¬ï¼š2018.2.2golangç‰ˆæœ¬ï¼šgo1.11.2 darwin/amd64 é—®é¢˜æè¿°å½“ä½¿ç”¨goland debugè°ƒè¯•ä»£ç æ—¶ï¼Œé¦–å…ˆè¦å¼€å§‹ç¼–è¯‘ï¼Œç¼–è¯‘ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228GOROOT=/usr/local/Cellar/go/1.11/libexec #gosetupGOPATH=/path/to/golang/lib:/path/to/golang/workspace #gosetup/usr/local/Cellar/go/1.11/libexec/bin/go build -o /private/var/folders/xs/lp65n5c92gb76wj4zllw1dmr0000gp/T/___go_build_main_go -gcflags &quot;all=-N -l&quot; /path/to/main.go #gosetup# runtime/cgoIn file included from _cgo_export.c:3:In file included from /usr/include/stdlib.h:66:In file included from /usr/include/sys/wait.h:110:In file included from /usr/include/sys/resource.h:72:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:In file included from /usr/local/include/stdint.h:59:/usr/local/include/stdint.h:2:10: error: #include nested too deeply/usr/local/include/stdint.h:59:11: error: #include nested too deeply/usr/local/include/stdint.h:72:11: error: #include nested too deeply/usr/local/include/stdint.h:76:10: error: #include nested too deeply/usr/local/include/stdint.h:82:11: error: #include nested too deeplyIn file included from _cgo_export.c:3:In file included from /usr/include/stdlib.h:66:In file included from /usr/include/sys/wait.h:110:/usr/include/sys/resource.h:197:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:198:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:199:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:200:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:201:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:202:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:203:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:204:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:205:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:206:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:211:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:212:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:213:2: error: unknown type name &apos;uint64_t&apos;/usr/include/sys/resource.h:214:2: error: unknown type name &apos;uint64_t&apos;fatal error: too many errors emitted, stopping now [-ferror-limit=]Compilation finished with exit code 2 æ­£å¸¸runå¯åŠ¨ä¸ä¼šæŠ¥è¯¥é”™è¯¯ï¼Œç»è¿‡å¯¹æ¯”å‘çŽ°æ­£å¸¸runçš„æ—¶å€™æ‰§è¡Œçš„buildå‘½ä»¤å¦‚ä¸‹ï¼š 1/usr/local/Cellar/go/1.11/libexec/bin/go build -i -o /private/var/folders/xs/lp65n5c92gb76wj4zllw1dmr0000gp/T/___go_build_main_go /path/to/main.go #gosetup åŒºåˆ«å°±æ˜¯debugæ—¶å€™ä¼šå¤š -gcflags â€œall=-N -lâ€ å‚æ•°ï¼ŒåŠ äº†è¿™ä¸ªå‚æ•°å°±ä¼šæŠ¥é”™ã€‚ è§£å†³æ–¹æ¡ˆç½‘ä¸Šä¹Ÿæœç´¢äº†å¾ˆå¤šå…³äºŽåŠ è¿™ä¸ªå‚æ•°æŠ¥é”™çš„åŽŸå› ï¼Œæ²¡æœ‰å…·ä½“çš„è§£å†³æ–¹æ¡ˆã€‚åŽæ¥é€šè¿‡æœç´¢é”™è¯¯æ—¥å¿—é‡Œé¢çš„ error: #include nested too deeply è¿™ä¸ªæè¿°ï¼Œç»ˆäºŽæ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š 12mkdir /tmp/includesbrew doctor 2&gt;&amp;1 | grep &quot;/usr/local/include&quot; | awk &apos;&#123;$1=$1;print&#125;&apos; | xargs -I _ mv _ /tmp/includes ä¹Ÿæ˜¯çžŽçŒ«ç¢°åˆ°æ­»è€—å­è§£å†³äº†ï¼ŒæŠŠè¿™ä¸ªé—®é¢˜åˆ†äº«å‡ºæ¥å¸Œæœ›å¯¹é‡åˆ°çš„äººæœ‰å¸®åŠ©ã€‚]]></content>
      <categories>
        <category>golang</category>
        <category>goland</category>
      </categories>
      <tags>
        <tag>golang</tag>
        <tag>goland</tag>
        <tag>debug</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨feignä¸Šä¼ ä¸‹è½½æ–‡ä»¶æ‰©å±•åŒ…å¡«å‘è®°]]></title>
    <url>%2F2018%2F04%2F04%2F%E4%BD%BF%E7%94%A8fegin%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%8C%85%E5%A1%AB%E5%9D%91%E8%AE%B0%2F</url>
    <content type="text"><![CDATA[é—®é¢˜æè¿°å…ˆæŠŠæœ‰å‘çš„ä»£ç è´´ä¸Šï¼š12345678910//...ä¸Šä¸‹æ–‡æˆ‘å°±çœç•¥äº†ï¼ŒæŠŠæœ‰é—®é¢˜çš„ä»£ç æ®µè´´å‡ºæ¥InputStream inputStream = null;inputStream = fresp.body().asInputStream();FileTypeJudger.FileInfo fileInfo = fileTypeJudger.judgeToFileInfo(inputStream);mimeType = fileInfo.getMimeType();// å¿…é¡»å°†æ¸¸æ ‡è®¾ç½®åˆ°èµ·å§‹ä½ç½®ï¼Œæ‰èƒ½è¾“å‡ºå®Œæ•´çš„æ–‡ä»¶æµinputStream.reset(); //è¿™é‡Œå°±æ˜¯æœ‰å‘çš„åœ°æ–¹//... ä»¥ä¸Šä»£ç åœ¨æœ€åŽä¸€è¡Œä¼šæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸ï¼š1java.io.IOException: mark/reset not supported ä½†æ˜¯æˆ‘åœ¨å¼€å‘å’Œæµ‹è¯•çŽ¯å¢ƒéƒ½éªŒè¯è¿‡ï¼Œfresp.body().asInputStream()è¿”å›žçš„æ˜¯ByteArrayInputStreamç±»åž‹ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€åŽä¸€è¡Œæ˜¯æ”¯æŒresetæ“ä½œçš„ã€‚ æŽ’æŸ¥è®°å½• æŸ¥çœ‹feignæºç å‘çŽ°asInputStream()æ–¹æ³•æœ‰ä¸¤ä¸ªå®žçŽ°ï¼Œåˆ†åˆ«æ˜¯ByteArrayBodyå’ŒInputStreamBodyï¼Œæºç å¦‚ä¸‹ï¼š 1234567891011// ByteArrayBodyå®žçŽ°@Overridepublic InputStream asInputStream() throws IOException &#123; return new ByteArrayInputStream(data);&#125;// InputStreamBodyå®žçŽ°@Overridepublic InputStream asInputStream() throws IOException &#123; return inputStream;&#125; å¯ä»¥çœ‹å‡ºåªæœ‰è°ƒç”¨InputStreamBodyå®žçŽ°çš„asInputStream()æ–¹æ³•æ‰ä¼šå‡ºçŽ°ä¸Šé¢çš„å¼‚å¸¸ã€‚ ç„¶åŽåœ¨æœ¬åœ°å‘èµ·è¯·æ±‚ï¼Œå¼€å¯debugæ¨¡å¼ï¼Œä¸€æ­¥ä¸€æ­¥è·Ÿå‘çŽ°æ²¡æœ‰é—®é¢˜ï¼Œæ¯æ¬¡éƒ½æ˜¯èµ°åˆ°ByteArrayBodyï¼Œè¿™è®©æˆ‘éƒé—·äº†å¾ˆé•¿æ—¶é—´å•Šã€‚ ç„¶åŽå°è¯•è·Ÿè¸ªByteArrayInputStreamå®žä¾‹ä¸­ä¼ é€’çš„dataçš„åˆå§‹åŒ–æµç¨‹ã€‚å‘çŽ°æ˜¯åœ¨ByteArrayBodyç±»çš„æž„é€ å‡½æ•°ä¸­åˆå§‹åŒ–çš„ã€‚ 1234// æž„é€ å‡½æ•°public ByteArrayBody(byte[] data) &#123; this.data = data;&#125; å†è·Ÿè¸ªæž„é€ å‡½æ•°ï¼Œå‘çŽ°åœ¨orNull()æ–¹æ³•ä¸­è¢«è°ƒç”¨äº† 1234567// orNull æ–¹æ³•private static Body orNull(byte[] data) &#123; if (data == null) &#123; return null; &#125; return new ByteArrayBody(data);&#125; å†è·Ÿè¸ªorNull()æ–¹æ³•ï¼Œå‘çŽ°åœ¨Response.Builderç±»ä¸­çš„è¢«è°ƒç”¨ï¼Œè°ƒç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 1234public Builder body(byte[] data) &#123; this.body = ByteArrayBody.orNull(data); return this;&#125; å†è·Ÿè¸ªbody()æ–¹æ³•ï¼Œå‘çŽ°æœ‰ä¸¤ä¸ªåœ°æ–¹ä¼šè°ƒç”¨ï¼ŒLoggerå’ŒSynchronousMethodHandlerä¸¤ä¸ªç±»ä¸­ä¼šè°ƒç”¨ã€‚ ç„¶åŽå…ˆåœ¨SynchronousMethodHandlerçš„æ–¹æ³•ä¸­debugï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283@Overridepublic Object invoke(Object[] argv) throws Throwable &#123; RequestTemplate template = buildTemplateFromArgs.create(argv); Retryer retryer = this.retryer.clone(); while (true) &#123; try &#123; return executeAndDecode(template); &#125; catch (RetryableException e) &#123; retryer.continueOrPropagate(e); if (logLevel != Logger.Level.NONE) &#123; logger.logRetry(metadata.configKey(), logLevel); &#125; continue; &#125; &#125;&#125;Object executeAndDecode(RequestTemplate template) throws Throwable &#123; Request request = targetRequest(template); if (logLevel != Logger.Level.NONE) &#123; logger.logRequest(metadata.configKey(), logLevel, request); &#125; Response response; long start = System.nanoTime(); try &#123; response = client.execute(request, options); // ensure the request is set. TODO: remove in Feign 10 response.toBuilder().request(request).build(); &#125; catch (IOException e) &#123; if (logLevel != Logger.Level.NONE) &#123; logger.logIOException(metadata.configKey(), logLevel, e, elapsedTime(start)); &#125; throw errorExecuting(request, e); &#125; long elapsedTime = TimeUnit.NANOSECONDS.toMillis(System.nanoTime() - start); boolean shouldClose = true; try &#123; if (logLevel != Logger.Level.NONE) &#123; response = logger.logAndRebufferResponse(metadata.configKey(), logLevel, response, elapsedTime); // ensure the request is set. TODO: remove in Feign 10 response.toBuilder().request(request).build(); &#125; if (Response.class == metadata.returnType()) &#123; if (response.body() == null) &#123; return response; &#125; if (response.body().length() == null || response.body().length() &gt; MAX_RESPONSE_BUFFER_SIZE) &#123; shouldClose = false; return response; &#125; // Ensure the response body is disconnected byte[] bodyData = Util.toByteArray(response.body().asInputStream()); // æ­¤å¤„å°±æ˜¯è°ƒç”¨bodyæ–¹æ³•çš„åœ°æ–¹ï¼Œæ–­ç‚¹æ‰“åˆ°è¿™é‡Œï¼Œåœ¨å®žé™…debugè¿‡ç¨‹ä¸­å‘çŽ°å¹¶æ²¡æœ‰èµ°åˆ°è¿™é‡Œ return response.toBuilder().body(bodyData).build(); &#125; if (response.status() &gt;= 200 &amp;&amp; response.status() &lt; 300) &#123; if (void.class == metadata.returnType()) &#123; return null; &#125; else &#123; return decode(response); &#125; &#125; else if (decode404 &amp;&amp; response.status() == 404 &amp;&amp; void.class != metadata.returnType()) &#123; return decode(response); &#125; else &#123; throw errorDecoder.decode(metadata.configKey(), response); &#125; &#125; catch (IOException e) &#123; if (logLevel != Logger.Level.NONE) &#123; logger.logIOException(metadata.configKey(), logLevel, e, elapsedTime); &#125; throw errorReading(request, response, e); &#125; finally &#123; if (shouldClose) &#123; ensureClosed(response.body()); &#125; &#125;&#125; ç„¶åŽåœ¨Loggerçš„æ–¹æ³•ä¸­debugï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536protected Response logAndRebufferResponse(String configKey, Level logLevel, Response response, long elapsedTime) throws IOException &#123; String reason = response.reason() != null &amp;&amp; logLevel.compareTo(Level.NONE) &gt; 0 ? " " + response.reason() : ""; int status = response.status(); log(configKey, "&lt;--- HTTP/1.1 %s%s (%sms)", status, reason, elapsedTime); if (logLevel.ordinal() &gt;= Level.HEADERS.ordinal()) &#123; for (String field : response.headers().keySet()) &#123; for (String value : valuesOrEmpty(response.headers(), field)) &#123; log(configKey, "%s: %s", field, value); &#125; &#125; int bodyLength = 0; if (response.body() != null &amp;&amp; !(status == 204 || status == 205)) &#123; // HTTP 204 No Content "...response MUST NOT include a message-body" // HTTP 205 Reset Content "...response MUST NOT include an entity" if (logLevel.ordinal() &gt;= Level.FULL.ordinal()) &#123; log(configKey, ""); // CRLF &#125; byte[] bodyData = Util.toByteArray(response.body().asInputStream()); bodyLength = bodyData.length; if (logLevel.ordinal() &gt;= Level.FULL.ordinal() &amp;&amp; bodyLength &gt; 0) &#123; log(configKey, "%s", decodeOrDefault(bodyData, UTF_8, "Binary data")); &#125; log(configKey, "&lt;--- END HTTP (%s-byte body)", bodyLength); // æ­¤å¤„ä¼šè°ƒç”¨bodyæ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘åœ¨æœ¬åœ°è°ƒè¯•çš„æ—¶å€™ç¡®å®žä¼šèµ°åˆ°æ­¤å¤„ return response.toBuilder().body(bodyData).build(); &#125; else &#123; log(configKey, "&lt;--- END HTTP (%s-byte body)", bodyLength); &#125; &#125; return response;&#125; æœ€åŽå‘çŽ°ï¼ŒåŽŸæ¥æˆ‘ä¹‹å‰åœ¨å¼€å‘å’Œæµ‹è¯•çŽ¯å¢ƒä¸€ç›´é…ç½®çš„æ—¥å¿—æ‰“å°çº§åˆ«éƒ½æ˜¯debugï¼Œfeignä¸­çš„æ—¥å¿—åªæœ‰é…ç½®äº†debugçº§åˆ«æ‰ä¼šè¾“å‡ºï¼Œä¸Šé¢çš„ä»£ç å…¶å®žå°±æ˜¯å½“åˆ¤æ–­éœ€è¦è¾“å‡ºæ—¥å¿—æ—¶ï¼Œä¼šå…ˆæŠŠè¾“å…¥æµè½¬æˆbyte arrayç¼“å­˜èµ·æ¥ï¼Œå¹¶ä¸”ä¼šå°è£…æˆByteArrayBodyæ–¹ä¾¿åŽç»­å¤ç”¨è¯¥æµã€‚ç”Ÿäº§ä¸Šé¢é…ç½®çš„æ—¥å¿—çº§åˆ«æ˜¯infoï¼Œæ‰€ä»¥ä¼šå°è£…æˆInputStreamBodyï¼Œä¹Ÿå°±å¯¼è‡´åŽç»­èŽ·å–çš„è¾“å…¥æµæ˜¯ä¸æ”¯æŒmarkçš„ã€‚ è§£å†³æ–¹æ¡ˆ123456789101112131415//...ä¸Šä¸‹æ–‡æˆ‘å°±çœç•¥äº†ï¼ŒæŠŠæœ‰é—®é¢˜çš„ä»£ç æ®µè´´å‡ºæ¥InputStream inputStream = null;inputStream = fresp.body().asInputStream();Util.checkNotNull(inputStream, "inputstream from edfs is null");// æ ¡éªŒæµæ˜¯å¦æ”¯æŒæ ‡è®°if (!inputStream.markSupported()) &#123; inputStream = new ByteArrayInputStream(Util.toByteArray(inputStream));&#125;FileTypeJudger.FileInfo fileInfo = fileTypeJudger.judgeToFileInfo(inputStream);mimeType = fileInfo.getMimeType();// å¿…é¡»å°†æ¸¸æ ‡è®¾ç½®åˆ°èµ·å§‹ä½ç½®ï¼Œæ‰èƒ½è¾“å‡ºå®Œæ•´çš„æ–‡ä»¶æµinputStream.reset();//...]]></content>
      <categories>
        <category>feign</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>feign</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å…«å¤§æŽ’åºç®—æ³•çš„javaå®žçŽ°]]></title>
    <url>%2F2017%2F02%2F17%2F8-sort-arithmetic-of-java%2F</url>
    <content type="text"><![CDATA[æ¯å½“æåˆ°ç®—æ³•ï¼Œè‡ªç„¶å°‘ä¸äº†å„ç§æŽ’åºç®—æ³•ï¼Œä¾‹å¦‚å†’æ³¡æŽ’åºï¼Œå¿«é€ŸæŽ’åºç­‰ç­‰ã€‚è¿™ç¯‡æ–‡ç« å°†ä¼šä»‹ç»ç”¨javaæ¥å®žçŽ°å„ç§æŽ’åºç®—æ³•ï¼Œä¸€æ¥æ˜¯è‡ªå·±å†å·©å›ºä¸€ä¸‹è¿™ä¸€å—çŸ¥è¯†çš„ï¼ŒäºŒæ¥æ˜¯å°†è¿™å—çŸ¥è¯†åˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›å¤§å®¶å’Œæˆ‘ä¸€èµ·è¿›æ­¥ã€‚ æ’å…¥æŽ’åº åŸºæœ¬æ€æƒ³ï¼šå‡è®¾æœ‰ä¸€ç»„ä¸ªæ•°ä¸ºnçš„æ•°ï¼Œä»Žç¬¬äºŒæ•°å¼€å§‹ï¼ŒæŒ‰ç…§æ¯”è¾ƒè§„åˆ™æ’å…¥åˆ°ä¹‹å‰çš„æ•°ä¸­ï¼Œè¿™æ ·å‰é¢ä¸¤ä¸ªæ•°å°±å·²ç»æ˜¯æŽ’å¥½åºçš„ï¼Œç„¶åŽåœ¨ä»Žç¬¬ä¸‰ä¸ªæ•°å¼€å§‹æŒ‰ç…§åŒæ ·çš„è§„åˆ™æ’å…¥åˆ°ä¹‹å‰çš„æ•°ä¸­ï¼Œä¾æ¬¡ç±»æŽ¨ç›´åˆ°æ“ä½œåˆ°ç¬¬nä¸ªæ•°ã€‚ ä¸‹é¢æ˜¯å…·ä½“å®žçŽ°æºç ï¼š123456789101112131415public static void insertionSort(int[] arr) &#123; int j; for(int i = 1; i &lt; arr.length; i++) &#123; int tmp = arr[i]; for(j = i; j &gt; 0; j--) &#123; if ( tmp &lt; arr[j - 1]) &#123; arr[j] = arr[j - 1]; &#125; else &#123; break; &#125; &#125; arr[j] = tmp; &#125;&#125; å¸Œå°”æŽ’åº åŸºæœ¬æ€æƒ³ï¼šç®—æ³•å…ˆå°†è¦æŽ’åºçš„ä¸€ç»„æ•°æŒ‰æŸä¸ªå¢žé‡dï¼ˆn/2,nä¸ºè¦æŽ’åºæ•°çš„ä¸ªæ•°ï¼‰åˆ†æˆè‹¥å¹²ç»„ï¼Œæ¯ç»„ä¸­è®°å½•çš„ä¸‹æ ‡ç›¸å·®d.å¯¹æ¯ç»„ä¸­å…¨éƒ¨å…ƒç´ è¿›è¡Œç›´æŽ¥æ’å…¥æŽ’åºï¼Œç„¶åŽå†ç”¨ä¸€ä¸ªè¾ƒå°çš„å¢žé‡ï¼ˆd/2ï¼‰å¯¹å®ƒè¿›è¡Œåˆ†ç»„ï¼Œåœ¨æ¯ç»„ä¸­å†è¿›è¡Œç›´æŽ¥æ’å…¥æŽ’åºã€‚å½“å¢žé‡å‡åˆ°1æ—¶ï¼Œè¿›è¡Œç›´æŽ¥æ’å…¥æŽ’åºåŽï¼ŒæŽ’åºå®Œæˆã€‚ ä¸‹é¢æ˜¯å…·ä½“å®žçŽ°æºç ï¼š1234567891011121314151617181920public static void shellSort(int[] arr) &#123; int d1 = arr.length; while (true) &#123; d1 = (int) Math.ceil(d1 / 2); int d = d1; for (int x = 0; x &lt; d; x++) &#123; for (int i = x + d;i &lt; arr.length;i += d)&#123; int j = i - d; int temp = arr[i]; for (; j &gt;= 0 &amp;&amp; temp &lt; arr[j]; j -= d) &#123; arr[j+d] =arr[j]; &#125; arr[j+d] = temp; &#125; &#125; if (d == 1) &#123; break; &#125; &#125;&#125; ç®€å•é€‰æ‹©æŽ’åº åŸºæœ¬æ€æƒ³ï¼šåœ¨è¦æŽ’åºçš„ä¸€ç»„æ•°ä¸­ï¼Œé€‰å‡ºæœ€å°çš„ä¸€ä¸ªæ•°ä¸Žç¬¬ä¸€ä¸ªä½ç½®çš„æ•°äº¤æ¢ç„¶åŽåœ¨å‰©ä¸‹çš„æ•°å½“ä¸­å†æ‰¾æœ€å°çš„ä¸Žç¬¬äºŒä¸ªä½ç½®çš„æ•°äº¤æ¢ï¼Œå¦‚æ­¤å¾ªçŽ¯åˆ°å€’æ•°ç¬¬äºŒä¸ªæ•°å’Œæœ€åŽä¸€ä¸ªæ•°æ¯”è¾ƒä¸ºæ­¢ã€‚ ä¸‹é¢æ˜¯å…·ä½“å®žçŽ°æºç ï¼š1234567891011public static void selectSort(int[] arr) &#123; for (int i = 0; i &lt; arr.length; i++) &#123; for (int j = i + 1; j &lt; arr.length; j++) &#123; if (arr[j] &lt; arr[i]) &#123; int tmp = arr[i]; arr[i] = arr[j]; arr[j] = tmp; &#125; &#125; &#125;&#125; å †æŽ’åº åŸºæœ¬æ€æƒ³ï¼šå †æŽ’åºæ˜¯ä¸€ç§æ ‘å½¢é€‰æ‹©æŽ’åºï¼Œæ˜¯å¯¹ç›´æŽ¥é€‰æ‹©æŽ’åºçš„æœ‰æ•ˆæ”¹è¿›ã€‚å †çš„å®šä¹‰å¦‚ä¸‹ï¼šå…·æœ‰nä¸ªå…ƒç´ çš„åºåˆ—ï¼ˆh1,h2,â€¦,hn),å½“ä¸”ä»…å½“æ»¡è¶³ï¼ˆhi&gt;=h2i,hi&gt;=2i+1ï¼‰æˆ–ï¼ˆhi&lt;=h2i,hi&lt;=2i+1ï¼‰ (i=1,2,â€¦,n/2)æ—¶ç§°ä¹‹ä¸ºå †ã€‚åœ¨è¿™é‡Œåªè®¨è®ºæ»¡è¶³å‰è€…æ¡ä»¶çš„å †ã€‚ç”±å †çš„å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œå †é¡¶å…ƒç´ ï¼ˆå³ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰å¿…ä¸ºæœ€å¤§é¡¹ï¼ˆå¤§é¡¶å †ï¼‰ã€‚å®Œå…¨äºŒå‰æ ‘å¯ä»¥å¾ˆç›´è§‚åœ°è¡¨ç¤ºå †çš„ç»“æž„ã€‚å †é¡¶ä¸ºæ ¹ï¼Œå…¶å®ƒä¸ºå·¦å­æ ‘ã€å³å­æ ‘ã€‚åˆå§‹æ—¶æŠŠè¦æŽ’åºçš„æ•°çš„åºåˆ—çœ‹ä½œæ˜¯ä¸€æ£µé¡ºåºå­˜å‚¨çš„äºŒå‰æ ‘ï¼Œè°ƒæ•´å®ƒä»¬çš„å­˜å‚¨åºï¼Œä½¿ä¹‹æˆä¸ºä¸€ä¸ªå †ï¼Œè¿™æ—¶å †çš„æ ¹èŠ‚ç‚¹çš„æ•°æœ€å¤§ã€‚ç„¶åŽå°†æ ¹èŠ‚ç‚¹ä¸Žå †çš„æœ€åŽä¸€ä¸ªèŠ‚ç‚¹äº¤æ¢ã€‚ç„¶åŽå¯¹å‰é¢(n-1)ä¸ªæ•°é‡æ–°è°ƒæ•´ä½¿ä¹‹æˆä¸ºå †ã€‚ä¾æ­¤ç±»æŽ¨ï¼Œç›´åˆ°åªæœ‰ä¸¤ä¸ªèŠ‚ç‚¹çš„å †ï¼Œå¹¶å¯¹å®ƒä»¬ä½œäº¤æ¢ï¼Œæœ€åŽå¾—åˆ°æœ‰nä¸ªèŠ‚ç‚¹çš„æœ‰åºåºåˆ—ã€‚ä»Žç®—æ³•æè¿°æ¥çœ‹ï¼Œå †æŽ’åºéœ€è¦ä¸¤ä¸ªè¿‡ç¨‹ï¼Œä¸€æ˜¯å»ºç«‹å †ï¼ŒäºŒæ˜¯å †é¡¶ä¸Žå †çš„æœ€åŽä¸€ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ã€‚æ‰€ä»¥å †æŽ’åºæœ‰ä¸¤ä¸ªå‡½æ•°ç»„æˆã€‚ä¸€æ˜¯å»ºå †çš„æ¸—é€å‡½æ•°ï¼ŒäºŒæ˜¯åå¤è°ƒç”¨æ¸—é€å‡½æ•°å®žçŽ°æŽ’åºçš„å‡½æ•°ã€‚ ä¸‹é¢æ˜¯å…·ä½“å®žçŽ°æºç ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950public class HeapSort &#123; public void heapSort(int[] a) &#123; int arrayLength = a.length; //å¾ªçŽ¯å»ºå † for(int i = 0; i &lt; arrayLength - 1; i++)&#123; //å»ºå † buildMaxHeap(a, arrayLength - 1 - i); //äº¤æ¢å †é¡¶å’Œæœ€åŽä¸€ä¸ªå…ƒç´  swap(a, 0, arrayLength - 1 - i); &#125; &#125; //äº¤æ¢ä½ç½® private void swap(int[] data, int i, int j) &#123; int tmp = data[i]; data[i] = data[j]; data[j] = tmp; &#125; //å»ºå † private void buildMaxHeap(int[] data, int lastIndex) &#123; //ä»ŽlastIndexå¤„èŠ‚ç‚¹ï¼ˆæœ€åŽä¸€ä¸ªèŠ‚ç‚¹ï¼‰çš„çˆ¶èŠ‚ç‚¹å¼€å§‹ for (int i = (lastIndex - 1) / 2; i &gt;= 0; i--) &#123; //kä¿å­˜æ­£åœ¨åˆ¤æ–­çš„èŠ‚ç‚¹ int k = i; //å¦‚æžœå½“å‰kèŠ‚ç‚¹çš„å­èŠ‚ç‚¹å­˜åœ¨ while (k * 2 + 1 &lt;= lastIndex) &#123; //kèŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹çš„ç´¢å¼• int biggerIndex = 2 * k + 1; //å¦‚æžœbiggerIndexå°äºŽlastIndexï¼Œå³biggerIndex+1ä»£è¡¨çš„kèŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹å­˜åœ¨ if (biggerIndex &lt; lastIndex) &#123; //è‹¥æžœå³å­èŠ‚ç‚¹çš„å€¼è¾ƒå¤§ if (data[biggerIndex] &lt; data[biggerIndex + 1]) &#123; //biggerIndexæ€»æ˜¯è®°å½•è¾ƒå¤§å­èŠ‚ç‚¹çš„ç´¢å¼• biggerIndex++; &#125; &#125; //å¦‚æžœkèŠ‚ç‚¹çš„å€¼å°äºŽå…¶è¾ƒå¤§çš„å­èŠ‚ç‚¹çš„å€¼ if (data[k] &lt; data[biggerIndex]) &#123; //äº¤æ¢ä»–ä»¬ swap(data, k, biggerIndex); //å°†biggerIndexèµ‹äºˆkï¼Œå¼€å§‹whileå¾ªçŽ¯çš„ä¸‹ä¸€æ¬¡å¾ªçŽ¯ï¼Œé‡æ–°ä¿è¯kèŠ‚ç‚¹çš„å€¼å¤§äºŽå…¶å·¦å³å­èŠ‚ç‚¹çš„å€¼ k = biggerIndex; &#125; else &#123; break; &#125; &#125; &#125; &#125;&#125; å†’æ³¡æŽ’åº åŸºæœ¬æ€æƒ³ï¼šå‡è®¾æœ‰ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œä»Žç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œæ¯ä¸¤ä¸ªç›¸é‚»çš„ä½ç½®çš„æ•°å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æžœå‰é¢ä¸€ä¸ªä½ç½®çš„æ•°å€¼æ¯”åŽé¢ä¸€ä¸ªä½ç½®çš„æ•°å€¼å¤§ï¼Œå°±äº¤æ¢è¿™ä¸¤ä¸ªä½ç½®çš„æ•°å€¼ï¼Œå½“æœ€åŽä¸€å¯¹æ•°æ¯”è¾ƒå®Œæ¯•ä¹‹åŽï¼Œæœ€åŽä¸€ä¸ªä½ç½®çš„æ•°å€¼å°±æ˜¯æœ€å¤§å€¼ã€‚ç„¶åŽæˆ‘ä»¬å†ä»¥ç›¸åŒçš„æ­¥éª¤æ“ä½œæ•°ç»„ä¸­é™¤äº†æœ€åŽä¸€ä¸ªä½ç½®çš„æ‰€æœ‰å€¼ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å€¼éœ€è¦æ¯”è¾ƒã€‚ ä¸‹é¢æ˜¯å…·ä½“å®žçŽ°æºç ï¼š1234567891011public static void bubbleSort(int[] arr) &#123; for (int i = 0; i &lt; arr.length; i++) &#123; for (int j = 0; j &lt; arr.length - 1; j++) &#123; if (arr[j] &gt; arr[j + 1]) &#123; int tmp = arr[j]; arr[j] = arr[j + 1]; arr[j + 1] = tmp; &#125; &#125; &#125;&#125; å¿«é€ŸæŽ’åº åŸºæœ¬æ€æƒ³ï¼šå‡è®¾æœ‰ä¸€ä¸ªé•¿åº¦ä¸ºnçš„é›†åˆï¼Œå°†ä¸­é—´çš„å…ƒç´ ä½œä¸ºä¸­è½´ï¼ŒæŠŠé›†åˆä¸­çš„æ‰€æœ‰å°äºŽè¯¥ä¸­è½´çš„å…ƒç´ æ”¾åœ¨ä¸­è½´å·¦è¾¹ï¼ŒæŠŠé›†åˆä¸­çš„æ‰€æœ‰å¤§äºŽè¯¥ä¸­è½´çš„å…ƒç´ æ”¾åœ¨å³è¾¹ï¼Œç„¶åŽåœ¨ä»¥ç›¸åŒçš„é€»è¾‘åˆ†åˆ«å¤„ç†ä¸­è½´å·¦è¾¹å’Œå³è¾¹çš„é›†åˆï¼Œä¾æ¬¡é€’å½’ï¼Œç›´åˆ°ä¸­è½´å·¦è¾¹å’Œå³è¾¹çš„å…ƒç´ ä¸ªæ•°éƒ½ä¸º1ã€‚ ä¸‹é¢æ˜¯å…·ä½“å®žçŽ°ä»£ç ï¼š1234567891011121314151617181920212223242526public static void fastSort(List&lt;Integer&gt; items) &#123; if (items.size() &gt; 1) &#123; List&lt;Integer&gt; smaller = new ArrayList&lt;&gt;(); List&lt;Integer&gt; same = new ArrayList&lt;&gt;(); List&lt;Integer&gt; larger = new ArrayList&lt;&gt;(); Integer chosenItem = items.get(items.size() / 2); for (Integer item : items) &#123; if (item &lt; chosenItem) &#123; smaller.add(item); &#125; else if (item &gt; chosenItem) &#123; larger.add(item); &#125; else &#123; same.add(item); &#125; &#125; fastSort(smaller); fastSort(larger); items.clear(); items.addAll(smaller); items.addAll(same); items.addAll(larger); &#125;&#125; å½’å¹¶æŽ’åº åŸºæœ¬æ€æƒ³ï¼šå½’å¹¶ï¼ˆMergeï¼‰æŽ’åºæ³•æ˜¯å°†ä¸¤ä¸ªï¼ˆæˆ–ä¸¤ä¸ªä»¥ä¸Šï¼‰æœ‰åºè¡¨åˆå¹¶æˆä¸€ä¸ªæ–°çš„æœ‰åºè¡¨ï¼Œå³æŠŠå¾…æŽ’åºåºåˆ—åˆ†ä¸ºè‹¥å¹²ä¸ªå­åºåˆ—ï¼Œæ¯ä¸ªå­åºåˆ—æ˜¯æœ‰åºçš„ã€‚ç„¶åŽå†æŠŠæœ‰åºå­åºåˆ—åˆå¹¶ä¸ºæ•´ä½“æœ‰åºåºåˆ—ã€‚ ä¸‹é¢æ˜¯å…·ä½“å®žçŽ°ä»£ç ï¼š1234567891011121314151617181920212223242526272829303132333435public class MergeSort &#123; public static void sort(int data[], int start, int end) &#123; if (start &lt; end) &#123; int mid = (start + end) / 2; sort(data, start, mid); sort(data, mid + 1, end); merge(data, start, mid, end); &#125; &#125; public static void merge(int data[], int start, int mid, int end) &#123; int temp[] = new int[end - start + 1]; int i = start; int j = mid + 1; int k = 0; while (i &lt;= mid &amp;&amp; j &lt;= end) &#123; if (data[i] &lt; data[j]) &#123; temp[k++] = data[i++]; &#125; else &#123; temp[k++] = data[j++]; &#125; &#125; while (i &lt;= mid) &#123; temp[k++] = data[i++]; &#125; while (j &lt;= end) &#123; temp[k++] = data[j++]; &#125; for (k = 0, i = start; k &lt; temp.length; k++, i++) &#123; data[i] = temp[k]; &#125; &#125;&#125; åŸºæ•°æŽ’åº åŸºæœ¬æ€æƒ³ï¼šå°†æ‰€æœ‰å¾…æ¯”è¾ƒæ•°å€¼ï¼ˆæ­£æ•´æ•°ï¼‰ç»Ÿä¸€ä¸ºåŒæ ·çš„æ•°ä½é•¿åº¦ï¼Œæ•°ä½è¾ƒçŸ­çš„æ•°å‰é¢è¡¥é›¶ã€‚ç„¶åŽï¼Œä»Žæœ€ä½Žä½å¼€å§‹ï¼Œä¾æ¬¡è¿›è¡Œä¸€æ¬¡æŽ’åºã€‚è¿™æ ·ä»Žæœ€ä½Žä½æŽ’åºä¸€ç›´åˆ°æœ€é«˜ä½æŽ’åºå®Œæˆä»¥åŽ,æ•°åˆ—å°±å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ã€‚ ä¸‹é¢æ˜¯å…·ä½“å®žçŽ°ä»£ç ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546public static class radixSort &#123; public void sort(int[] array) &#123; //é¦–å…ˆç¡®å®šæŽ’åºçš„è¶Ÿæ•°; int max = array[0]; for (int i = 1; i &lt; array.length; i++) &#123; if (array[i] &gt; max) &#123; max = array[i]; &#125; &#125; int time = 0; //åˆ¤æ–­ä½æ•°; while (max &gt; 0) &#123; max /= 10; time++; &#125; //å»ºç«‹10ä¸ªé˜Ÿåˆ—; List&lt;ArrayList&gt; queue = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10; i++) &#123; ArrayList&lt;Integer&gt; queue1 = new ArrayList&lt;&gt;(); queue.add(queue1); &#125; //è¿›è¡Œtimeæ¬¡åˆ†é…å’Œæ”¶é›†; for (int i = 0; i &lt; time; i++) &#123; //åˆ†é…æ•°ç»„å…ƒç´ ; for (int j = 0; j &lt; array.length; j++) &#123; //å¾—åˆ°æ•°å­—çš„ç¬¬time+1ä½æ•°; int x = array[j] % (int) Math.pow(10, i + 1) / (int) Math.pow(10, i); ArrayList&lt;Integer&gt; queue2 = queue.get(x); queue2.add(array[j]); queue.set(x, queue2); &#125; int count = 0;//å…ƒç´ è®¡æ•°å™¨; //æ”¶é›†é˜Ÿåˆ—å…ƒç´ ; for (int k = 0; k &lt; 10; k++) &#123; while (queue.get(k).size() &gt; 0) &#123; ArrayList&lt;Integer&gt; queue3 = queue.get(k); array[count] = queue3.get(0); queue3.remove(0); count++; &#125; &#125; &#125; &#125;&#125;]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢ä»Žä½¿ç”¨Hexoæ­å»ºåšå®¢å¼€å§‹]]></title>
    <url>%2F2017%2F02%2F04%2Fmy-first-blog-start-with-build-blog-using-hexo%2F</url>
    <content type="text"><![CDATA[Hexoæ˜¯ä¸€æ¬¾å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æž¶ï¼Œç”¨å®ƒæ¥æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»æˆ‘æ˜¯å¦‚ä½•ä½¿ç”¨è¯¥æ¡†æž¶æ¥æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢ã€‚ Hexoå®‰è£…åŠç›¸å…³é…ç½®å®‰è£…Hexoå®‰è£…å¾ˆç®€å•ï¼Œmacå’Œwindowséƒ½æœ‰è¯¦ç»†çš„å®‰è£…æ•™ç¨‹ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªhexoå®˜æ–¹è¯¦ç»†çš„å®‰è£…æ•™ç¨‹é“¾æŽ¥ã€‚ æ‰“å¼€æœ¬åœ°ç»ˆç«¯ï¼Œç„¶åŽæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåˆå§‹åŒ–å·¥ä½œç›®å½•123$ hexo init &lt;folder-path&gt;$ cd &lt;folder-path&gt;$ npm install æ‰§è¡Œå®Œä»¥ä¸Šå‘½ä»¤ä¹‹åŽï¼Œå·¥ä½œç›®å½•å°±åˆå§‹åŒ–å®Œæˆäº†ã€‚ é…ç½®è¿›å…¥å·¥ä½œç›®å½•ä¼šå‘çŽ°æœ‰ä¸€ä¸ª_config.ymlçš„æ–‡ä»¶ï¼Œé…ç½®å°±æ˜¯åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ å’Œä¿®æ”¹çš„ã€‚ è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹å‡ ä¸ªå¸¸ç”¨çš„å‚æ•°ï¼š å‚æ•°å æè¿° title ç½‘ç«™æ ‡é¢˜ subtitle ç½‘ç«™å‰¯æ ‡é¢˜ description ç½‘ç«™æè¿° author ä½ çš„åå­— language ç½‘ç«™ä½¿ç”¨çš„è¯­è¨€ï¼Œä¾‹å¦‚zh-Hanså°±æ˜¯æŒ‡ä¸­æ–‡ timezone ç½‘ç«™æ—¶åŒºï¼Œä¾‹å¦‚Asia/Shanghaiå°±æ˜¯æŒ‡ä¸Šæµ·æ—¶åŒº theme ç½‘ç«™ä¸»é¢˜ï¼Œä½¿ç”¨ä¹‹å‰éœ€è¦å…ˆå®‰è£… avatar ä½ çš„å¤´åƒ favicon ç½‘é¡µtagçš„å°å›¾æ ‡ è¿™äº›çŸ¥è¯†ç®€å•ä»‹ç»ä¸€ä¸‹ï¼Œå…·ä½“çš„é…ç½®è¯´æ˜Žè¯¦è§Hexoå®˜æ–¹é…ç½®è¯´æ˜Ž Hexoä¸»é¢˜Nextå®‰è£…åŠç›¸å…³é…ç½®å®‰è£…æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š12$ cd &lt;folder-path&gt;$ git clone https://github.com/iissnan/hexo-theme-next themes/next å‘½ä»¤æ‰§è¡Œå®Œæˆä¹‹åŽï¼Œç¼–è¾‘_config.ymlæ–‡ä»¶ï¼Œå°†themeå‚æ•°çš„ä¿®æ”¹æˆnextã€‚ ç„¶åŽæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œæ¸…é™¤Hexoç¼“å­˜ï¼š1$ hexo clean é…ç½®Nextä¸»é¢˜ä¹Ÿæœ‰å¾ˆå¤šé…ç½®å‚æ•°ï¼Œè¿™é‡Œæˆ‘è¿˜æ˜¯ç®€å•ä»‹ç»ä¸€äº›å¸¸ç”¨çš„ï¼š å‚æ•°å æè¿° scheme å¤–è§‚é…ç½®ï¼Œæ”¯æŒä¸‰ç§ï¼ˆMuse,Mist,Piscesï¼‰ language ç½‘ç«™è¯­è¨€ï¼Œå’ŒHexoä¸­çš„ç±»ä¼¼ menu èœå•é…ç½® å…·ä½“çš„é…ç½®è¯´æ˜Žè¯¦è§Nextå®˜æ–¹é…ç½®è¯´æ˜Žã€‚ å°†ç½‘ç«™æ‰˜ç®¡åˆ°githubä¸Šåˆ›å»ºä»“åº“githubä¸­åˆ›å»ºä¸€ä¸ªä»“åº“è¿™é‡Œå°±ä¸è¯¦ç»†è¯´æ˜Žäº†ï¼ŒæŠŠå‡ ç‚¹æ³¨æ„äº‹é¡¹è¯´æ˜Žä¸€ä¸‹ï¼š ä»“åº“å¿…é¡»æ˜¯publicçš„ ä»“åº“åç§°è¦ä»¥yourname.github.ioçš„æ ¼å¼å‘½å å°†æœ¬åœ°æœºå™¨çš„å…¬é’¥æ·»åŠ åˆ°ä½ çš„githubä¸­ å…³è”æœ¬åœ°ç½‘ç«™åˆ°githubä»“åº“ä¸­åœ¨Hexoçš„é…ç½®æ–‡ä»¶_config.ymlä¸­ä¿®æ”¹å¦‚ä¸‹é…ç½®ï¼š1234deploy: type: git repository: &lt;ä½ çš„githubæ–°å»ºçš„ä»“åº“åœ°å€&gt; branch: master ä¿®æ”¹å®Œæˆä¹‹åŽï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š123$ hexo clean$ hexo g$ hexo d å°†ç½‘ç«™éƒ¨ç½²åˆ°githubä¸­ã€‚ éƒ¨ç½²å®Œæˆä¹‹åŽä½ å¯ä»¥é€šè¿‡è®¿é—® https://yourname.github.io åœ°å€ï¼Œå¦‚æžœèƒ½å¤Ÿè®¿é—®ï¼Œè¯´æ˜Žä½ åœ¨æœ¬åœ°é…ç½®å¥½çš„ç½‘ç«™å·²ç»æˆåŠŸéƒ¨ç½²åˆ°githubä¸­äº†ã€‚ å¦‚ä½•å¯¹æœ¬åœ°ç½‘ç«™è¿›è¡Œç‰ˆæœ¬æŽ§åˆ¶è¿›è¿‡å¦‚ä¸Šæ­¥éª¤ä¹‹åŽä½ çš„ç½‘ç«™å·²ç»æˆåŠŸéƒ¨ç½²åˆ°githubä¸­äº†ï¼Œä½†æ˜¯å¦‚æžœå¯¹ä½ çš„ç½‘ç«™è¿›è¡Œç‰ˆæœ¬æŽ§åˆ¶å‘¢ï¼Ÿ æˆ‘æ˜¯å‚è€ƒåˆ©ç”¨gitè§£å†³hexoåšå®¢å¤šPCé—´åŒæ­¥é—®é¢˜è¿™ç¯‡åšå®¢çš„åšæ³•ï¼šåˆ©ç”¨oschinaçš„ç§æœ‰ä»“åº“æ¥è¿›è¡Œç‰ˆæœ¬æŽ§åˆ¶ï¼Œåœ¨ç½‘ç«™å·¥ä½œæ ¹è·¯å¾„ä¸‹å°†è¯¥ç›®å½•é‡æ–°åˆå§‹åŒ–æˆæœ¬åœ°gitä»“åº“ï¼Œç„¶åŽå°†æœ¬åœ°ä»“åº“æäº¤åˆ°oschinaçš„ç§æœ‰ä»“åº“ä¸­ã€‚]]></content>
      <categories>
        <category>åšå®¢</category>
      </categories>
      <tags>
        <tag>blog</tag>
      </tags>
  </entry>
</search>
