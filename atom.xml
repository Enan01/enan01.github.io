<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>è¿½é£å¤§è™¾go</title>
  
  <subtitle>doublesouth&#39;s blog</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-07-12T08:07:02.667Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>doublesouth</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ç¼–è¯‘microä¸€æ³¢ä¸‰æŠ˜</title>
    <link href="http://yoursite.com/2019/07/12/%E7%BC%96%E8%AF%91micro%E4%B8%80%E6%B3%A2%E4%B8%89%E6%8A%98/"/>
    <id>http://yoursite.com/2019/07/12/ç¼–è¯‘microä¸€æ³¢ä¸‰æŠ˜/</id>
    <published>2019-07-12T07:48:00.000Z</published>
    <updated>2019-07-12T08:07:02.667Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ç”±äºæœ¬æœºä¸Šmicroç‰ˆæœ¬è¾ƒä½ï¼Œå…¶å®æœ¬æœºç‰ˆæœ¬æ˜¯0.13.0ï¼Œç„¶åç”¨è¿™ä¸ªç‰ˆæœ¬å‘½ä»¤è¡Œè°ƒç”¨è¿œç¨‹rpcä¸€ç›´æŠ¥ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"id"</span>: <span class="string">"go.micro.client.codec"</span>,</div><div class="line">  <span class="attr">"code"</span>: <span class="number">500</span>,</div><div class="line">  <span class="attr">"detail"</span>: <span class="string">"json: cannot unmarshal string into Go struct field clientResponse.id of type uint64"</span>,</div><div class="line">  <span class="attr">"status"</span>: <span class="string">"Internal Server Error"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æ•…éœ€è¦å‡çº§æœ¬æœºmicroç‰ˆæœ¬ã€‚</p><p><strong>å‡çº§ç‰ˆæœ¬</strong>: 1.5.0</p><a id="more"></a><p>å‡çº§è¿‡ç¨‹å¯è°“ä¸€æ³¢ä¸‰æŠ˜ï¼Œå‘ä¸­æœ‰å‘å•Šã€‚ä»¥ä¸‹å†…å®¹å¯èƒ½ä¼šè®©ä½ æœ‰ç ¸ç”µè„‘çš„å†²åŠ¨ï¼Œè¯·ä¸‰æ€è€Œåè¡Œã€‚</p><h2 id="ä¸‹é¢ç®€å•ä»‹ç»å‡çº§è¿‡ç¨‹"><a href="#ä¸‹é¢ç®€å•ä»‹ç»å‡çº§è¿‡ç¨‹" class="headerlink" title="ä¸‹é¢ç®€å•ä»‹ç»å‡çº§è¿‡ç¨‹"></a>ä¸‹é¢ç®€å•ä»‹ç»å‡çº§è¿‡ç¨‹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// æ‹‰å–microæºç åˆ°æœ¬åœ°</div><div class="line">git clone https://github.com/micro/micro.git</div><div class="line"></div><div class="line">// åˆ‡æ¢åˆ°v1.6.0ç‰ˆæœ¬</div><div class="line">git checkout v1.6.0</div><div class="line"></div><div class="line">// æœ¬åœ°åŸºäºv1.6.0ç‰ˆæœ¬åˆ›å»ºä¸€ä¸ªæ–°çš„v1.6.0ç‰ˆæœ¬åˆ†æ”¯</div><div class="line">git checkout -b v1.6.0</div></pre></td></tr></table></figure><p>ä»¥ä¸Šæ­¥éª¤æ“ä½œå®Œæˆä¹‹åå·²åœ¨æœ¬åœ°åˆ›å»ºäº†microçš„v1.6.0ç‰ˆæœ¬åˆ†æ”¯ï¼Œä¸‹é¢æˆ‘ä»¬ä¼šåŸºäºè¿™ä¸ªåˆ†æ”¯æ¥ç¼–è¯‘microã€‚</p><hr><p>ç”±äºæœ¬åœ°é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†microçš„ç¬¬ä¸‰æ–¹pluginï¼Œå…·ä½“åŒ…å«:</p><p><strong>registry</strong> ï¼š<code>etcdv3</code><br><strong>transport</strong> ï¼š<code>tcp</code></p><p>æ‰€ä»¥åœ¨ç¼–è¯‘microçš„æ—¶å€™éœ€è¦å°†è¿™ä¸¤ä¸ªæ’ä»¶åŒ…å«è¿›æ¥ã€‚</p><p>æˆ‘ä»¬éœ€è¦åœ¨æºç ç›®å½•ä¸­åˆ›å»º <code>plugins.go</code> æ–‡ä»¶ç”¨æ¥å¼•ç”¨è¿™äº›pluginï¼Œæ–‡ä»¶ç›®å½•ä¸ºmicroæºç æ ¹ç›®å½•ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Dockerfile README.md  bot        cmd        go.sum     main.go    new        plugins.go scripts    web</div><div class="line">LICENSE    api        cli        go.mod     internal   network    plugin     proxy      service</div></pre></td></tr></table></figure><p>åœ¨æºç ç›®å½•ä¸­æ–°å¢äº†ä¸€ä¸ª <code>plugins.go</code> æ–‡ä»¶ï¼Œ æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">        _ <span class="string">"github.com/micro/go-plugins/registry/etcdv3"</span></div><div class="line">        _ <span class="string">"github.com/micro/go-plugins/transport/tcp"</span></div><div class="line">)</div></pre></td></tr></table></figure><p>æ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œåªè¦å°†ä¾èµ–çš„æ’ä»¶åŒ…å¼•ç”¨è¿›æ¥å³å¯ï¼Œ666â€¦â€¦â€¦â€¦â€¦â€¦..</p><hr><p>å¥½äº†ï¼Œä¸Šé¢æ–‡ä»¶å·²ç»åˆ›å»ºå¥½äº†ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥å°è¯•ç¼–è¯‘microäº†ï¼Œè¯ä¸å¤šè¯´ï¼Œè¡ŒåŠ¨èµ·æ¥å§</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// åœ¨æºç æ ¹ç›®å½•è¿è¡Œå¦‚ä¸‹å‘½ä»¤</div><div class="line">GO111MODULE=on go build -i -o micro main.go plugins.go</div></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œç°å®æ€»æ˜¯æ®‹é…·çš„ï¼Œæˆ‘ä»¬çœ‹åˆ°æŠ¥äº†å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">go: finding github.com/micro/go-plugins/registry/etcdv3 latest</div><div class="line">go: finding github.com/micro/go-plugins/transport/tcp latest</div><div class="line">go: finding github.com/micro/go-plugins/registry latest</div><div class="line">go: finding github.com/micro/go-plugins/transport latest</div><div class="line">go: finding github.com/nats-io/nats.go v1.8.2-0.20190607221125-9f4d16fe7c2d</div><div class="line">go: github.com/nats-io/nats.go@v1.8.2-0.20190607221125-9f4d16fe7c2d: unknown revision 9f4d16fe7c2d</div><div class="line">go: error loading module requirements</div></pre></td></tr></table></figure><p>å‘ç°æ— æ³•è¯†åˆ« github.com/nats-io/nats.go@v1.8.2-0.20190607221125-9f4d16fe7c2d</p><p>ä»githubä¸­æŸ¥çœ‹github.com/nats-io/nats.goä»“åº“ï¼Œå‘ç°ç›®å‰æœ€æ–°çš„releaseç‰ˆæœ¬ä¸ºv1.8.1ï¼Œå‹æ ¹å„¿å°±æ²¡æœ‰v1.8.2ç‰ˆæœ¬ã€‚</p><p>ç„¶åå¼€å§‹ä»æºç ä¸­æŸ¥æ‰¾å“ªé‡Œä¾èµ–äº†è¿™ä¸ªç‰ˆæœ¬çš„ä»“åº“ï¼Œå‘ç° go-plugins@v1.1.1 ä¾èµ–äº†ã€‚</p><p>å°è¯•å¦‚ä½•è§£å†³ï¼Œé¦–å…ˆæŸ¥çœ‹microæºç ä¸­çš„go.modæ–‡ä»¶ä¸­æ˜¯å¦æœ‰ä¾èµ– go-plugins@v1.1.1ï¼Œ å†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">module github.com/micro/micro</div><div class="line"></div><div class="line">go 1.12</div><div class="line"></div><div class="line">require (</div><div class="line">github.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e</div><div class="line">github.com/golang/protobuf v1.3.1</div><div class="line">github.com/google/uuid v1.1.1</div><div class="line">github.com/gorilla/mux v1.7.2</div><div class="line">github.com/micro/cli v0.2.0</div><div class="line">github.com/micro/go-micro v1.6.0</div><div class="line">github.com/serenize/snaker v0.0.0-20171204205717-a683aaf2d516</div><div class="line">github.com/xlab/treeprint v0.0.0-20181112141820-a009c3971eca</div><div class="line">golang.org/x/net v0.0.0-20190606173856-1492cefac77f</div><div class="line">google.golang.org/genproto v0.0.0-20180831171423-11092d34479b // indirect</div><div class="line">google.golang.org/grpc v1.21.1</div><div class="line">)</div></pre></td></tr></table></figure><p>å‘ç°å¹¶æ²¡æœ‰ä¾èµ–ï¼Œæ‰€ä»¥ä¹‹å‰ç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨äº†æœ€æ–°çš„ç‰ˆæœ¬ã€‚æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹go-pluginsç‰ˆæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">module github.com/micro/micro</div><div class="line"></div><div class="line">go 1.12</div><div class="line"></div><div class="line">require (</div><div class="line">github.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e</div><div class="line">github.com/golang/protobuf v1.3.1</div><div class="line">github.com/google/uuid v1.1.1</div><div class="line">github.com/gorilla/mux v1.7.2</div><div class="line">github.com/micro/cli v0.2.0</div><div class="line">github.com/micro/go-micro v1.6.0</div><div class="line">github.com/serenize/snaker v0.0.0-20171204205717-a683aaf2d516</div><div class="line">github.com/xlab/treeprint v0.0.0-20181112141820-a009c3971eca</div><div class="line">golang.org/x/net v0.0.0-20190606173856-1492cefac77f</div><div class="line">google.golang.org/genproto v0.0.0-20180831171423-11092d34479b // indirect</div><div class="line">google.golang.org/grpc v1.21.1</div><div class="line">github.com/micro/go-plugins v1.1.0</div><div class="line">)</div></pre></td></tr></table></figure><hr><p>å†æ¬¡ç¼–è¯‘â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦..</p><p>å“‡å‘€å‘€å‘€å‘€å‘€å‘€â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦.</p><p>åˆæŠ¥é”™äº†/(ã„’oã„’)/~</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">go: github.com/golang/lint@v0.0.0-20190313153728-d0100b6bd8b3: parsing go.mod: unexpected module path &quot;golang.org/x/lint&quot;</div><div class="line">go: github.com/testcontainers/testcontainer-go@v0.0.2: parsing go.mod: unexpected module path &quot;github.com/testcontainers/testcontainers-go&quot;</div><div class="line">go: error loading module requirements</div></pre></td></tr></table></figure><p>å¥½åœ¨è¿™ä¸ªé—®é¢˜å·²ç»æœ‰äººè¸©è¿‡å‘äº†ï¼Œå‚è€ƒé“¾æ¥ï¼š<a href="https://github.com/golang/lint/issues/446#issuecomment-483638233" target="_blank" rel="external">https://github.com/golang/lint/issues/446#issuecomment-483638233</a></p><p>è¿™ä¸ªåªæ˜¯lintçš„è§£å†³æ–¹æ¡ˆï¼ŒtestcontainersåŒç†ï¼Œä¿®æ”¹ä¹‹åçš„go.modå¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">module github.com/micro/micro</div><div class="line"></div><div class="line">go 1.12</div><div class="line"></div><div class="line">require (</div><div class="line">github.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e</div><div class="line">github.com/golang/protobuf v1.3.1</div><div class="line">github.com/google/uuid v1.1.1</div><div class="line">github.com/gorilla/mux v1.7.2</div><div class="line">github.com/micro/cli v0.2.0</div><div class="line">github.com/micro/go-micro v1.6.0</div><div class="line">github.com/serenize/snaker v0.0.0-20171204205717-a683aaf2d516</div><div class="line">github.com/xlab/treeprint v0.0.0-20181112141820-a009c3971eca</div><div class="line">golang.org/x/net v0.0.0-20190606173856-1492cefac77f</div><div class="line">google.golang.org/genproto v0.0.0-20180831171423-11092d34479b // indirect</div><div class="line">google.golang.org/grpc v1.21.1</div><div class="line">github.com/micro/go-plugins v1.1.0</div><div class="line">)</div><div class="line"></div><div class="line">replace github.com/golang/lint =&gt; golang.org/x/lint v0.0.0-20190409202823-959b441ac422</div><div class="line"></div><div class="line">replace github.com/testcontainers/testcontainer-go =&gt; github.com/testcontainers/testcontainers-go v0.0.0-20181115231424-8e868ca12c0f</div></pre></td></tr></table></figure><hr><p>å¿ƒæƒ³è¿™å›åº”è¯¥å¯ä»¥å¤§åŠŸå‘Šæˆäº†å§ï¼Œæˆ‘ä»¬å†æ¥ä¸€éã€‚</p><p>ğŸ¤®ğŸ¤®ğŸ¤®ğŸ¤®ğŸ¤®ğŸ¤®ğŸ¤®ï¼Œâ€ä¸­æ¯’èº«äº¡â€</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">build command-line-arguments: cannot load github.com/hashicorp/consul/api: ambiguous import: found github.com/hashicorp/consul/api in multiple modules:</div><div class="line">github.com/hashicorp/consul v1.4.4 (/Users/doublesouth/Documents/mycode/golang/lib/pkg/mod/github.com/hashicorp/consul@v1.4.4/api)</div><div class="line">github.com/hashicorp/consul/api v1.1.0 (/Users/doublesouth/Documents/mycode/golang/lib/pkg/mod/github.com/hashicorp/consul/api@v1.1.0)</div></pre></td></tr></table></figure><p>è¿˜æœ‰æœ€åä¸€å£æ°”ï¼Œæˆ‘ä»¬å†åšæŒä¸€ä¸‹â€¦</p><p>åˆæ˜¯å„ç§ç½‘ä¸ŠæŸ¥æ‰¾</p><p>æœ€ååŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼š<a href="https://github.com/hashicorp/consul/issues/6019#issuecomment-505782870" target="_blank" rel="external">https://github.com/hashicorp/consul/issues/6019#issuecomment-505782870</a></p><p>githubçœŸçš„æ˜¯ä¸ªå¾ˆç¥å¥‡çš„ç½‘ç«™ğŸ˜ï¼Œå†æ¬¡ä¿®æ”¹go.mod:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">module github.com/micro/micro</div><div class="line"></div><div class="line">go 1.12</div><div class="line"></div><div class="line">require (</div><div class="line">github.com/SAP/go-hdb v0.14.1 // indirect</div><div class="line">github.com/StackExchange/wmi v0.0.0-20181212234831-e0a55b97c705 // indirect</div><div class="line">github.com/armon/circbuf v0.0.0-20190214190532-5111143e8da2 // indirect</div><div class="line">github.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e</div><div class="line">github.com/coredns/coredns v1.4.0 // indirect</div><div class="line">github.com/envoyproxy/go-control-plane v0.6.9 // indirect</div><div class="line">github.com/go-ole/go-ole v1.2.4 // indirect</div><div class="line">github.com/golang/protobuf v1.3.1</div><div class="line">github.com/google/btree v1.0.0 // indirect</div><div class="line">github.com/google/uuid v1.1.1</div><div class="line">github.com/gorilla/mux v1.7.2</div><div class="line">github.com/hashicorp/consul v1.4.4 // indirect</div><div class="line">github.com/hashicorp/go-gcp-common v0.5.0 // indirect</div><div class="line">github.com/hashicorp/go-memdb v1.0.0 // indirect</div><div class="line">github.com/hashicorp/go-plugin v1.0.0 // indirect</div><div class="line">github.com/hashicorp/go-retryablehttp v0.5.3 // indirect</div><div class="line">github.com/hashicorp/hil v0.0.0-20190212132231-97b3a9cdfa93 // indirect</div><div class="line">github.com/hashicorp/raft-boltdb v0.0.0-20171010151810-6e5ba93211ea // indirect</div><div class="line">github.com/hashicorp/vault v1.1.0 // indirect</div><div class="line">github.com/hashicorp/vault-plugin-auth-alicloud v0.0.0-20190320211238-36e70c54375f // indirect</div><div class="line">github.com/hashicorp/vault-plugin-auth-azure v0.0.0-20190320211138-f34b96803f04 // indirect</div><div class="line">github.com/hashicorp/vault-plugin-auth-centrify v0.0.0-20190320211357-44eb061bdfd8 // indirect</div><div class="line">github.com/hashicorp/vault-plugin-auth-kubernetes v0.0.0-20190328163920-79931ee7aad5 // indirect</div><div class="line">github.com/hashicorp/vault-plugin-secrets-ad v0.0.0-20190327182327-ed2c3d4c3d95 // indirect</div><div class="line">github.com/hashicorp/vault-plugin-secrets-alicloud v0.0.0-20190320213517-3307bdf683cb // indirect</div><div class="line">github.com/hashicorp/vault-plugin-secrets-azure v0.0.0-20190320211922-2dc8a8a5e490 // indirect</div><div class="line">github.com/hashicorp/vault-plugin-secrets-gcp v0.0.0-20190320211452-71903323ecb4 // indirect</div><div class="line">github.com/hashicorp/vault-plugin-secrets-gcpkms v0.0.0-20190320213325-9e326a9e802d // indirect</div><div class="line">github.com/influxdata/influxdb v1.7.5 // indirect</div><div class="line">github.com/lyft/protoc-gen-validate v0.0.14 // indirect</div><div class="line">github.com/mattn/go-colorable v0.1.1 // indirect</div><div class="line">github.com/micro/cli v0.2.0</div><div class="line">github.com/micro/go-micro v1.6.0</div><div class="line">github.com/micro/go-plugins v1.1.0</div><div class="line">github.com/pascaldekloe/goe v0.1.0 // indirect</div><div class="line">github.com/serenize/snaker v0.0.0-20171204205717-a683aaf2d516</div><div class="line">github.com/shirou/gopsutil v2.18.12+incompatible // indirect</div><div class="line">github.com/ugorji/go/codec v0.0.0-20190320090025-2dc34c0b8780 // indirect</div><div class="line">github.com/xlab/treeprint v0.0.0-20181112141820-a009c3971eca</div><div class="line">golang.org/x/net v0.0.0-20190606173856-1492cefac77f</div><div class="line">google.golang.org/grpc v1.21.1</div><div class="line">layeh.com/radius v0.0.0-20190322222518-890bc1058917 // indirect</div><div class="line">)</div><div class="line"></div><div class="line">replace github.com/golang/lint =&gt; golang.org/x/lint v0.0.0-20190409202823-959b441ac422</div><div class="line"></div><div class="line">replace github.com/testcontainers/testcontainer-go =&gt; github.com/testcontainers/testcontainers-go v0.0.0-20181115231424-8e868ca12c0f</div><div class="line"></div><div class="line">replace github.com/hashicorp/consul =&gt; github.com/hashicorp/consul v1.5.1</div></pre></td></tr></table></figure><hr><p>å¥½å•¦ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘ä¸€ä¸‹ï¼Œç»ˆäºå¤§åŠŸå‘Šæˆäº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;ç”±äºæœ¬æœºä¸Šmicroç‰ˆæœ¬è¾ƒä½ï¼Œå…¶å®æœ¬æœºç‰ˆæœ¬æ˜¯0.13.0ï¼Œç„¶åç”¨è¿™ä¸ªç‰ˆæœ¬å‘½ä»¤è¡Œè°ƒç”¨è¿œç¨‹rpcä¸€ç›´æŠ¥ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight json&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;id&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;go.micro.client.codec&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;code&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;500&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;detail&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;json: cannot unmarshal string into Go struct field clientResponse.id of type uint64&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  &lt;span class=&quot;attr&quot;&gt;&quot;status&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;Internal Server Error&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ•…éœ€è¦å‡çº§æœ¬æœºmicroç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å‡çº§ç‰ˆæœ¬&lt;/strong&gt;: 1.5.0&lt;/p&gt;
    
    </summary>
    
      <category term="go-micro" scheme="http://yoursite.com/categories/go-micro/"/>
    
    
      <category term="golang" scheme="http://yoursite.com/tags/golang/"/>
    
      <category term="go-micro" scheme="http://yoursite.com/tags/go-micro/"/>
    
  </entry>
  
  <entry>
    <title>go-moduleåˆè¯•</title>
    <link href="http://yoursite.com/2019/04/30/go-module%E5%88%9D%E8%AF%95/"/>
    <id>http://yoursite.com/2019/04/30/go-moduleåˆè¯•/</id>
    <published>2019-04-30T03:18:00.000Z</published>
    <updated>2019-04-30T03:22:02.731Z</updated>
    
    <content type="html"><![CDATA[<h1 id="go-module"><a href="#go-module" class="headerlink" title="go module"></a>go module</h1><blockquote><p>go module æ˜¯goå®˜æ–¹æä¾›çš„åŒ…ç®¡ç†å·¥å…·ï¼Œç›¸æ¯”glideï¼Œdepè¿™äº›åŒ…ç®¡ç†å·¥å…·ï¼Œgo modè¿˜æ˜¯æ¯”è¾ƒæ–°çš„ï¼Œç›®å‰è¿˜æ²¡æœ‰è¢«å¤§èŒƒå›´ä½¿ç”¨ã€‚æœ¬äººæ¯”è¾ƒå–œæ¬¢å°é²œï¼Œå·²ç»åœ¨é¡¹ç›®ä¸­å°è¯•ä½¿ç”¨äº†ï¼ŒæœŸé—´ä¹Ÿé‡åˆ°ä¸€äº›å‘ï¼Œä¸è¿‡ç›®å‰ä½¿ç”¨ä¸‹æ¥ä¹ŸåŸºæœ¬æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸‹é¢å°±æŠŠä½¿ç”¨è¿‡ç¨‹å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹å§ï¼</p></blockquote><h2 id="è¿è¡Œç›®å½•å¯¹æ¯”"><a href="#è¿è¡Œç›®å½•å¯¹æ¯”" class="headerlink" title="è¿è¡Œç›®å½•å¯¹æ¯”"></a>è¿è¡Œç›®å½•å¯¹æ¯”</h2><ul><li>ä¸ä½¿ç”¨mod<ul><li>åªèƒ½è¿è¡Œåœ¨go pathä¸‹é¢</li></ul></li><li>ä½¿ç”¨mod<ul><li>å¯è¿è¡Œåœ¨ä»»ä½•ç›®å½•ï¼Œä¸ä¾èµ–go path</li><li>å¦‚æœè¦åœ¨go pathä¸‹è¿è¡Œéœ€é…ç½®<code>GO111MODULE=on</code>ç¯å¢ƒå˜é‡</li></ul></li></ul><h2 id="å‡ ä¸ªå…³é”®å‘½ä»¤"><a href="#å‡ ä¸ªå…³é”®å‘½ä»¤" class="headerlink" title="å‡ ä¸ªå…³é”®å‘½ä»¤"></a>å‡ ä¸ªå…³é”®å‘½ä»¤</h2><ul><li>go mod init<ul><li>initialize new module in current directory</li></ul></li><li>go mod tidy<ul><li>add missing and remove unused modules</li></ul></li><li>go mod vendor<ul><li>make vendored copy of dependencies</li></ul></li></ul><p>ç¿»è¯‘ä¸€ä¸‹ï¼š</p><p>go mod init ç”¨æ¥å°†å½“å‰ç›®å½•åˆå§‹åŒ–æˆ go mod ç®¡ç†çš„ç›®å½•<br>go mod tidy ç”¨æ¥æ›´æ–°é¡¹ç›®ä¸­çš„ä¾èµ–<br>go mod vendor ç”¨æ¥å°†é¡¹ç›®ä¸­çš„ä¾èµ–åŒ…å…¨éƒ¨copyåˆ°vendorç›®å½•ä¸‹ï¼Œæ–¹ä¾¿é¡¹ç›®åœ¨å…¶ä»–æ²¡æœ‰ go mod çš„ç¯å¢ƒä¸Šç¼–è¯‘  </p><h2 id="å‡ ä¸ªå‘çš„åœ°æ–¹"><a href="#å‡ ä¸ªå‘çš„åœ°æ–¹" class="headerlink" title="å‡ ä¸ªå‘çš„åœ°æ–¹"></a>å‡ ä¸ªå‘çš„åœ°æ–¹</h2><ul><li>è¿è¡Œ go mod init ä¼šæŠ¥ <code>go: cannot determine module path for source directory</code>ï¼Œéœ€è¦åœ¨main.goä¸­å£°æ˜å¯¼å…¥çš„ä¾èµ–</li><li>æœ¬åœ°åŒ…ä¾èµ–æ–¹å¼ï¼Œåœ¨go.modæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">replace com.test.a =&gt; ../a</div><div class="line"></div><div class="line">å…¶ä¸­ com.test.a ä¸ºé¡¹ç›®ä¸­ä½¿ç”¨çš„åŒ…å</div><div class="line">../a ä¸ºè¯¥åŒ…åœ¨å½“å‰æœºå™¨ä»£ç çš„ç›¸å¯¹è·¯å¾„</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;go-module&quot;&gt;&lt;a href=&quot;#go-module&quot; class=&quot;headerlink&quot; title=&quot;go module&quot;&gt;&lt;/a&gt;go module&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;go module æ˜¯goå®˜æ–¹æä¾›çš„åŒ…ç®¡ç†å·¥å…·ï¼Œç›¸æ¯”gli
      
    
    </summary>
    
      <category term="golang" scheme="http://yoursite.com/categories/golang/"/>
    
    
      <category term="golang" scheme="http://yoursite.com/tags/golang/"/>
    
      <category term="go module" scheme="http://yoursite.com/tags/go-module/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•ä½¿ç”¨golangæ“ä½œmongo</title>
    <link href="http://yoursite.com/2019/01/28/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8golang%E6%93%8D%E4%BD%9Cmongo/"/>
    <id>http://yoursite.com/2019/01/28/å¦‚ä½•ä½¿ç”¨golangæ“ä½œmongo/</id>
    <published>2019-01-28T03:16:00.000Z</published>
    <updated>2019-01-28T03:20:45.867Z</updated>
    
    <content type="html"><![CDATA[<!-- TOC --><ul><li><a href="#mongoä»‹ç»">mongoä»‹ç»</a><ul><li><a href="#ç‰¹æ€§">ç‰¹æ€§</a></li><li><a href="#åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶">åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶</a></li><li><a href="#é—®é¢˜æ€»ç»“">é—®é¢˜æ€»ç»“</a></li></ul></li><li><a href="#official-go-driver">Official Go Driver</a><ul><li><a href="#ä»£ç ç¤ºä¾‹">ä»£ç ç¤ºä¾‹</a></li></ul></li><li><a href="#å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</a></li></ul><!-- /TOC --><a id="more"></a><h2 id="mongoä»‹ç»"><a href="#mongoä»‹ç»" class="headerlink" title="mongoä»‹ç»"></a>mongoä»‹ç»</h2><h3 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h3><ul><li>é«˜æ€§èƒ½</li><li>ä¸°å¯Œçš„æŸ¥è¯¢è¯­è¨€</li><li>é«˜å¯ç”¨</li><li>æ°´å¹³ä¼¸ç¼©</li><li>æ”¯æŒå¤šç§å­˜å‚¨å¼•æ“</li></ul><h3 id="åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶"><a href="#åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶" class="headerlink" title="åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶"></a>åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶</h3><ol><li><p>mongos</p><p> æ•°æ®åº“é›†ç¾¤è¯·æ±‚çš„å…¥å£ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½é€šè¿‡mongosè¿›è¡Œåè°ƒï¼Œä¸éœ€è¦åœ¨åº”ç”¨ç¨‹åºæ·»åŠ ä¸€ä¸ªè·¯ç”±é€‰æ‹©å™¨ï¼Œmongosè‡ªå·±å°±æ˜¯ä¸€ä¸ªè¯·æ±‚åˆ†å‘ä¸­å¿ƒï¼Œå®ƒè´Ÿè´£æŠŠå¯¹åº”çš„æ•°æ®è¯·æ±‚è¯·æ±‚è½¬å‘åˆ°å¯¹åº”çš„shardæœåŠ¡å™¨ä¸Šã€‚åœ¨ç”Ÿäº§ç¯å¢ƒé€šå¸¸æœ‰å¤šmongosä½œä¸ºè¯·æ±‚çš„å…¥å£ï¼Œé˜²æ­¢å…¶ä¸­ä¸€ä¸ªæŒ‚æ‰æ‰€æœ‰çš„mongodbè¯·æ±‚éƒ½æ²¡æœ‰åŠæ³•æ“ä½œã€‚</p></li><li><p>config server</p><p> é…ç½®æœåŠ¡å™¨ï¼Œå­˜å‚¨æ‰€æœ‰æ•°æ®åº“å…ƒä¿¡æ¯ï¼ˆè·¯ç”±ã€åˆ†ç‰‡ï¼‰çš„é…ç½®ã€‚mongosæœ¬èº«æ²¡æœ‰ç‰©ç†å­˜å‚¨åˆ†ç‰‡æœåŠ¡å™¨å’Œæ•°æ®è·¯ç”±ä¿¡æ¯ï¼Œåªæ˜¯ç¼“å­˜åœ¨å†…å­˜é‡Œï¼Œé…ç½®æœåŠ¡å™¨åˆ™å®é™…å­˜å‚¨è¿™äº›æ•°æ®ã€‚mongosç¬¬ä¸€æ¬¡å¯åŠ¨æˆ–è€…å…³æ‰é‡å¯å°±ä¼šä» config server åŠ è½½é…ç½®ä¿¡æ¯ï¼Œä»¥åå¦‚æœé…ç½®æœåŠ¡å™¨ä¿¡æ¯å˜åŒ–ä¼šé€šçŸ¥åˆ°æ‰€æœ‰çš„ mongos æ›´æ–°è‡ªå·±çš„çŠ¶æ€ï¼Œè¿™æ · mongos å°±èƒ½ç»§ç»­å‡†ç¡®è·¯ç”±ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒé€šå¸¸æœ‰å¤šä¸ª config server é…ç½®æœåŠ¡å™¨ï¼Œå› ä¸ºå®ƒå­˜å‚¨äº†åˆ†ç‰‡è·¯ç”±çš„å…ƒæ•°æ®ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ï¼</p></li><li><p>shard</p><p> åˆ†ç‰‡ï¼ˆshardingï¼‰æ˜¯æŒ‡å°†æ•°æ®åº“æ‹†åˆ†ï¼Œå°†å…¶åˆ†æ•£åœ¨ä¸åŒçš„æœºå™¨ä¸Šçš„è¿‡ç¨‹ã€‚å°†æ•°æ®åˆ†æ•£åˆ°ä¸åŒçš„æœºå™¨ä¸Šï¼Œä¸éœ€è¦åŠŸèƒ½å¼ºå¤§çš„æœåŠ¡å™¨å°±å¯ä»¥å­˜å‚¨æ›´å¤šçš„æ•°æ®å’Œå¤„ç†æ›´å¤§çš„è´Ÿè½½ã€‚åŸºæœ¬æ€æƒ³å°±æ˜¯å°†é›†åˆåˆ‡æˆå°å—ï¼Œè¿™äº›å—åˆ†æ•£åˆ°è‹¥å¹²ç‰‡é‡Œï¼Œæ¯ä¸ªç‰‡åªè´Ÿè´£æ€»æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œæœ€åé€šè¿‡ä¸€ä¸ªå‡è¡¡å™¨æ¥å¯¹å„ä¸ªåˆ†ç‰‡è¿›è¡Œå‡è¡¡ï¼ˆæ•°æ®è¿ç§»ï¼‰ã€‚</p></li><li><p>replia set</p><p> shardçš„å¤‡ä»½ï¼Œé˜²æ­¢shardæŒ‚æ‰ä¹‹åæ•°æ®ä¸¢å¤±ã€‚å¤åˆ¶æä¾›äº†æ•°æ®çš„å†—ä½™å¤‡ä»½ï¼Œå¹¶åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šå­˜å‚¨æ•°æ®å‰¯æœ¬ï¼Œæé«˜äº†æ•°æ®çš„å¯ç”¨æ€§ï¼Œ å¹¶å¯ä»¥ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚</p></li></ol><h3 id="é—®é¢˜æ€»ç»“"><a href="#é—®é¢˜æ€»ç»“" class="headerlink" title="é—®é¢˜æ€»ç»“"></a>é—®é¢˜æ€»ç»“</h3><ol><li><p>åœ¨adminåº“ä¸­åˆ›å»ºç”¨æˆ·æŠ¥ <code>Error: couldn&#39;t add user: Use of SCRAM-SHA-256 requires undigested passwords</code></p><p> è§£å†³æ–¹æ³•ï¼š<br> ä½¿ç”¨å¦‚ä¸‹è„šæœ¬åˆ›å»ºç”¨æˆ·</p> <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">db.createUser(</div><div class="line">    &#123;</div><div class="line">        <span class="attr">user</span>: <span class="string">"username"</span>,</div><div class="line">        <span class="attr">pwd</span>: <span class="string">"password"</span>,</div><div class="line">        <span class="attr">roles</span>: [&#123;<span class="attr">role</span>:<span class="string">"root"</span>,<span class="attr">db</span>:<span class="string">"admin"</span>&#125;],</div><div class="line">        <span class="attr">mechanisms</span>: [<span class="string">"SCRAM-SHA-1"</span>]</div><div class="line">    &#125;</div><div class="line">);</div></pre></td></tr></table></figure></li><li><p>å¯åŠ¨mongoæŠ¥é”™ <code>WiredTiger.wt: handle-open: open: No such file or directory</code>  </p><p> è§£å†³æ–¹æ³•ï¼šåˆ é™¤æ‰dbPathç›®å½•, ç„¶åé‡å¯mongo</p></li><li><p>å¦‚æœè·å–è¶…è¿‡101æ¡è®°å½•ï¼Œmongodbä¸ä¼šä¸€æ¬¡æ€§å…¨éƒ¨loadå¹¶è¿”å›ç»™clientï¼Œæ¯æ¬¡åªè¿”å›batchsizeæ¡è®°å½•ï¼Œéå†å®Œä¹‹åå†é€šè¿‡ç½‘ç»œè·å–ã€‚</p></li></ol><h2 id="Official-Go-Driver"><a href="#Official-Go-Driver" class="headerlink" title="Official Go Driver"></a>Official Go Driver</h2><p><a href="https://godoc.org/github.com/mongodb/mongo-go-driver/mongo" target="_blank" rel="external">mongo-go-driver</a></p><h3 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h3><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> main</div><div class="line"></div><div class="line"><span class="keyword">import</span> (</div><div class="line">    <span class="string">"context"</span></div><div class="line">    <span class="string">"fmt"</span></div><div class="line">    <span class="string">"github.com/mongodb/mongo-go-driver/bson"</span></div><div class="line">    <span class="string">"github.com/mongodb/mongo-go-driver/mongo"</span></div><div class="line">    <span class="string">"os"</span></div><div class="line">    <span class="string">"os/signal"</span></div><div class="line">    <span class="string">"time"</span></div><div class="line">)</div><div class="line"></div><div class="line"><span class="keyword">var</span> MongoClient *mongo.Client</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="comment">// ç»ˆç«¯ä¿¡å·é€šé“</span></div><div class="line">    signalChan := <span class="built_in">make</span>(<span class="keyword">chan</span> os.Signal, <span class="number">1</span>)</div><div class="line">    signal.Notify(signalChan, os.Interrupt)</div><div class="line">    <span class="comment">// åˆå§‹åŒ–mongo client</span></div><div class="line">    initMongoClient()</div><div class="line"></div><div class="line">    collection := MongoClient.Database(<span class="string">"test"</span>).Collection(<span class="string">"doublesouth_test"</span>)</div><div class="line"></div><div class="line">    <span class="comment">//testCollectionInsertOne(collection)</span></div><div class="line"></div><div class="line">    testCollectionFind(collection)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> <span class="keyword">range</span> signalChan &#123;</div><div class="line">        fmt.Println(<span class="string">"æ”¶åˆ°ç»ˆç«¯ä¿¡å·ï¼Œå‡†å¤‡æ–­å¼€mongoè¿æ¥..."</span>)</div><div class="line">        <span class="keyword">if</span> err := destroyMongoClient(); err != <span class="literal">nil</span> &#123;</div><div class="line">            fmt.Println(<span class="string">"æ–­å¼€mongoè¿æ¥å¤±è´¥"</span>, err)</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            fmt.Println(<span class="string">"å·²æ–­å¼€mongoè¿æ¥"</span>)</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">break</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">initMongoClient</span><span class="params">()</span></span> &#123;</div><div class="line">    client, err := mongo.NewClient(<span class="string">"mongodb://username:password@localhost:20000"</span>)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        <span class="built_in">panic</span>(err)</div><div class="line">    &#125;</div><div class="line">    ctx, cancel := context.WithTimeout(context.Background(), <span class="number">20</span>*time.Second)</div><div class="line">    <span class="keyword">defer</span> cancel()</div><div class="line">    err = client.Connect(ctx)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        <span class="built_in">panic</span>(err)</div><div class="line">    &#125;</div><div class="line">    MongoClient = client</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">destroyMongoClient</span><span class="params">()</span> <span class="title">error</span></span> &#123;</div><div class="line">    <span class="keyword">return</span> MongoClient.Disconnect(context.Background())</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">testCollectionInsertOne</span><span class="params">(collection *mongo.Collection)</span></span> &#123;</div><div class="line">    res, err := collection.InsertOne(context.Background(),</div><div class="line">        bson.M&#123;</div><div class="line">            <span class="string">"name"</span>:  <span class="string">"å¤§è™¾3"</span>,</div><div class="line">            <span class="string">"age"</span>:   <span class="keyword">int32</span>(<span class="number">18</span>),</div><div class="line">            <span class="string">"sex"</span>:   <span class="string">"å¥³"</span>,</div><div class="line">            <span class="string">"hobby"</span>: []<span class="keyword">string</span>&#123;<span class="string">"ç©æ¸¸æˆ"</span>, <span class="string">"çœ‹ç”µå½±"</span>&#125;,</div><div class="line">        &#125;)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        fmt.Println(err)</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    fmt.Println(<span class="string">"_id:"</span>, res.InsertedID)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">testCollectionFind</span><span class="params">(collection *mongo.Collection)</span></span> &#123;</div><div class="line">    ctx := context.Background()</div><div class="line"></div><div class="line">    fmt.Println(<span class="string">"findall-------------------------------------------"</span>)</div><div class="line"></div><div class="line">    cur, err := collection.Find(ctx, <span class="literal">nil</span>)</div><div class="line">    <span class="keyword">defer</span> cur.Close(ctx)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        fmt.Println(err)</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> cur.Next(ctx) &#123;</div><div class="line">        raw, err := cur.DecodeBytes()</div><div class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">            fmt.Println(err)</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        fmt.Println(raw.String())</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    fmt.Println(<span class="string">"findone-------------------------------------"</span>)</div><div class="line">    </div><div class="line">    result := bson.Raw&#123;&#125;</div><div class="line">    filter := bson.D&#123;&#123;<span class="string">"name"</span>, <span class="string">"å¤§è™¾3"</span>&#125;&#125;</div><div class="line">    err = collection.FindOne(context.Background(), filter).Decode(&amp;result)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        fmt.Println(err)</div><div class="line">    &#125;</div><div class="line">    fmt.Println(result.String())</div><div class="line">    res := <span class="keyword">struct</span> &#123;</div><div class="line">        Name  <span class="keyword">string</span></div><div class="line">        Age   <span class="keyword">int32</span></div><div class="line">        Sex   <span class="keyword">string</span></div><div class="line">        Hobby []<span class="keyword">string</span></div><div class="line">    &#125;&#123;&#125;</div><div class="line">    err = collection.FindOne(context.Background(), filter).Decode(&amp;res)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        fmt.Println(err)</div><div class="line">    &#125;</div><div class="line">    fmt.Println(res)</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://robomongo.org/" target="_blank" rel="external">Mac mongo å¯è§†åŒ–å®¢æˆ·ç«¯ Robo 3T</a><br><a href="https://docs.mongodb.com/manual/introduction/" target="_blank" rel="external">MongoDBå®˜æ–¹æ–‡æ¡£</a><br><a href="https://www.cnblogs.com/web-fusheng/p/6884759.html" target="_blank" rel="external">Mongodb ä¸ MySQLæ€§èƒ½å¯¹æ¯”</a><br><a href="https://blog.csdn.net/uncle_david/article/details/78713551" target="_blank" rel="external">mongodbå‰¯æœ¬é›†åŠ åˆ†ç‰‡é›†ç¾¤å®‰å…¨è®¤è¯ä½¿ç”¨è´¦å·å¯†ç ç™»å½•</a><br><a href="https://www.cnblogs.com/ityouknow/p/7344005.html" target="_blank" rel="external">mongodb 3.4 é›†ç¾¤æ­å»ºï¼šåˆ†ç‰‡+å‰¯æœ¬é›†</a><br><a href="http://www.ywnds.com/?p=5635" target="_blank" rel="external">MongoDBè®¤è¯å’Œæˆæƒè¯¦è§£</a><br><a href="https://www.cnblogs.com/clsn/p/8214345.html#auto_id_37" target="_blank" rel="external">MongoDB åˆ†ç‰‡é›†ç¾¤æŠ€æœ¯</a><br><a href="http://wiki.jikexueyuan.com/project/mongodb/" target="_blank" rel="external">Mongodb æ•™ç¨‹</a><br><a href="https://stackoverflow.com/questions/36898463/what-is-the-difference-between-readpreference-and-readconcern-in-mongodb" target="_blank" rel="external">What is the difference between readPreference and readConcern in MongoDB?</a><br><a href="https://cloud.tencent.com/developer/article/1005431" target="_blank" rel="external">mongodb 3.4ä¸ mongodb 3.2æ€§èƒ½å¯¹æ¯”</a>  </p>]]></content>
    
    <summary type="html">
    
      &lt;!-- TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#mongoä»‹ç»&quot;&gt;mongoä»‹ç»&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ç‰¹æ€§&quot;&gt;ç‰¹æ€§&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶&quot;&gt;åˆ†ç‰‡é›†ç¾¤å››ä¸ªç»„ä»¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#é—®é¢˜æ€»ç»“&quot;&gt;é—®é¢˜æ€»ç»“&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#official-go-driver&quot;&gt;Official Go Driver&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ä»£ç ç¤ºä¾‹&quot;&gt;ä»£ç ç¤ºä¾‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#å‚è€ƒé“¾æ¥&quot;&gt;å‚è€ƒé“¾æ¥&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /TOC --&gt;
    
    </summary>
    
      <category term="mongo" scheme="http://yoursite.com/categories/mongo/"/>
    
    
      <category term="golang" scheme="http://yoursite.com/tags/golang/"/>
    
      <category term="go" scheme="http://yoursite.com/tags/go/"/>
    
      <category term="mongo" scheme="http://yoursite.com/tags/mongo/"/>
    
  </entry>
  
  <entry>
    <title>go-microå­¦ä¹ ç¬”è®°</title>
    <link href="http://yoursite.com/2019/01/06/go-micro%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2019/01/06/go-microå­¦ä¹ ç¬”è®°/</id>
    <published>2019-01-06T08:22:00.000Z</published>
    <updated>2019-07-11T13:39:17.850Z</updated>
    
    <content type="html"><![CDATA[<!-- TOC --><ul><li><a href="#ç‰¹æ€§">ç‰¹æ€§</a></li><li><a href="#micro-toolkit">micro toolkit</a><ul><li><a href="#é—®é¢˜">é—®é¢˜</a></li><li><a href="#ä½¿ç”¨">ä½¿ç”¨</a></li></ul></li><li><a href="#å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨</a><ul><li><a href="#å®‰è£…æœåŠ¡æ³¨å†Œå‘ç°ä¸­å¿ƒ">å®‰è£…æœåŠ¡æ³¨å†Œå‘ç°ä¸­å¿ƒ</a></li><li><a href="#æœåŠ¡ç«¯">æœåŠ¡ç«¯</a></li><li><a href="#å®¢æˆ·ç«¯">å®¢æˆ·ç«¯</a></li></ul></li><li><a href="#è¸©è¿‡çš„å‘">è¸©è¿‡çš„å‘</a></li><li><a href="#å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</a></li></ul><!-- /TOC --><a id="more"></a><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>æœåŠ¡å‘ç°</p><pre><code>è‡ªåŠ¨æœåŠ¡æ³¨å†Œå’Œå‘ç°ã€‚é»˜è®¤ä½¿ç”¨consulä½œä¸ºæœåŠ¡å‘ç°å’Œæ³¨å†Œä¸­å¿ƒï¼Œå¯é€šè¿‡æ’ä»¶åŒ–ä¿®æ”¹ä¸ºå…¶ä»–çš„æ³¨å†Œä¸­å¿ƒï¼Œæ¯”å¦‚etcdï¼Œzookeeperç­‰ã€‚  </code></pre><p>è´Ÿè½½å‡è¡¡</p><pre><code>åŸºäºæœåŠ¡å‘ç°çš„å®¢æˆ·ç«¯è´Ÿè½½å¹³è¡¡ã€‚</code></pre><p>æ¶ˆæ¯ç¼–ç </p><pre><code>åŸºäºå†…å®¹ç±»å‹çš„åŠ¨æ€æ¶ˆæ¯ç¼–ç ã€‚ å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å°†æ ¹æ®å†…å®¹ç±»å‹ä½¿ç”¨å¯¹åº”çš„ç¼–è§£ç å™¨ã€‚</code></pre><p>åŒæ­¥æµ</p><pre><code>åŸºäºRPCçš„è¯·æ±‚/å“åº”ï¼Œæ”¯æŒåŒå‘æµã€‚æä¾›äº†åŒæ­¥é€šè®¯çš„æŠ½è±¡ã€‚å‘æœåŠ¡å‘å‡ºçš„è¯·æ±‚å°†è¢«è‡ªåŠ¨è§£æã€è´Ÿè½½å¹³è¡¡ã€æ‹¨å·å’Œæµå¤„ç†ã€‚ é»˜è®¤å€¼å¯ç”¨tlsæ—¶ï¼Œtransportä¸ºhttp / 1.1æˆ–http2ã€‚</code></pre><p>å¼‚æ­¥æ¶ˆæ¯</p><pre><code>PubSubæ˜¯ä½œä¸ºå¼‚æ­¥é€šä¿¡å’Œäº‹ä»¶é©±åŠ¨æ¶æ„çš„ä¸€ç­‰å…¬æ°‘è€Œæ„å»ºçš„ã€‚äº‹ä»¶é€šçŸ¥æ˜¯å¾®æœåŠ¡å¼€å‘çš„æ ¸å¿ƒæ¨¡å¼ã€‚å¯ç”¨tlsæ—¶ï¼Œé»˜è®¤æ¶ˆæ¯ä¼ é€’æ˜¯ç‚¹å¯¹ç‚¹http1.1æˆ–http2ã€‚</code></pre><p>å¯æ’æ‹”æ¥å£</p><pre><code>Go Microä¸ºæ¯ä¸ªåˆ†å¸ƒå¼ç³»ç»ŸæŠ½è±¡å‡ºGoæ¥å£ã€‚è¿™äº›æ¥å£æ˜¯å¯æ’æ‹”çš„ï¼Œå¹¶ä¸”å…è®¸Go Microä¸ä¾èµ–äºè¿è¡Œæ—¶ã€‚æ‚¨å¯ä»¥æ’å…¥ä»»ä½•åº•å±‚æŠ€æœ¯ã€‚</code></pre><h2 id="micro-toolkit"><a href="#micro-toolkit" class="headerlink" title="micro toolkit"></a>micro toolkit</h2><p>microæ˜¯ä¸€ä¸ªå·¥å…·åŒ…ã€‚æä¾›äº†ä¸€äº›å·¥å…·æ–¹ä¾¿åœ¨go-microå¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line">~ micro -h</div><div class="line">NAME:</div><div class="line">   micro - A cloud-native toolkit</div><div class="line"></div><div class="line">USAGE:</div><div class="line">   micro [global options] command [command options] [arguments...]</div><div class="line"></div><div class="line">VERSION:</div><div class="line">   0.13.0</div><div class="line"></div><div class="line">COMMANDS:</div><div class="line">    apiRun the micro API</div><div class="line">    botRun the micro bot</div><div class="line">    cliStart the interactive cli</div><div class="line">    registryQuery registry</div><div class="line">    callCall a service or function</div><div class="line">    queryDeprecated: Use call instead</div><div class="line">    streamCreate a service or function stream</div><div class="line">    publishPublish a message to a topic</div><div class="line">    healthQuery the health of a service</div><div class="line">    statsQuery the stats of a service</div><div class="line">    listList items in registry</div><div class="line">    registerRegister an item in the registry</div><div class="line">    deregisterDeregister an item in the registry</div><div class="line">    getGet item from registry</div><div class="line">    proxyRun the micro proxy</div><div class="line">    newCreate a new micro service by specifying a directory path relative to your $GOPATH</div><div class="line">    webRun the micro web app</div><div class="line"></div><div class="line">GLOBAL OPTIONS:</div><div class="line">   --client Client for go-micro; rpc [$MICRO_CLIENT]</div><div class="line">   --client_request_timeout Sets the client request timeout. e.g 500ms, 5s, 1m. Default: 5s [$MICRO_CLIENT_REQUEST_TIMEOUT]</div><div class="line">   --client_retries &quot;0&quot;Sets the client retries. Default: 1 [$MICRO_CLIENT_RETRIES]</div><div class="line">   --client_pool_size &quot;0&quot;Sets the client connection pool size. Default: 1 [$MICRO_CLIENT_POOL_SIZE]</div><div class="line">   --client_pool_ttl Sets the client connection pool ttl. e.g 500ms, 5s, 1m. Default: 1m [$MICRO_CLIENT_POOL_TTL]</div><div class="line">   --register_ttl &quot;0&quot;Register TTL in seconds [$MICRO_REGISTER_TTL]</div><div class="line">   --register_interval &quot;0&quot;Register interval in seconds [$MICRO_REGISTER_INTERVAL]</div><div class="line">   --server Server for go-micro; rpc [$MICRO_SERVER]</div><div class="line">   --server_name Name of the server. go.micro.srv.example [$MICRO_SERVER_NAME]</div><div class="line">   --server_version Version of the server. 1.1.0 [$MICRO_SERVER_VERSION]</div><div class="line">   --server_id Id of the server. Auto-generated if not specified [$MICRO_SERVER_ID]</div><div class="line">   --server_address Bind address for the server. 127.0.0.1:8080 [$MICRO_SERVER_ADDRESS]</div><div class="line">   --server_advertise Used instead of the server_address when registering with discovery. 127.0.0.1:8080 [$MICRO_SERVER_ADVERTISE]</div><div class="line">   --server_metadata [--server_metadata option --server_metadata option]A list of key-value pairs defining metadata. version=1.0.0 [$MICRO_SERVER_METADATA]</div><div class="line">   --broker Broker for pub/sub. http, nats, rabbitmq [$MICRO_BROKER]</div><div class="line">   --broker_address Comma-separated list of broker addresses [$MICRO_BROKER_ADDRESS]</div><div class="line">   --registry Registry for discovery. consul, mdns [$MICRO_REGISTRY]</div><div class="line">   --registry_address Comma-separated list of registry addresses [$MICRO_REGISTRY_ADDRESS]</div><div class="line">   --selector &quot;cache&quot;Selector used to pick nodes for querying [$MICRO_SELECTOR]</div><div class="line">   --transport Transport mechanism used; http [$MICRO_TRANSPORT]</div><div class="line">   --transport_address Comma-separated list of transport addresses [$MICRO_TRANSPORT_ADDRESS]</div><div class="line">   --enable_acmeEnables ACME support via Let&apos;s Encrypt. ACME hosts should also be specified. [$MICRO_ENABLE_ACME]</div><div class="line">   --acme_hosts Comma separated list of hostnames to manage ACME certs for [$MICRO_ACME_HOSTS]</div><div class="line">   --enable_tlsEnable TLS support. Expects cert and key file to be specified [$MICRO_ENABLE_TLS]</div><div class="line">   --tls_cert_file Path to the TLS Certificate file [$MICRO_TLS_CERT_FILE]</div><div class="line">   --tls_key_file Path to the TLS Key file [$MICRO_TLS_KEY_FILE]</div><div class="line">   --tls_client_ca_file Path to the TLS CA file to verify clients against [$MICRO_TLS_CLIENT_CA_FILE]</div><div class="line">   --api_address Set the api address e.g 0.0.0.0:8080 [$MICRO_API_ADDRESS]</div><div class="line">   --proxy_address Proxy requests via the HTTP address specified [$MICRO_PROXY_ADDRESS]</div><div class="line">   --web_address Set the web UI address e.g 0.0.0.0:8082 [$MICRO_WEB_ADDRESS]</div><div class="line">   --api_handler Specify the request handler to be used for mapping HTTP requests to services; &#123;api, proxy, rpc&#125; [$MICRO_API_HANDLER]</div><div class="line">   --api_namespace Set the namespace used by the API e.g. com.example.api [$MICRO_API_NAMESPACE]</div><div class="line">   --web_namespace Set the namespace used by the Web proxy e.g. com.example.web [$MICRO_WEB_NAMESPACE]</div><div class="line">   --api_cors Comma separated whitelist of allowed origins for CORS [$MICRO_API_CORS]</div><div class="line">   --web_cors Comma separated whitelist of allowed origins for CORS [$MICRO_WEB_CORS]</div><div class="line">   --proxy_cors Comma separated whitelist of allowed origins for CORS [$MICRO_PROXY_CORS]</div><div class="line">   --enable_statsEnable stats [$MICRO_ENABLE_STATS]</div><div class="line">   --help, -hshow help</div><div class="line">   --versionprint the version</div></pre></td></tr></table></figure><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>ä½¿ç”¨micro toolkitï¼Œ<a href="https://micro.mu/docs/toolkit.html#plugins" target="_blank" rel="external">å®‰è£…å…¶ä»–æ’ä»¶</a>ï¼Œç¬¬ä¸€æ¬¡buildç¼ºå°‘ç›¸å…³åŒ…ï¼Œgo get ä¸‹æ¥ï¼ŒbuildæˆåŠŸä¹‹åè¿è¡Œå‘½ä»¤ï¼ŒæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">panic: /debug/requests is already registered. You may have two independent copies of golang.org/x/net/trace in your binary, trying to maintain separate state. This may involve a vendored copy of golang.org/x/net/trace.</div><div class="line"></div><div class="line">goroutine 1 [running]:</div><div class="line">go.etcd.io/etcd/vendor/golang.org/x/net/trace.init.0()</div><div class="line">    /Users/doublesouth/Documents/mycode/golang/lib/src/go.etcd.io/etcd/vendor/golang.org/x/net/trace/trace.go:116 +0x16c</div></pre></td></tr></table></figure><p>è§£å†³æ–¹æ³•å‚è€ƒè¯¥é“¾æ¥ï¼š<a href="https://github.com/etcd-io/etcd/issues/9357#issuecomment-377560659" target="_blank" rel="external">https://github.com/etcd-io/etcd/issues/9357#issuecomment-377560659</a></p><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><ul><li><p>æ‰‹åŠ¨å–æ¶ˆæ³¨å†Œ</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">micro deregister service <span class="string">'&#123;"name":"&lt;service.name&gt;","version":"&lt;service.version&gt;","nodes":[&#123;"id":"&lt;node.id&gt;"&#125;]&#125;'</span></div></pre></td></tr></table></figure></li></ul><h2 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨"></a>å¦‚ä½•ä½¿ç”¨</h2><h3 id="å®‰è£…æœåŠ¡æ³¨å†Œå‘ç°ä¸­å¿ƒ"><a href="#å®‰è£…æœåŠ¡æ³¨å†Œå‘ç°ä¸­å¿ƒ" class="headerlink" title="å®‰è£…æœåŠ¡æ³¨å†Œå‘ç°ä¸­å¿ƒ"></a>å®‰è£…æœåŠ¡æ³¨å†Œå‘ç°ä¸­å¿ƒ</h3><p>æœ¬åœ°ä½¿ç”¨dockerå®‰è£…consulï¼š</p><ol><li>æœ¬åœ°å®‰è£…docker</li><li>è¿è¡Œ <code>docker pull consul</code> å‘½ä»¤ä»docker hubä¸Šæ‹‰å–æœ€æ–°å®˜æ–¹consulé•œåƒ</li><li>è¿è¡Œ <code>docker run -d --name=local-consul -e CONSUL_BIND_INTERFACE=eth0 -p 8500:8500 consul</code> å‘½ä»¤å¯åŠ¨dockerå®¹å™¨ï¼Œéœ€è¦æš´éœ²8500ç«¯å£ï¼Œå¦åˆ™æœ¬åœ°æœåŠ¡æ— æ³•æ³¨å†Œåˆ°consul</li></ol><h3 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h3><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">type</span> HelloWorld <span class="keyword">struct</span> &#123;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å®ç°hello_world serviceä¸­çš„Helloæ–¹æ³•</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g *HelloWorld)</span> <span class="title">Hello</span><span class="params">(ctx context.Context, req *hello_world.HelloRequest, rsp *hello_world.HelloResponse)</span> <span class="title">error</span></span> &#123;</div><div class="line">    rsp.Greeting = <span class="string">"Hello World: "</span> + req.Name</div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    service := micro.NewService(</div><div class="line">        micro.Name(<span class="string">"hello_world"</span>),</div><div class="line">        micro.Version(<span class="string">"latest"</span>),</div><div class="line">        micro.Metadata(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</div><div class="line">            <span class="string">"type"</span>: <span class="string">"helloworld"</span>,</div><div class="line">        &#125;),</div><div class="line">    )</div><div class="line"></div><div class="line">    service.Init()</div><div class="line"></div><div class="line">    hello_world.RegisterHelloWorldHandler(service.Server(), <span class="built_in">new</span>(HelloWorld))</div><div class="line"></div><div class="line">    <span class="keyword">if</span> err := service.Run(); err != <span class="literal">nil</span> &#123;</div><div class="line">        fmt.Println(err)   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h3><figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</div><div class="line">    service := micro.NewService(</div><div class="line">        micro.Name(<span class="string">"hello_world"</span>),</div><div class="line">        micro.Version(<span class="string">"latest"</span>),</div><div class="line">        micro.Metadata(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</div><div class="line">            <span class="string">"type"</span>: <span class="string">"helloworld"</span>,</div><div class="line">        &#125;),</div><div class="line">    )</div><div class="line"></div><div class="line">    service.Init()</div><div class="line"></div><div class="line">    greeter := hello_world.NewHelloWorldClient(<span class="string">"hello_world"</span>, service.Client())</div><div class="line"></div><div class="line">    rsp, err := greeter.Hello(context.TODO(), &amp;hello_world.HelloRequest&#123;Name: <span class="string">"Alice"</span>&#125;)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        fmt.Println(err)</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    fmt.Println(rsp.Greeting)</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="è¸©è¿‡çš„å‘"><a href="#è¸©è¿‡çš„å‘" class="headerlink" title="è¸©è¿‡çš„å‘"></a>è¸©è¿‡çš„å‘</h2><ol><li><p>go-microæ¡†æ¶å®¢æˆ·ç«¯è¿æ¥æ± å¤§å°é…ç½®ä¸æ˜¯åªå»ºè¿™ä¹ˆå¤šçš„è¿æ¥ï¼Œæºç ä¸­çš„å¤„ç†æœºåˆ¶æ˜¯æ¯æ¬¡å‘èµ·å®¢æˆ·ç«¯è¯·æ±‚é¦–å…ˆæ£€æŸ¥æ± ä¸­æœ‰æ²¡æœ‰è¿æ¥ï¼Œå¦‚æœæ²¡æœ‰è¿æ¥ä¼šç›´æ¥æ–°å»ºä¸€ä¸ªè¿æ¥å‘èµ·è¯·æ±‚ï¼Œè¿æ¥ç”¨å®Œé‡Šæ”¾è¿æ¥çš„æ—¶å€™ä¼šæ£€æŸ¥æ± ä¸­çš„è¿æ¥æ•°æ˜¯è¾¾åˆ°é…ç½®çš„è¿æ¥æ•°ï¼Œå¦‚æœè¾¾åˆ°é…ç½®çš„è¿æ¥æ•°ç›´æ¥å…³é—­è¯¥è¿æ¥ï¼Œå¦‚æœæœªè¾¾åˆ°æ‰å°†è¯¥è¿æ¥æ”¾åˆ°æ± ä¸­ã€‚è¿™å°±ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœè¯·æ±‚é‡è¿‡å¤§ä¼šå¯¼è‡´è¿æ¥ä¸€ç›´åœ¨åˆ›å»ºï¼Œæœ€ç»ˆä¼šæŠ¥ too many open files é”™è¯¯ã€‚</p><p> ä¸‹é¢æ˜¯go-microæ¡†æ¶ä¸­clientç«¯è·å–è¿æ¥å’Œé‡Šæ”¾è¿æ¥çš„æºç ï¼š</p> <figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è·å–è¿æ¥</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *pool)</span> <span class="title">getConn</span><span class="params">(addr <span class="keyword">string</span>, tr transport.Transport, opts ...transport.DialOption)</span> <span class="params">(*poolConn, error)</span></span> &#123;</div><div class="line">    p.Lock()</div><div class="line">    conns := p.conns[addr]</div><div class="line">    now := time.Now().Unix()</div><div class="line"></div><div class="line">    <span class="comment">// while we have conns check age and then return one</span></div><div class="line">    <span class="comment">// otherwise we'll create a new conn</span></div><div class="line">    <span class="comment">// 1. é¦–å…ˆæ£€æŸ¥æ± ä¸­å¯ç”¨è¿æ¥æ•°æ˜¯å¦å¤§äº1</span></div><div class="line">    <span class="keyword">for</span> <span class="built_in">len</span>(conns) &gt; <span class="number">0</span> &#123;</div><div class="line">        conn := conns[<span class="built_in">len</span>(conns)<span class="number">-1</span>]</div><div class="line">        conns = conns[:<span class="built_in">len</span>(conns)<span class="number">-1</span>]</div><div class="line">        p.conns[addr] = conns</div><div class="line"></div><div class="line">        <span class="comment">// if conn is old kill it and move on</span></div><div class="line">        <span class="keyword">if</span> d := now - conn.created; d &gt; p.ttl &#123;</div><div class="line">            conn.Client.Close()</div><div class="line">            <span class="keyword">continue</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// we got a good conn, lets unlock and return it</span></div><div class="line">        p.Unlock()</div><div class="line"></div><div class="line">        <span class="comment">// 2. ç›´æ¥è¿”å›æ± ä¸­è¿æ¥</span></div><div class="line">        <span class="keyword">return</span> conn, <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    p.Unlock()</div><div class="line"></div><div class="line">    <span class="comment">// create new conn</span></div><div class="line">    <span class="comment">// 3. å¦‚æœæ± ä¸­æ²¡æœ‰è¿æ¥äº†ï¼Œè¿™æ—¶æ–°å»ºä¸€ä¸ªè¿æ¥å¹¶è¿”å›</span></div><div class="line">    c, err := tr.Dial(addr, opts...)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, err</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> &amp;poolConn&#123;c, time.Now().Unix()&#125;, <span class="literal">nil</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// é‡Šæ”¾è¿æ¥</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *pool)</span> <span class="title">release</span><span class="params">(addr <span class="keyword">string</span>, conn *poolConn, err error)</span></span> &#123;</div><div class="line">    <span class="comment">// don't store the conn if it has errored</span></div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        conn.Client.Close()</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// otherwise put it back for reuse</span></div><div class="line">    p.Lock()</div><div class="line">    conns := p.conns[addr]</div><div class="line">    <span class="comment">// 1. æ£€æŸ¥æ± ä¸­è¿æ¥æ•°æ˜¯å¦å·²è¾¾åˆ°æœ€å¤§ï¼Œå¦‚æœè¾¾åˆ°æœ€å¤§ç›´æ¥å…³é—­è¿æ¥</span></div><div class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(conns) &gt;= p.size &#123;</div><div class="line">        p.Unlock()</div><div class="line">        conn.Client.Close()</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 2. æœªè¾¾åˆ°æ± ä¸­æœ€å¤§è¿æ¥æ•°å°†è¯¥è¿æ¥æ”¾å…¥æ± ä¸­</span></div><div class="line">    p.conns[addr] = <span class="built_in">append</span>(conns, conn)</div><div class="line">    p.Unlock()</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p><del>å®¢æˆ·ç«¯é…ç½®registerç›´æ¥æ”¾åˆ°mainæ–¹æ³•è·å–æµ‹è¯•ç”¨ä¾‹ä¸­éƒ½å¯ä»¥è°ƒç”¨åˆ°æœåŠ¡ç«¯ï¼Œä½†æ˜¯æœ¬åœ°åŒæ ·å¯ä¸ªæœåŠ¡ç«¯ç„¶ååœ¨æœåŠ¡é‡Œé¢é…ç½®å®¢æˆ·ç«¯registerå‘ç°æœªç”Ÿæ•ˆï¼Œä¸€ç›´ä½¿ç”¨é»˜è®¤çš„consulã€‚</del></p><p> æœ¬åœ°æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p> <figure class="highlight golang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è¿™ç§æ–¹å¼åœ¨æµ‹è¯•ç”¨ä¾‹ä¸­æ˜¯å¯ä»¥è°ƒç”¨æˆåŠŸçš„</span></div><div class="line"><span class="comment">// ä½†æ˜¯å¦‚æœå’Œserverä¸€èµ·å¯åŠ¨ï¼Œå°±ä¼šåˆå§‹åŒ–å¤±è´¥ï¼Œä½¿ç”¨çš„registerå§‹ç»ˆéƒ½æ˜¯é»˜è®¤çš„consul</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestClient</span><span class="params">(t *testing.T)</span></span> &#123;</div><div class="line">    <span class="keyword">var</span> c client.Client</div><div class="line">    r := etcdv3.NewRegistry(registry.Addrs(<span class="string">"127.0.0.1:2379"</span>))</div><div class="line">    c = client.NewClient()</div><div class="line"></div><div class="line">    c.Init(client.Selector(</div><div class="line">        selector.NewSelector(selector.Registry(r))),</div><div class="line">        client.PoolSize(<span class="number">100</span>),                  <span class="comment">//è¿æ¥æ± å¤§å°</span></div><div class="line">        client.PoolTTL(<span class="number">5</span>*time.Minute),         <span class="comment">//é•¿è¿æ¥ç¼“å­˜æ—¶é—´</span></div><div class="line">        client.Retries(<span class="number">3</span>),                     <span class="comment">//é‡è¯•æ¬¡æ•°</span></div><div class="line">        client.RequestTimeout(<span class="number">30</span>*time.Second), <span class="comment">//è¯·æ±‚è¶…æ—¶</span></div><div class="line">        client.DialTimeout(<span class="number">2</span>*time.Second),     <span class="comment">//å®¢æˆ·ç«¯è¿æ¥è¶…æ—¶</span></div><div class="line">        client.Transport(tcp.NewTransport()),</div><div class="line">    )</div><div class="line"></div><div class="line">    Client = service.NewDemoService(<span class="string">"demo.service"</span>, c)</div><div class="line">    rsp, err := Client.Do(context.TODO(), &amp;Request&#123;</div><div class="line">        Say: <span class="string">"hello"</span>,</div><div class="line">    &#125;)</div><div class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</div><div class="line">        t.Errorf(<span class="string">"err %v\n"</span>, err)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li></ol><p><strong>è¿™ç¯‡åšå®¢åªæ˜¯å…³äºgo-microçš„ä¸€ä¸ªç®€å•ä»‹ç»ä»¥åŠå…¥é—¨ä½¿ç”¨ï¼Œç¬”è€…ä¹Ÿåœ¨å­¦ä¹ é˜¶æ®µï¼Œéšç€ç ”ç©¶çš„æ·±å…¥ä¹Ÿä¼šåˆ†äº«æ›´å¤šå…³äºgo-microçš„åªæ˜¯ç»™å¤§å®¶ã€‚</strong></p><h2 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h2><p><a href="https://micro.mu/docs/go-micro.html" target="_blank" rel="external">Micro Documentation[go-micro]</a><br><a href="https://micro.mu/docs/writing-a-go-function.html" target="_blank" rel="external">Micro Documentation[function]</a><br><a href="https://github.com/micro/examples" target="_blank" rel="external">Micro examples repository</a><br><a href="http://hbchen.com/post/2018-03-27-go-micro-%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D/" target="_blank" rel="external">go-micro æ¡†æ¶ä»‹ç»</a><br><a href="https://micro.mu/docs/cn/api.html" target="_blank" rel="external">Micro-Apiæ–‡æ¡£</a></p>]]></content>
    
    <summary type="html">
    
      &lt;!-- TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#ç‰¹æ€§&quot;&gt;ç‰¹æ€§&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#micro-toolkit&quot;&gt;micro toolkit&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#é—®é¢˜&quot;&gt;é—®é¢˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ä½¿ç”¨&quot;&gt;ä½¿ç”¨&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#å¦‚ä½•ä½¿ç”¨&quot;&gt;å¦‚ä½•ä½¿ç”¨&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#å®‰è£…æœåŠ¡æ³¨å†Œå‘ç°ä¸­å¿ƒ&quot;&gt;å®‰è£…æœåŠ¡æ³¨å†Œå‘ç°ä¸­å¿ƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#æœåŠ¡ç«¯&quot;&gt;æœåŠ¡ç«¯&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#å®¢æˆ·ç«¯&quot;&gt;å®¢æˆ·ç«¯&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#è¸©è¿‡çš„å‘&quot;&gt;è¸©è¿‡çš„å‘&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#å‚è€ƒæ–‡æ¡£&quot;&gt;å‚è€ƒæ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /TOC --&gt;
    
    </summary>
    
      <category term="go-micro" scheme="http://yoursite.com/categories/go-micro/"/>
    
    
      <category term="golang" scheme="http://yoursite.com/tags/golang/"/>
    
      <category term="go-micro" scheme="http://yoursite.com/tags/go-micro/"/>
    
  </entry>
  
  <entry>
    <title>glideè¸©å‘è®°</title>
    <link href="http://yoursite.com/2018/12/10/glide%E8%B8%A9%E5%9D%91%E8%AE%B0/"/>
    <id>http://yoursite.com/2018/12/10/glideè¸©å‘è®°/</id>
    <published>2018-12-10T12:18:00.000Z</published>
    <updated>2018-12-12T02:19:50.009Z</updated>
    
    <content type="html"><![CDATA[<!-- TOC --><ul><li><a href="#å‘ä½">å‘ä½</a></li></ul><!-- /TOC --><p>glide æˆ‘å°±ä¸åšè¿‡å¤šä»‹ç»äº†ï¼Œå®ƒæ˜¯golangçš„åŒ…ç®¡ç†å·¥å…·ä¹‹ä¸€ï¼Œç”±äºè¯¥å·¥å…·githubä¸Šé¢ä¸åœ¨ç»´æŠ¤ï¼Œå®˜æ–¹ä¹Ÿæ¨èä½¿ç”¨depï¼Œæ‰€ä»¥ä¹‹å‰ä¹Ÿä½¿ç”¨è¿‡depï¼Œä½†æ˜¯ç”±äº dep ä¸€ç›´æ‹‰å–ä¸äº† golang.org/x ç›¸å…³ä¾èµ–ï¼Œæ— å¥ˆåªèƒ½åˆåˆ‡å› glideã€‚</p><a id="more"></a><h2 id="å‘ä½"><a href="#å‘ä½" class="headerlink" title="å‘ä½"></a>å‘ä½</h2><ol><li><p>æ‹‰å– golang.org/x ç›¸å…³åŒ…åŒæ ·å¤±è´¥ï¼ŒæŠ¥ Cannot detect VCS</p><ul><li><p>è§£å†³æ–¹æ¡ˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// æ›¿æ¢æ‹‰å–é•œåƒ</div><div class="line">glide mirror set https://golang.org/x/mobile https://github.com/golang/mobile --vcs git</div><div class="line">glide mirror set https://golang.org/x/crypto https://github.com/golang/crypto --vcs git</div><div class="line">glide mirror set https://golang.org/x/net https://github.com/golang/net --vcs git</div><div class="line">glide mirror set https://golang.org/x/tools https://github.com/golang/tools --vcs git</div><div class="line">glide mirror set https://golang.org/x/text https://github.com/golang/text --vcs git</div><div class="line">glide mirror set https://golang.org/x/image https://github.com/golang/image --vcs git</div><div class="line">glide mirror set https://golang.org/x/sys https://github.com/golang/sys --vcs git</div></pre></td></tr></table></figure></li></ul></li><li><p>ç§åº“çš„åŒ…æ‹‰å–ä¸äº†</p><ul><li><p>è§£å†³æ–¹æ¡ˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// åŒæ ·æ›¿æ¢æ‹‰å–é•œåƒ</div><div class="line">glide mirror set [æœ¬åœ°ä»£ç ä¸­importçš„åŒ…å,ä¾‹å¦‚ï¼štest/keng] [å¯¹åº”ç§åº“çš„åœ°å€ï¼ˆhttp://host/test/keng] --vcs git</div></pre></td></tr></table></figure></li></ul></li><li><p>æ— æ³•æ‹‰å–å­åŒ…</p><p> å‡è®¾ä½ è¦æ‹‰å–çš„åŒ…åœ¨glide.yamlä¸­é…ç½®å¦‚ä¸‹ï¼š</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- package: golang.org/x/net/context</div></pre></td></tr></table></figure><p> æ­¤æ—¶åŒæ ·ä¼šæŠ¥ Cannot detect VCSï¼Œå› ä¸ºä¸æ”¯æŒæ‹‰å–å­åŒ…</p><ul><li><p>è§£å†³æ–¹æ¡ˆ</p><p>ä¿®æ”¹glide.yamlä¸­çš„é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- package: golang.org/x/net</div><div class="line">  subpackages:</div><div class="line">  - context</div></pre></td></tr></table></figure></li></ul></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;!-- TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#å‘ä½&quot;&gt;å‘ä½&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- /TOC --&gt;
&lt;p&gt;glide æˆ‘å°±ä¸åšè¿‡å¤šä»‹ç»äº†ï¼Œå®ƒæ˜¯golangçš„åŒ…ç®¡ç†å·¥å…·ä¹‹ä¸€ï¼Œç”±äºè¯¥å·¥å…·githubä¸Šé¢ä¸åœ¨ç»´æŠ¤ï¼Œå®˜æ–¹ä¹Ÿæ¨èä½¿ç”¨depï¼Œæ‰€ä»¥ä¹‹å‰ä¹Ÿä½¿ç”¨è¿‡depï¼Œä½†æ˜¯ç”±äº dep ä¸€ç›´æ‹‰å–ä¸äº† golang.org/x ç›¸å…³ä¾èµ–ï¼Œæ— å¥ˆåªèƒ½åˆåˆ‡å› glideã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="golang" scheme="http://yoursite.com/categories/golang/"/>
    
    
      <category term="glide" scheme="http://yoursite.com/tags/glide/"/>
    
      <category term="golang" scheme="http://yoursite.com/tags/golang/"/>
    
  </entry>
  
  <entry>
    <title>goland debug æŠ¥ include nested too deeply é—®é¢˜æ’æŸ¥</title>
    <link href="http://yoursite.com/2018/11/29/goland%E8%B0%83%E8%AF%95(debug)%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/"/>
    <id>http://yoursite.com/2018/11/29/golandè°ƒè¯•(debug)é—®é¢˜æ’æŸ¥/</id>
    <published>2018-11-29T02:21:00.000Z</published>
    <updated>2018-11-29T02:23:58.777Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¯å¢ƒè¯´æ˜"><a href="#ç¯å¢ƒè¯´æ˜" class="headerlink" title="ç¯å¢ƒè¯´æ˜"></a>ç¯å¢ƒè¯´æ˜</h2><p>ç³»ç»Ÿï¼šMacOS10.14.1<br>golandç‰ˆæœ¬ï¼š2018.2.2<br>golangç‰ˆæœ¬ï¼šgo1.11.2 darwin/amd64  </p><a id="more"></a><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>å½“ä½¿ç”¨goland debugè°ƒè¯•ä»£ç æ—¶ï¼Œé¦–å…ˆè¦å¼€å§‹ç¼–è¯‘ï¼Œç¼–è¯‘ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div></pre></td><td class="code"><pre><div class="line">GOROOT=/usr/local/Cellar/go/1.11/libexec #gosetup</div><div class="line">GOPATH=/path/to/golang/lib:/path/to/golang/workspace #gosetup</div><div class="line">/usr/local/Cellar/go/1.11/libexec/bin/go build -o /private/var/folders/xs/lp65n5c92gb76wj4zllw1dmr0000gp/T/___go_build_main_go -gcflags &quot;all=-N -l&quot; /path/to/main.go #gosetup</div><div class="line"># runtime/cgo</div><div class="line">In file included from _cgo_export.c:3:</div><div class="line">In file included from /usr/include/stdlib.h:66:</div><div class="line">In file included from /usr/include/sys/wait.h:110:</div><div class="line">In file included from /usr/include/sys/resource.h:72:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">In file included from /usr/local/include/stdint.h:59:</div><div class="line">/usr/local/include/stdint.h:2:10: error: #include nested too deeply</div><div class="line">/usr/local/include/stdint.h:59:11: error: #include nested too deeply</div><div class="line">/usr/local/include/stdint.h:72:11: error: #include nested too deeply</div><div class="line">/usr/local/include/stdint.h:76:10: error: #include nested too deeply</div><div class="line">/usr/local/include/stdint.h:82:11: error: #include nested too deeply</div><div class="line">In file included from _cgo_export.c:3:</div><div class="line">In file included from /usr/include/stdlib.h:66:</div><div class="line">In file included from /usr/include/sys/wait.h:110:</div><div class="line">/usr/include/sys/resource.h:197:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:198:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:199:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:200:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:201:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:202:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:203:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:204:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:205:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:206:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:211:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:212:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:213:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">/usr/include/sys/resource.h:214:2: error: unknown type name &apos;uint64_t&apos;</div><div class="line">fatal error: too many errors emitted, stopping now [-ferror-limit=]</div><div class="line"></div><div class="line">Compilation finished with exit code 2</div></pre></td></tr></table></figure><p>æ­£å¸¸runå¯åŠ¨ä¸ä¼šæŠ¥è¯¥é”™è¯¯ï¼Œç»è¿‡å¯¹æ¯”å‘ç°æ­£å¸¸runçš„æ—¶å€™æ‰§è¡Œçš„buildå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/local/Cellar/go/1.11/libexec/bin/go build -i -o /private/var/folders/xs/lp65n5c92gb76wj4zllw1dmr0000gp/T/___go_build_main_go /path/to/main.go #gosetup</div></pre></td></tr></table></figure><p>åŒºåˆ«å°±æ˜¯debugæ—¶å€™ä¼šå¤š -gcflags â€œall=-N -lâ€ å‚æ•°ï¼ŒåŠ äº†è¿™ä¸ªå‚æ•°å°±ä¼šæŠ¥é”™ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>ç½‘ä¸Šä¹Ÿæœç´¢äº†å¾ˆå¤šå…³äºåŠ è¿™ä¸ªå‚æ•°æŠ¥é”™çš„åŸå› ï¼Œæ²¡æœ‰å…·ä½“çš„è§£å†³æ–¹æ¡ˆã€‚åæ¥é€šè¿‡æœç´¢é”™è¯¯æ—¥å¿—é‡Œé¢çš„ error: #include nested too deeply è¿™ä¸ªæè¿°ï¼Œç»ˆäºæ‰¾åˆ°<a href="https://github.com/SOHU-Co/kafka-node/issues/881#issuecomment-396197724" target="_blank" rel="external">è§£å†³æ–¹æ¡ˆ</a>ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir /tmp/includes</div><div class="line">brew doctor 2&gt;&amp;1 | grep &quot;/usr/local/include&quot; | awk &apos;&#123;$1=$1;print&#125;&apos; | xargs -I _ mv _ /tmp/includes</div></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯ççŒ«ç¢°åˆ°æ­»è€—å­è§£å†³äº†ï¼ŒæŠŠè¿™ä¸ªé—®é¢˜åˆ†äº«å‡ºæ¥å¸Œæœ›å¯¹é‡åˆ°çš„äººæœ‰å¸®åŠ©ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;ç¯å¢ƒè¯´æ˜&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒè¯´æ˜&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒè¯´æ˜&quot;&gt;&lt;/a&gt;ç¯å¢ƒè¯´æ˜&lt;/h2&gt;&lt;p&gt;ç³»ç»Ÿï¼šMacOS10.14.1&lt;br&gt;golandç‰ˆæœ¬ï¼š2018.2.2&lt;br&gt;golangç‰ˆæœ¬ï¼šgo1.11.2 darwin/amd64  &lt;/p&gt;
    
    </summary>
    
      <category term="golang" scheme="http://yoursite.com/categories/golang/"/>
    
      <category term="goland" scheme="http://yoursite.com/categories/golang/goland/"/>
    
    
      <category term="golang" scheme="http://yoursite.com/tags/golang/"/>
    
      <category term="goland" scheme="http://yoursite.com/tags/goland/"/>
    
      <category term="debug" scheme="http://yoursite.com/tags/debug/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨feignä¸Šä¼ ä¸‹è½½æ–‡ä»¶æ‰©å±•åŒ…å¡«å‘è®°</title>
    <link href="http://yoursite.com/2018/04/04/%E4%BD%BF%E7%94%A8fegin%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%8C%85%E5%A1%AB%E5%9D%91%E8%AE%B0/"/>
    <id>http://yoursite.com/2018/04/04/ä½¿ç”¨feginä¸Šä¼ ä¸‹è½½æ–‡ä»¶æ‰©å±•åŒ…å¡«å‘è®°/</id>
    <published>2018-04-04T14:51:30.000Z</published>
    <updated>2018-04-09T16:11:54.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>å…ˆæŠŠæœ‰å‘çš„ä»£ç è´´ä¸Šï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//...ä¸Šä¸‹æ–‡æˆ‘å°±çœç•¥äº†ï¼ŒæŠŠæœ‰é—®é¢˜çš„ä»£ç æ®µè´´å‡ºæ¥</span></div><div class="line"></div><div class="line">InputStream inputStream = <span class="keyword">null</span>;</div><div class="line">inputStream = fresp.body().asInputStream();</div><div class="line">FileTypeJudger.FileInfo fileInfo = fileTypeJudger.judgeToFileInfo(inputStream);</div><div class="line">mimeType = fileInfo.getMimeType();</div><div class="line"><span class="comment">// å¿…é¡»å°†æ¸¸æ ‡è®¾ç½®åˆ°èµ·å§‹ä½ç½®ï¼Œæ‰èƒ½è¾“å‡ºå®Œæ•´çš„æ–‡ä»¶æµ</span></div><div class="line">inputStream.reset(); <span class="comment">//è¿™é‡Œå°±æ˜¯æœ‰å‘çš„åœ°æ–¹</span></div><div class="line"></div><div class="line"><span class="comment">//...</span></div></pre></td></tr></table></figure></p><a id="more"></a><p>ä»¥ä¸Šä»£ç åœ¨æœ€åä¸€è¡Œä¼šæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java.io.IOException: mark/reset not supported</div></pre></td></tr></table></figure></p><p>ä½†æ˜¯æˆ‘åœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒéƒ½éªŒè¯è¿‡ï¼Œ<code>fresp.body().asInputStream()</code>è¿”å›çš„æ˜¯<code>ByteArrayInputStream</code>ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´æœ€åä¸€è¡Œæ˜¯æ”¯æŒresetæ“ä½œçš„ã€‚</p><h2 id="æ’æŸ¥è®°å½•"><a href="#æ’æŸ¥è®°å½•" class="headerlink" title="æ’æŸ¥è®°å½•"></a>æ’æŸ¥è®°å½•</h2><ol><li><p>æŸ¥çœ‹feignæºç å‘ç°<code>asInputStream()</code>æ–¹æ³•æœ‰ä¸¤ä¸ªå®ç°ï¼Œåˆ†åˆ«æ˜¯<code>ByteArrayBody</code>å’Œ<code>InputStreamBody</code>ï¼Œæºç å¦‚ä¸‹ï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ByteArrayBodyå®ç°</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> InputStream <span class="title">asInputStream</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ByteArrayInputStream(data);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// InputStreamBodyå®ç°</span></div><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> InputStream <span class="title">asInputStream</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">  <span class="keyword">return</span> inputStream;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p> å¯ä»¥çœ‹å‡ºåªæœ‰è°ƒç”¨<code>InputStreamBody</code>å®ç°çš„<code>asInputStream()</code>æ–¹æ³•æ‰ä¼šå‡ºç°ä¸Šé¢çš„å¼‚å¸¸ã€‚</p></li><li><p>ç„¶ååœ¨æœ¬åœ°å‘èµ·è¯·æ±‚ï¼Œå¼€å¯debugæ¨¡å¼ï¼Œä¸€æ­¥ä¸€æ­¥è·Ÿå‘ç°æ²¡æœ‰é—®é¢˜ï¼Œæ¯æ¬¡éƒ½æ˜¯èµ°åˆ°<code>ByteArrayBody</code>ï¼Œè¿™è®©æˆ‘éƒé—·äº†å¾ˆé•¿æ—¶é—´å•Šã€‚</p></li><li><p>ç„¶åå°è¯•è·Ÿè¸ª<code>ByteArrayInputStream</code>å®ä¾‹ä¸­ä¼ é€’çš„<code>data</code>çš„åˆå§‹åŒ–æµç¨‹ã€‚å‘ç°æ˜¯åœ¨<code>ByteArrayBody</code>ç±»çš„æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–çš„ã€‚</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ„é€ å‡½æ•°</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="title">ByteArrayBody</span><span class="params">(<span class="keyword">byte</span>[] data)</span> </span>&#123;</div><div class="line">  <span class="keyword">this</span>.data = data;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p> å†è·Ÿè¸ªæ„é€ å‡½æ•°ï¼Œå‘ç°åœ¨<code>orNull()</code>æ–¹æ³•ä¸­è¢«è°ƒç”¨äº†</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// orNull æ–¹æ³•</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Body <span class="title">orNull</span><span class="params">(<span class="keyword">byte</span>[] data)</span> </span>&#123;</div><div class="line">  <span class="keyword">if</span> (data == <span class="keyword">null</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ByteArrayBody(data);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p> å†è·Ÿè¸ª<code>orNull()</code>æ–¹æ³•ï¼Œå‘ç°åœ¨<code>Response.Builder</code>ç±»ä¸­çš„è¢«è°ƒç”¨ï¼Œè°ƒç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Builder <span class="title">body</span><span class="params">(<span class="keyword">byte</span>[] data)</span> </span>&#123;</div><div class="line">  <span class="keyword">this</span>.body = ByteArrayBody.orNull(data);</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p> å†è·Ÿè¸ª<code>body()</code>æ–¹æ³•ï¼Œå‘ç°æœ‰ä¸¤ä¸ªåœ°æ–¹ä¼šè°ƒç”¨ï¼Œ<code>Logger</code>å’Œ<code>SynchronousMethodHandler</code>ä¸¤ä¸ªç±»ä¸­ä¼šè°ƒç”¨ã€‚</p></li><li><p>ç„¶åå…ˆåœ¨<code>SynchronousMethodHandler</code>çš„æ–¹æ³•ä¸­debugï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object[] argv)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">  RequestTemplate template = buildTemplateFromArgs.create(argv);</div><div class="line">  Retryer retryer = <span class="keyword">this</span>.retryer.clone();</div><div class="line">  <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      <span class="keyword">return</span> executeAndDecode(template);</div><div class="line">    &#125; <span class="keyword">catch</span> (RetryableException e) &#123;</div><div class="line">      retryer.continueOrPropagate(e);</div><div class="line">      <span class="keyword">if</span> (logLevel != Logger.Level.NONE) &#123;</div><div class="line">        logger.logRetry(metadata.configKey(), logLevel);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">continue</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">Object <span class="title">executeAndDecode</span><span class="params">(RequestTemplate template)</span> <span class="keyword">throws</span> Throwable </span>&#123;</div><div class="line">  Request request = targetRequest(template);</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (logLevel != Logger.Level.NONE) &#123;</div><div class="line">    logger.logRequest(metadata.configKey(), logLevel, request);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  Response response;</div><div class="line">  <span class="keyword">long</span> start = System.nanoTime();</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    response = client.execute(request, options);</div><div class="line">    <span class="comment">// ensure the request is set. <span class="doctag">TODO:</span> remove in Feign 10</span></div><div class="line">    response.toBuilder().request(request).build();</div><div class="line">  &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">    <span class="keyword">if</span> (logLevel != Logger.Level.NONE) &#123;</div><div class="line">      logger.logIOException(metadata.configKey(), logLevel, e, elapsedTime(start));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">throw</span> errorExecuting(request, e);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">long</span> elapsedTime = TimeUnit.NANOSECONDS.toMillis(System.nanoTime() - start);</div><div class="line"></div><div class="line">  <span class="keyword">boolean</span> shouldClose = <span class="keyword">true</span>;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">if</span> (logLevel != Logger.Level.NONE) &#123;</div><div class="line">      response =</div><div class="line">          logger.logAndRebufferResponse(metadata.configKey(), logLevel, response, elapsedTime);</div><div class="line">      <span class="comment">// ensure the request is set. <span class="doctag">TODO:</span> remove in Feign 10</span></div><div class="line">      response.toBuilder().request(request).build();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (Response.class == metadata.returnType()) &#123;</div><div class="line">      <span class="keyword">if</span> (response.body() == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> response;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span> (response.body().length() == <span class="keyword">null</span> ||</div><div class="line">              response.body().length() &gt; MAX_RESPONSE_BUFFER_SIZE) &#123;</div><div class="line">        shouldClose = <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">return</span> response;</div><div class="line">      &#125;</div><div class="line">      <span class="comment">// Ensure the response body is disconnected</span></div><div class="line">      <span class="keyword">byte</span>[] bodyData = Util.toByteArray(response.body().asInputStream());</div><div class="line"></div><div class="line">      <span class="comment">// æ­¤å¤„å°±æ˜¯è°ƒç”¨bodyæ–¹æ³•çš„åœ°æ–¹ï¼Œæ–­ç‚¹æ‰“åˆ°è¿™é‡Œï¼Œåœ¨å®é™…debugè¿‡ç¨‹ä¸­å‘ç°å¹¶æ²¡æœ‰èµ°åˆ°è¿™é‡Œ</span></div><div class="line">      <span class="keyword">return</span> response.toBuilder().body(bodyData).build();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (response.status() &gt;= <span class="number">200</span> &amp;&amp; response.status() &lt; <span class="number">300</span>) &#123;</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">void</span>.class == metadata.returnType()) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> decode(response);</div><div class="line">      &#125;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (decode404 &amp;&amp; response.status() == <span class="number">404</span> &amp;&amp; <span class="keyword">void</span>.class != metadata.returnType()) &#123;</div><div class="line">      <span class="keyword">return</span> decode(response);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">throw</span> errorDecoder.decode(metadata.configKey(), response);</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">    <span class="keyword">if</span> (logLevel != Logger.Level.NONE) &#123;</div><div class="line">      logger.logIOException(metadata.configKey(), logLevel, e, elapsedTime);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">throw</span> errorReading(request, response, e);</div><div class="line">  &#125; <span class="keyword">finally</span> &#123;</div><div class="line">    <span class="keyword">if</span> (shouldClose) &#123;</div><div class="line">      ensureClosed(response.body());</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>ç„¶ååœ¨<code>Logger</code>çš„æ–¹æ³•ä¸­debugï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">protected</span> Response <span class="title">logAndRebufferResponse</span><span class="params">(String configKey, Level logLevel, Response response,</span></span></div><div class="line">                                        <span class="keyword">long</span> elapsedTime) <span class="keyword">throws</span> IOException &#123;</div><div class="line">  String reason = response.reason() != <span class="keyword">null</span> &amp;&amp; logLevel.compareTo(Level.NONE) &gt; <span class="number">0</span> ?</div><div class="line">      <span class="string">" "</span> + response.reason() : <span class="string">""</span>;</div><div class="line">  <span class="keyword">int</span> status = response.status();</div><div class="line">  log(configKey, <span class="string">"&lt;--- HTTP/1.1 %s%s (%sms)"</span>, status, reason, elapsedTime);</div><div class="line">  <span class="keyword">if</span> (logLevel.ordinal() &gt;= Level.HEADERS.ordinal()) &#123;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (String field : response.headers().keySet()) &#123;</div><div class="line">      <span class="keyword">for</span> (String value : valuesOrEmpty(response.headers(), field)) &#123;</div><div class="line">        log(configKey, <span class="string">"%s: %s"</span>, field, value);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">int</span> bodyLength = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (response.body() != <span class="keyword">null</span> &amp;&amp; !(status == <span class="number">204</span> || status == <span class="number">205</span>)) &#123;</div><div class="line">      <span class="comment">// HTTP 204 No Content "...response MUST NOT include a message-body"</span></div><div class="line">      <span class="comment">// HTTP 205 Reset Content "...response MUST NOT include an entity"</span></div><div class="line">      <span class="keyword">if</span> (logLevel.ordinal() &gt;= Level.FULL.ordinal()) &#123;</div><div class="line">        log(configKey, <span class="string">""</span>); <span class="comment">// CRLF</span></div><div class="line">      &#125;</div><div class="line">      <span class="keyword">byte</span>[] bodyData = Util.toByteArray(response.body().asInputStream());</div><div class="line">      bodyLength = bodyData.length;</div><div class="line">      <span class="keyword">if</span> (logLevel.ordinal() &gt;= Level.FULL.ordinal() &amp;&amp; bodyLength &gt; <span class="number">0</span>) &#123;</div><div class="line">        log(configKey, <span class="string">"%s"</span>, decodeOrDefault(bodyData, UTF_8, <span class="string">"Binary data"</span>));</div><div class="line">      &#125;</div><div class="line">      log(configKey, <span class="string">"&lt;--- END HTTP (%s-byte body)"</span>, bodyLength);</div><div class="line"></div><div class="line">      <span class="comment">// æ­¤å¤„ä¼šè°ƒç”¨bodyæ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘åœ¨æœ¬åœ°è°ƒè¯•çš„æ—¶å€™ç¡®å®ä¼šèµ°åˆ°æ­¤å¤„</span></div><div class="line">      <span class="keyword">return</span> response.toBuilder().body(bodyData).build();</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      log(configKey, <span class="string">"&lt;--- END HTTP (%s-byte body)"</span>, bodyLength);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> response;</div><div class="line">&#125;</div></pre></td></tr></table></figure></li><li><p>æœ€åå‘ç°ï¼ŒåŸæ¥æˆ‘ä¹‹å‰åœ¨å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä¸€ç›´é…ç½®çš„æ—¥å¿—æ‰“å°çº§åˆ«éƒ½æ˜¯debugï¼Œfeignä¸­çš„æ—¥å¿—åªæœ‰é…ç½®äº†debugçº§åˆ«æ‰ä¼šè¾“å‡ºï¼Œä¸Šé¢çš„ä»£ç å…¶å®å°±æ˜¯å½“åˆ¤æ–­éœ€è¦è¾“å‡ºæ—¥å¿—æ—¶ï¼Œä¼šå…ˆæŠŠè¾“å…¥æµè½¬æˆbyte arrayç¼“å­˜èµ·æ¥ï¼Œå¹¶ä¸”ä¼šå°è£…æˆByteArrayBodyæ–¹ä¾¿åç»­å¤ç”¨è¯¥æµã€‚ç”Ÿäº§ä¸Šé¢é…ç½®çš„æ—¥å¿—çº§åˆ«æ˜¯infoï¼Œæ‰€ä»¥ä¼šå°è£…æˆInputStreamBodyï¼Œä¹Ÿå°±å¯¼è‡´åç»­è·å–çš„è¾“å…¥æµæ˜¯ä¸æ”¯æŒmarkçš„ã€‚</p></li></ol><h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//...ä¸Šä¸‹æ–‡æˆ‘å°±çœç•¥äº†ï¼ŒæŠŠæœ‰é—®é¢˜çš„ä»£ç æ®µè´´å‡ºæ¥</span></div><div class="line"></div><div class="line">InputStream inputStream = <span class="keyword">null</span>;</div><div class="line">inputStream = fresp.body().asInputStream();</div><div class="line">Util.checkNotNull(inputStream, <span class="string">"inputstream from edfs is null"</span>);</div><div class="line"><span class="comment">// æ ¡éªŒæµæ˜¯å¦æ”¯æŒæ ‡è®°</span></div><div class="line"><span class="keyword">if</span> (!inputStream.markSupported()) &#123;</div><div class="line">    inputStream = <span class="keyword">new</span> ByteArrayInputStream(Util.toByteArray(inputStream));</div><div class="line">&#125;</div><div class="line">FileTypeJudger.FileInfo fileInfo = fileTypeJudger.judgeToFileInfo(inputStream);</div><div class="line">mimeType = fileInfo.getMimeType();</div><div class="line"><span class="comment">// å¿…é¡»å°†æ¸¸æ ‡è®¾ç½®åˆ°èµ·å§‹ä½ç½®ï¼Œæ‰èƒ½è¾“å‡ºå®Œæ•´çš„æ–‡ä»¶æµ</span></div><div class="line">inputStream.reset();</div><div class="line"></div><div class="line"><span class="comment">//...</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;é—®é¢˜æè¿°&quot;&gt;&lt;a href=&quot;#é—®é¢˜æè¿°&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æè¿°&quot;&gt;&lt;/a&gt;é—®é¢˜æè¿°&lt;/h2&gt;&lt;p&gt;å…ˆæŠŠæœ‰å‘çš„ä»£ç è´´ä¸Šï¼š&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//...ä¸Šä¸‹æ–‡æˆ‘å°±çœç•¥äº†ï¼ŒæŠŠæœ‰é—®é¢˜çš„ä»£ç æ®µè´´å‡ºæ¥&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;InputStream inputStream = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;inputStream = fresp.body().asInputStream();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;FileTypeJudger.FileInfo fileInfo = fileTypeJudger.judgeToFileInfo(inputStream);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;mimeType = fileInfo.getMimeType();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// å¿…é¡»å°†æ¸¸æ ‡è®¾ç½®åˆ°èµ·å§‹ä½ç½®ï¼Œæ‰èƒ½è¾“å‡ºå®Œæ•´çš„æ–‡ä»¶æµ&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;inputStream.reset(); &lt;span class=&quot;comment&quot;&gt;//è¿™é‡Œå°±æ˜¯æœ‰å‘çš„åœ°æ–¹&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//...&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="feign" scheme="http://yoursite.com/categories/feign/"/>
    
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
      <category term="feign" scheme="http://yoursite.com/tags/feign/"/>
    
  </entry>
  
  <entry>
    <title>å…«å¤§æ’åºç®—æ³•çš„javaå®ç°</title>
    <link href="http://yoursite.com/2017/02/17/8-sort-arithmetic-of-java/"/>
    <id>http://yoursite.com/2017/02/17/8-sort-arithmetic-of-java/</id>
    <published>2017-02-17T14:25:52.000Z</published>
    <updated>2017-03-04T14:32:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯å½“æåˆ°ç®—æ³•ï¼Œè‡ªç„¶å°‘ä¸äº†å„ç§æ’åºç®—æ³•ï¼Œä¾‹å¦‚å†’æ³¡æ’åºï¼Œå¿«é€Ÿæ’åºç­‰ç­‰ã€‚è¿™ç¯‡æ–‡ç« å°†ä¼šä»‹ç»ç”¨javaæ¥å®ç°å„ç§æ’åºç®—æ³•ï¼Œä¸€æ¥æ˜¯è‡ªå·±å†å·©å›ºä¸€ä¸‹è¿™ä¸€å—çŸ¥è¯†çš„ï¼ŒäºŒæ¥æ˜¯å°†è¿™å—çŸ¥è¯†åˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›å¤§å®¶å’Œæˆ‘ä¸€èµ·è¿›æ­¥ã€‚<br><a id="more"></a></p><h2 id="æ’å…¥æ’åº"><a href="#æ’å…¥æ’åº" class="headerlink" title="æ’å…¥æ’åº"></a>æ’å…¥æ’åº</h2><blockquote><p>åŸºæœ¬æ€æƒ³ï¼š<br>å‡è®¾æœ‰ä¸€ç»„ä¸ªæ•°ä¸ºnçš„æ•°ï¼Œä»ç¬¬äºŒæ•°å¼€å§‹ï¼ŒæŒ‰ç…§æ¯”è¾ƒè§„åˆ™æ’å…¥åˆ°ä¹‹å‰çš„æ•°ä¸­ï¼Œè¿™æ ·å‰é¢ä¸¤ä¸ªæ•°å°±å·²ç»æ˜¯æ’å¥½åºçš„ï¼Œç„¶ååœ¨ä»ç¬¬ä¸‰ä¸ªæ•°å¼€å§‹æŒ‰ç…§åŒæ ·çš„è§„åˆ™æ’å…¥åˆ°ä¹‹å‰çš„æ•°ä¸­ï¼Œä¾æ¬¡ç±»æ¨ç›´åˆ°æ“ä½œåˆ°ç¬¬nä¸ªæ•°ã€‚</p></blockquote><p>ä¸‹é¢æ˜¯å…·ä½“å®ç°æºç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">insertionSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> j;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; arr.length; i++) &#123;</div><div class="line">        <span class="keyword">int</span> tmp = arr[i];</div><div class="line">        <span class="keyword">for</span>(j = i; j &gt; <span class="number">0</span>; j--) &#123;</div><div class="line">            <span class="keyword">if</span> ( tmp &lt; arr[j - <span class="number">1</span>]) &#123;</div><div class="line">                arr[j] = arr[j - <span class="number">1</span>];</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        arr[j] = tmp;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h2 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h2><blockquote><p>åŸºæœ¬æ€æƒ³ï¼š<br>ç®—æ³•å…ˆå°†è¦æ’åºçš„ä¸€ç»„æ•°æŒ‰æŸä¸ªå¢é‡dï¼ˆn/2,nä¸ºè¦æ’åºæ•°çš„ä¸ªæ•°ï¼‰åˆ†æˆè‹¥å¹²ç»„ï¼Œæ¯ç»„ä¸­è®°å½•çš„ä¸‹æ ‡ç›¸å·®d.å¯¹æ¯ç»„ä¸­å…¨éƒ¨å…ƒç´ è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œç„¶åå†ç”¨ä¸€ä¸ªè¾ƒå°çš„å¢é‡ï¼ˆd/2ï¼‰å¯¹å®ƒè¿›è¡Œåˆ†ç»„ï¼Œåœ¨æ¯ç»„ä¸­å†è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚å½“å¢é‡å‡åˆ°1æ—¶ï¼Œè¿›è¡Œç›´æ¥æ’å…¥æ’åºåï¼Œæ’åºå®Œæˆã€‚</p></blockquote><p>ä¸‹é¢æ˜¯å…·ä½“å®ç°æºç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">shellSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> d1 = arr.length;</div><div class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</div><div class="line">        d1 = (<span class="keyword">int</span>) Math.ceil(d1 / <span class="number">2</span>);</div><div class="line">        <span class="keyword">int</span> d = d1;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; d; x++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = x + d;i &lt; arr.length;i += d)&#123;</div><div class="line">                <span class="keyword">int</span> j = i - d;</div><div class="line">                <span class="keyword">int</span> temp = arr[i];</div><div class="line">                <span class="keyword">for</span> (; j &gt;= <span class="number">0</span> &amp;&amp; temp &lt; arr[j]; j -= d) &#123;</div><div class="line">                    arr[j+d] =arr[j];</div><div class="line">                &#125;</div><div class="line">                arr[j+d] = temp;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (d == <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h2 id="ç®€å•é€‰æ‹©æ’åº"><a href="#ç®€å•é€‰æ‹©æ’åº" class="headerlink" title="ç®€å•é€‰æ‹©æ’åº"></a>ç®€å•é€‰æ‹©æ’åº</h2><blockquote><p>åŸºæœ¬æ€æƒ³ï¼š<br>åœ¨è¦æ’åºçš„ä¸€ç»„æ•°ä¸­ï¼Œé€‰å‡ºæœ€å°çš„ä¸€ä¸ªæ•°ä¸ç¬¬ä¸€ä¸ªä½ç½®çš„æ•°äº¤æ¢ç„¶ååœ¨å‰©ä¸‹çš„æ•°å½“ä¸­å†æ‰¾æœ€å°çš„ä¸ç¬¬äºŒä¸ªä½ç½®çš„æ•°äº¤æ¢ï¼Œå¦‚æ­¤å¾ªç¯åˆ°å€’æ•°ç¬¬äºŒä¸ªæ•°å’Œæœ€åä¸€ä¸ªæ•°æ¯”è¾ƒä¸ºæ­¢ã€‚</p></blockquote><p>ä¸‹é¢æ˜¯å…·ä½“å®ç°æºç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">selectSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; arr.length; j++) &#123;</div><div class="line">            <span class="keyword">if</span> (arr[j] &lt; arr[i]) &#123;</div><div class="line">                <span class="keyword">int</span> tmp = arr[i];</div><div class="line">                arr[i] = arr[j];</div><div class="line">                arr[j] = tmp;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h2 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h2><blockquote><p>åŸºæœ¬æ€æƒ³ï¼š<br>å †æ’åºæ˜¯ä¸€ç§æ ‘å½¢é€‰æ‹©æ’åºï¼Œæ˜¯å¯¹ç›´æ¥é€‰æ‹©æ’åºçš„æœ‰æ•ˆæ”¹è¿›ã€‚<br>å †çš„å®šä¹‰å¦‚ä¸‹ï¼š<br>å…·æœ‰nä¸ªå…ƒç´ çš„åºåˆ—ï¼ˆh1,h2,â€¦,hn),å½“ä¸”ä»…å½“æ»¡è¶³ï¼ˆhi&gt;=h2i,hi&gt;=2i+1ï¼‰æˆ–ï¼ˆhi&lt;=h2i,hi&lt;=2i+1ï¼‰ (i=1,2,â€¦,n/2)æ—¶ç§°ä¹‹ä¸ºå †ã€‚<br>åœ¨è¿™é‡Œåªè®¨è®ºæ»¡è¶³å‰è€…æ¡ä»¶çš„å †ã€‚ç”±å †çš„å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œå †é¡¶å…ƒç´ ï¼ˆå³ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰å¿…ä¸ºæœ€å¤§é¡¹ï¼ˆå¤§é¡¶å †ï¼‰ã€‚å®Œå…¨äºŒå‰æ ‘å¯ä»¥å¾ˆç›´è§‚åœ°è¡¨ç¤ºå †çš„ç»“æ„ã€‚å †é¡¶ä¸ºæ ¹ï¼Œå…¶å®ƒä¸ºå·¦å­æ ‘ã€å³å­æ ‘ã€‚åˆå§‹æ—¶æŠŠè¦æ’åºçš„æ•°çš„åºåˆ—çœ‹ä½œæ˜¯ä¸€æ£µé¡ºåºå­˜å‚¨çš„äºŒå‰æ ‘ï¼Œè°ƒæ•´å®ƒä»¬çš„å­˜å‚¨åºï¼Œä½¿ä¹‹æˆä¸ºä¸€ä¸ªå †ï¼Œè¿™æ—¶å †çš„æ ¹èŠ‚ç‚¹çš„æ•°æœ€å¤§ã€‚ç„¶åå°†æ ¹èŠ‚ç‚¹ä¸å †çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹äº¤æ¢ã€‚ç„¶åå¯¹å‰é¢(n-1)ä¸ªæ•°é‡æ–°è°ƒæ•´ä½¿ä¹‹æˆä¸ºå †ã€‚ä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°åªæœ‰ä¸¤ä¸ªèŠ‚ç‚¹çš„å †ï¼Œå¹¶å¯¹å®ƒä»¬ä½œäº¤æ¢ï¼Œæœ€åå¾—åˆ°æœ‰nä¸ªèŠ‚ç‚¹çš„æœ‰åºåºåˆ—ã€‚ä»ç®—æ³•æè¿°æ¥çœ‹ï¼Œå †æ’åºéœ€è¦ä¸¤ä¸ªè¿‡ç¨‹ï¼Œä¸€æ˜¯å»ºç«‹å †ï¼ŒäºŒæ˜¯å †é¡¶ä¸å †çš„æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ã€‚æ‰€ä»¥å †æ’åºæœ‰ä¸¤ä¸ªå‡½æ•°ç»„æˆã€‚ä¸€æ˜¯å»ºå †çš„æ¸—é€å‡½æ•°ï¼ŒäºŒæ˜¯åå¤è°ƒç”¨æ¸—é€å‡½æ•°å®ç°æ’åºçš„å‡½æ•°ã€‚</p></blockquote><p>ä¸‹é¢æ˜¯å…·ä½“å®ç°æºç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HeapSort</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">heapSort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> arrayLength = a.length;</div><div class="line">        <span class="comment">//å¾ªç¯å»ºå †  </span></div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arrayLength - <span class="number">1</span>; i++)&#123;</div><div class="line">            <span class="comment">//å»ºå †  </span></div><div class="line">            buildMaxHeap(a, arrayLength - <span class="number">1</span> - i);</div><div class="line">            <span class="comment">//äº¤æ¢å †é¡¶å’Œæœ€åä¸€ä¸ªå…ƒç´ </span></div><div class="line">            swap(a, <span class="number">0</span>, arrayLength - <span class="number">1</span> - i);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//äº¤æ¢ä½ç½®</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] data, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> tmp = data[i];</div><div class="line">        data[i] = data[j];</div><div class="line">        data[j] = tmp;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//å»ºå †</span></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">buildMaxHeap</span><span class="params">(<span class="keyword">int</span>[] data, <span class="keyword">int</span> lastIndex)</span> </span>&#123;</div><div class="line">        <span class="comment">//ä»lastIndexå¤„èŠ‚ç‚¹ï¼ˆæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼‰çš„çˆ¶èŠ‚ç‚¹å¼€å§‹</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = (lastIndex - <span class="number">1</span>) / <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="comment">//kä¿å­˜æ­£åœ¨åˆ¤æ–­çš„èŠ‚ç‚¹</span></div><div class="line">            <span class="keyword">int</span> k = i;</div><div class="line">            <span class="comment">//å¦‚æœå½“å‰kèŠ‚ç‚¹çš„å­èŠ‚ç‚¹å­˜åœ¨  </span></div><div class="line">            <span class="keyword">while</span> (k * <span class="number">2</span> + <span class="number">1</span> &lt;= lastIndex) &#123;</div><div class="line">                <span class="comment">//kèŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹çš„ç´¢å¼•  </span></div><div class="line">                <span class="keyword">int</span> biggerIndex = <span class="number">2</span> * k + <span class="number">1</span>;</div><div class="line">                <span class="comment">//å¦‚æœbiggerIndexå°äºlastIndexï¼Œå³biggerIndex+1ä»£è¡¨çš„kèŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹å­˜åœ¨  </span></div><div class="line">                <span class="keyword">if</span> (biggerIndex &lt; lastIndex) &#123;</div><div class="line">                    <span class="comment">//è‹¥æœå³å­èŠ‚ç‚¹çš„å€¼è¾ƒå¤§  </span></div><div class="line">                    <span class="keyword">if</span> (data[biggerIndex] &lt; data[biggerIndex + <span class="number">1</span>]) &#123;</div><div class="line">                        <span class="comment">//biggerIndexæ€»æ˜¯è®°å½•è¾ƒå¤§å­èŠ‚ç‚¹çš„ç´¢å¼•  </span></div><div class="line">                        biggerIndex++;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                <span class="comment">//å¦‚æœkèŠ‚ç‚¹çš„å€¼å°äºå…¶è¾ƒå¤§çš„å­èŠ‚ç‚¹çš„å€¼  </span></div><div class="line">                <span class="keyword">if</span> (data[k] &lt; data[biggerIndex]) &#123;</div><div class="line">                    <span class="comment">//äº¤æ¢ä»–ä»¬  </span></div><div class="line">                    swap(data, k, biggerIndex);</div><div class="line">                    <span class="comment">//å°†biggerIndexèµ‹äºˆkï¼Œå¼€å§‹whileå¾ªç¯çš„ä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œé‡æ–°ä¿è¯kèŠ‚ç‚¹çš„å€¼å¤§äºå…¶å·¦å³å­èŠ‚ç‚¹çš„å€¼  </span></div><div class="line">                    k = biggerIndex;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h2 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h2><blockquote><p>åŸºæœ¬æ€æƒ³ï¼š<br>å‡è®¾æœ‰ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„ï¼Œä»ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œæ¯ä¸¤ä¸ªç›¸é‚»çš„ä½ç½®çš„æ•°å€¼è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå‰é¢ä¸€ä¸ªä½ç½®çš„æ•°å€¼æ¯”åé¢ä¸€ä¸ªä½ç½®çš„æ•°å€¼å¤§ï¼Œå°±äº¤æ¢è¿™ä¸¤ä¸ªä½ç½®çš„æ•°å€¼ï¼Œå½“æœ€åä¸€å¯¹æ•°æ¯”è¾ƒå®Œæ¯•ä¹‹åï¼Œæœ€åä¸€ä¸ªä½ç½®çš„æ•°å€¼å°±æ˜¯æœ€å¤§å€¼ã€‚ç„¶åæˆ‘ä»¬å†ä»¥ç›¸åŒçš„æ­¥éª¤æ“ä½œæ•°ç»„ä¸­é™¤äº†æœ€åä¸€ä¸ªä½ç½®çš„æ‰€æœ‰å€¼ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å€¼éœ€è¦æ¯”è¾ƒã€‚</p></blockquote><p>ä¸‹é¢æ˜¯å…·ä½“å®ç°æºç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; arr.length - <span class="number">1</span>; j++) &#123;</div><div class="line">            <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</div><div class="line">                <span class="keyword">int</span> tmp = arr[j];</div><div class="line">                arr[j] = arr[j + <span class="number">1</span>];</div><div class="line">                arr[j + <span class="number">1</span>] = tmp;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h2 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h2><blockquote><p>åŸºæœ¬æ€æƒ³ï¼š<br>å‡è®¾æœ‰ä¸€ä¸ªé•¿åº¦ä¸ºnçš„é›†åˆï¼Œå°†ä¸­é—´çš„å…ƒç´ ä½œä¸ºä¸­è½´ï¼ŒæŠŠé›†åˆä¸­çš„æ‰€æœ‰å°äºè¯¥ä¸­è½´çš„å…ƒç´ æ”¾åœ¨ä¸­è½´å·¦è¾¹ï¼ŒæŠŠé›†åˆä¸­çš„æ‰€æœ‰å¤§äºè¯¥ä¸­è½´çš„å…ƒç´ æ”¾åœ¨å³è¾¹ï¼Œç„¶ååœ¨ä»¥ç›¸åŒçš„é€»è¾‘åˆ†åˆ«å¤„ç†ä¸­è½´å·¦è¾¹å’Œå³è¾¹çš„é›†åˆï¼Œä¾æ¬¡é€’å½’ï¼Œç›´åˆ°ä¸­è½´å·¦è¾¹å’Œå³è¾¹çš„å…ƒç´ ä¸ªæ•°éƒ½ä¸º1ã€‚</p></blockquote><p>ä¸‹é¢æ˜¯å…·ä½“å®ç°ä»£ç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">fastSort</span><span class="params">(List&lt;Integer&gt; items)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (items.size() &gt; <span class="number">1</span>) &#123;</div><div class="line">        List&lt;Integer&gt; smaller = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        List&lt;Integer&gt; same = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        List&lt;Integer&gt; larger = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line"></div><div class="line">        Integer chosenItem = items.get(items.size() / <span class="number">2</span>);</div><div class="line">        <span class="keyword">for</span> (Integer item : items) &#123;</div><div class="line">            <span class="keyword">if</span> (item &lt; chosenItem) &#123;</div><div class="line">                smaller.add(item);</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (item &gt; chosenItem) &#123;</div><div class="line">                larger.add(item);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                same.add(item);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        fastSort(smaller);</div><div class="line">        fastSort(larger);</div><div class="line"></div><div class="line">        items.clear();</div><div class="line">        items.addAll(smaller);</div><div class="line">        items.addAll(same);</div><div class="line">        items.addAll(larger);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h2 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h2><blockquote><p>åŸºæœ¬æ€æƒ³ï¼š<br>å½’å¹¶ï¼ˆMergeï¼‰æ’åºæ³•æ˜¯å°†ä¸¤ä¸ªï¼ˆæˆ–ä¸¤ä¸ªä»¥ä¸Šï¼‰æœ‰åºè¡¨åˆå¹¶æˆä¸€ä¸ªæ–°çš„æœ‰åºè¡¨ï¼Œå³æŠŠå¾…æ’åºåºåˆ—åˆ†ä¸ºè‹¥å¹²ä¸ªå­åºåˆ—ï¼Œæ¯ä¸ªå­åºåˆ—æ˜¯æœ‰åºçš„ã€‚ç„¶åå†æŠŠæœ‰åºå­åºåˆ—åˆå¹¶ä¸ºæ•´ä½“æœ‰åºåºåˆ—ã€‚</p></blockquote><p>ä¸‹é¢æ˜¯å…·ä½“å®ç°ä»£ç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MergeSort</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span> data[], <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (start &lt; end) &#123;</div><div class="line">            <span class="keyword">int</span> mid = (start + end) / <span class="number">2</span>;</div><div class="line">            sort(data, start, mid);</div><div class="line">            sort(data, mid + <span class="number">1</span>, end);</div><div class="line">            merge(data, start, mid, end);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> data[], <span class="keyword">int</span> start, <span class="keyword">int</span> mid, <span class="keyword">int</span> end)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> temp[] = <span class="keyword">new</span> <span class="keyword">int</span>[end - start + <span class="number">1</span>];</div><div class="line">        <span class="keyword">int</span> i = start;</div><div class="line">        <span class="keyword">int</span> j = mid + <span class="number">1</span>;</div><div class="line">        <span class="keyword">int</span> k = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= end) &#123;</div><div class="line">            <span class="keyword">if</span> (data[i] &lt; data[j]) &#123;</div><div class="line">                temp[k++] = data[i++];</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                temp[k++] = data[j++];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">while</span> (i &lt;= mid) &#123;</div><div class="line">            temp[k++] = data[i++];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (j &lt;= end) &#123;</div><div class="line">            temp[k++] = data[j++];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (k = <span class="number">0</span>, i = start; k &lt; temp.length; k++, i++) &#123;</div><div class="line">            data[i] = temp[k];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h2 id="åŸºæ•°æ’åº"><a href="#åŸºæ•°æ’åº" class="headerlink" title="åŸºæ•°æ’åº"></a>åŸºæ•°æ’åº</h2><blockquote><p>åŸºæœ¬æ€æƒ³ï¼š<br>å°†æ‰€æœ‰å¾…æ¯”è¾ƒæ•°å€¼ï¼ˆæ­£æ•´æ•°ï¼‰ç»Ÿä¸€ä¸ºåŒæ ·çš„æ•°ä½é•¿åº¦ï¼Œæ•°ä½è¾ƒçŸ­çš„æ•°å‰é¢è¡¥é›¶ã€‚ç„¶åï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œä¾æ¬¡è¿›è¡Œä¸€æ¬¡æ’åºã€‚è¿™æ ·ä»æœ€ä½ä½æ’åºä¸€ç›´åˆ°æœ€é«˜ä½æ’åºå®Œæˆä»¥å,æ•°åˆ—å°±å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ã€‚</p></blockquote><p>ä¸‹é¢æ˜¯å…·ä½“å®ç°ä»£ç ï¼š<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">radixSort</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] array)</span> </span>&#123;</div><div class="line">        <span class="comment">//é¦–å…ˆç¡®å®šæ’åºçš„è¶Ÿæ•°;</span></div><div class="line">        <span class="keyword">int</span> max = array[<span class="number">0</span>];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; array.length; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (array[i] &gt; max) &#123;</div><div class="line">                max = array[i];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> time = <span class="number">0</span>;</div><div class="line">        <span class="comment">//åˆ¤æ–­ä½æ•°;</span></div><div class="line">        <span class="keyword">while</span> (max &gt; <span class="number">0</span>) &#123;</div><div class="line">            max /= <span class="number">10</span>;</div><div class="line">            time++;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//å»ºç«‹10ä¸ªé˜Ÿåˆ—;</span></div><div class="line">        List&lt;ArrayList&gt; queue = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">            ArrayList&lt;Integer&gt; queue1 = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">            queue.add(queue1);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//è¿›è¡Œtimeæ¬¡åˆ†é…å’Œæ”¶é›†;</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; time; i++) &#123;</div><div class="line">            <span class="comment">//åˆ†é…æ•°ç»„å…ƒç´ ;</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; array.length; j++) &#123;</div><div class="line">                <span class="comment">//å¾—åˆ°æ•°å­—çš„ç¬¬time+1ä½æ•°;</span></div><div class="line">                <span class="keyword">int</span> x = array[j] % (<span class="keyword">int</span>) Math.pow(<span class="number">10</span>, i + <span class="number">1</span>) / (<span class="keyword">int</span>) Math.pow(<span class="number">10</span>, i);</div><div class="line">                ArrayList&lt;Integer&gt; queue2 = queue.get(x);</div><div class="line">                queue2.add(array[j]);</div><div class="line">                queue.set(x, queue2);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> count = <span class="number">0</span>;<span class="comment">//å…ƒç´ è®¡æ•°å™¨;</span></div><div class="line">            <span class="comment">//æ”¶é›†é˜Ÿåˆ—å…ƒç´ ;</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">10</span>; k++) &#123;</div><div class="line">                <span class="keyword">while</span> (queue.get(k).size() &gt; <span class="number">0</span>) &#123;</div><div class="line">                    ArrayList&lt;Integer&gt; queue3 = queue.get(k);</div><div class="line">                    array[count] = queue3.get(<span class="number">0</span>);</div><div class="line">                    queue3.remove(<span class="number">0</span>);</div><div class="line">                    count++;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¯å½“æåˆ°ç®—æ³•ï¼Œè‡ªç„¶å°‘ä¸äº†å„ç§æ’åºç®—æ³•ï¼Œä¾‹å¦‚å†’æ³¡æ’åºï¼Œå¿«é€Ÿæ’åºç­‰ç­‰ã€‚è¿™ç¯‡æ–‡ç« å°†ä¼šä»‹ç»ç”¨javaæ¥å®ç°å„ç§æ’åºç®—æ³•ï¼Œä¸€æ¥æ˜¯è‡ªå·±å†å·©å›ºä¸€ä¸‹è¿™ä¸€å—çŸ¥è¯†çš„ï¼ŒäºŒæ¥æ˜¯å°†è¿™å—çŸ¥è¯†åˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›å¤§å®¶å’Œæˆ‘ä¸€èµ·è¿›æ­¥ã€‚&lt;br&gt;
    
    </summary>
    
      <category term="ç®—æ³•" scheme="http://yoursite.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="java" scheme="http://yoursite.com/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢ä»ä½¿ç”¨Hexoæ­å»ºåšå®¢å¼€å§‹</title>
    <link href="http://yoursite.com/2017/02/04/my-first-blog-start-with-build-blog-using-hexo/"/>
    <id>http://yoursite.com/2017/02/04/my-first-blog-start-with-build-blog-using-hexo/</id>
    <published>2017-02-04T15:17:52.000Z</published>
    <updated>2017-02-05T09:15:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>Hexoæ˜¯ä¸€æ¬¾å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ï¼Œç”¨å®ƒæ¥æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»æˆ‘æ˜¯å¦‚ä½•ä½¿ç”¨è¯¥æ¡†æ¶æ¥æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢ã€‚</p><a id="more"></a><h2 id="Hexoå®‰è£…åŠç›¸å…³é…ç½®"><a href="#Hexoå®‰è£…åŠç›¸å…³é…ç½®" class="headerlink" title="Hexoå®‰è£…åŠç›¸å…³é…ç½®"></a>Hexoå®‰è£…åŠç›¸å…³é…ç½®</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p><code>Hexo</code>å®‰è£…å¾ˆç®€å•ï¼Œ<code>mac</code>å’Œ<code>windows</code>éƒ½æœ‰è¯¦ç»†çš„å®‰è£…æ•™ç¨‹ï¼Œè¿™é‡Œæä¾›ä¸€ä¸ª<a href="https://hexo.io/zh-cn/docs/index.html" target="_blank" rel="external">hexoå®˜æ–¹è¯¦ç»†çš„å®‰è£…æ•™ç¨‹é“¾æ¥</a>ã€‚</p><p>æ‰“å¼€æœ¬åœ°ç»ˆç«¯ï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåˆå§‹åŒ–å·¥ä½œç›®å½•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ hexo init &lt;folder-path&gt;</div><div class="line">$ cd &lt;folder-path&gt;</div><div class="line">$ npm install</div></pre></td></tr></table></figure></p><p>æ‰§è¡Œå®Œä»¥ä¸Šå‘½ä»¤ä¹‹åï¼Œå·¥ä½œç›®å½•å°±åˆå§‹åŒ–å®Œæˆäº†ã€‚</p><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>è¿›å…¥å·¥ä½œç›®å½•ä¼šå‘ç°æœ‰ä¸€ä¸ª<code>_config.yml</code>çš„æ–‡ä»¶ï¼Œé…ç½®å°±æ˜¯åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ å’Œä¿®æ”¹çš„ã€‚</p><p>è¿™é‡Œç®€å•ä»‹ç»ä¸€ä¸‹å‡ ä¸ªå¸¸ç”¨çš„å‚æ•°ï¼š</p><table><thead><tr><th>å‚æ•°å</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>title</code></td><td>ç½‘ç«™æ ‡é¢˜</td></tr><tr><td><code>subtitle</code></td><td>ç½‘ç«™å‰¯æ ‡é¢˜</td></tr><tr><td><code>description</code></td><td>ç½‘ç«™æè¿°</td></tr><tr><td><code>author</code></td><td>ä½ çš„åå­—</td></tr><tr><td><code>language</code></td><td>ç½‘ç«™ä½¿ç”¨çš„è¯­è¨€ï¼Œä¾‹å¦‚<code>zh-Hans</code>å°±æ˜¯æŒ‡ä¸­æ–‡</td></tr><tr><td><code>timezone</code></td><td>ç½‘ç«™æ—¶åŒºï¼Œä¾‹å¦‚<code>Asia/Shanghai</code>å°±æ˜¯æŒ‡ä¸Šæµ·æ—¶åŒº</td></tr><tr><td><code>theme</code></td><td>ç½‘ç«™ä¸»é¢˜ï¼Œä½¿ç”¨ä¹‹å‰éœ€è¦å…ˆå®‰è£…</td></tr><tr><td><code>avatar</code></td><td>ä½ çš„å¤´åƒ</td></tr><tr><td><code>favicon</code></td><td>ç½‘é¡µtagçš„å°å›¾æ ‡</td></tr></tbody></table><p>è¿™äº›çŸ¥è¯†ç®€å•ä»‹ç»ä¸€ä¸‹ï¼Œå…·ä½“çš„é…ç½®è¯´æ˜è¯¦è§<a href="https://hexo.io/zh-cn/docs/configuration.html" target="_blank" rel="external">Hexoå®˜æ–¹é…ç½®è¯´æ˜</a></p><h2 id="Hexoä¸»é¢˜Nextå®‰è£…åŠç›¸å…³é…ç½®"><a href="#Hexoä¸»é¢˜Nextå®‰è£…åŠç›¸å…³é…ç½®" class="headerlink" title="Hexoä¸»é¢˜Nextå®‰è£…åŠç›¸å…³é…ç½®"></a>Hexoä¸»é¢˜Nextå®‰è£…åŠç›¸å…³é…ç½®</h2><h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>æ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ cd &lt;folder-path&gt;</div><div class="line">$ git clone https://github.com/iissnan/hexo-theme-next themes/next</div></pre></td></tr></table></figure></p><p>å‘½ä»¤æ‰§è¡Œå®Œæˆä¹‹åï¼Œç¼–è¾‘<code>_config.yml</code>æ–‡ä»¶ï¼Œå°†<code>theme</code>å‚æ•°çš„ä¿®æ”¹æˆ<code>next</code>ã€‚</p><p>ç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œæ¸…é™¤<code>Hexo</code>ç¼“å­˜ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo clean</div></pre></td></tr></table></figure></p><h3 id="é…ç½®-1"><a href="#é…ç½®-1" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p><code>Next</code>ä¸»é¢˜ä¹Ÿæœ‰å¾ˆå¤šé…ç½®å‚æ•°ï¼Œè¿™é‡Œæˆ‘è¿˜æ˜¯ç®€å•ä»‹ç»ä¸€äº›å¸¸ç”¨çš„ï¼š</p><table><thead><tr><th>å‚æ•°å</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>scheme</code></td><td>å¤–è§‚é…ç½®ï¼Œæ”¯æŒä¸‰ç§ï¼ˆ<code>Muse</code>,<code>Mist</code>,<code>Pisces</code>ï¼‰</td></tr><tr><td><code>language</code></td><td>ç½‘ç«™è¯­è¨€ï¼Œå’Œ<code>Hexo</code>ä¸­çš„ç±»ä¼¼</td></tr><tr><td><code>menu</code></td><td>èœå•é…ç½®</td></tr></tbody></table><p>å…·ä½“çš„é…ç½®è¯´æ˜è¯¦è§<a href="http://theme-next.iissnan.com/getting-started.html#theme-settings" target="_blank" rel="external">Nextå®˜æ–¹é…ç½®è¯´æ˜</a>ã€‚</p><h2 id="å°†ç½‘ç«™æ‰˜ç®¡åˆ°githubä¸Š"><a href="#å°†ç½‘ç«™æ‰˜ç®¡åˆ°githubä¸Š" class="headerlink" title="å°†ç½‘ç«™æ‰˜ç®¡åˆ°githubä¸Š"></a>å°†ç½‘ç«™æ‰˜ç®¡åˆ°githubä¸Š</h2><h3 id="åˆ›å»ºä»“åº“"><a href="#åˆ›å»ºä»“åº“" class="headerlink" title="åˆ›å»ºä»“åº“"></a>åˆ›å»ºä»“åº“</h3><p>githubä¸­åˆ›å»ºä¸€ä¸ªä»“åº“è¿™é‡Œå°±ä¸è¯¦ç»†è¯´æ˜äº†ï¼ŒæŠŠå‡ ç‚¹æ³¨æ„äº‹é¡¹è¯´æ˜ä¸€ä¸‹ï¼š</p><ul><li><strong>ä»“åº“å¿…é¡»æ˜¯publicçš„</strong></li><li><strong>ä»“åº“åç§°è¦ä»¥yourname.github.ioçš„æ ¼å¼å‘½å</strong></li><li><strong>å°†æœ¬åœ°æœºå™¨çš„å…¬é’¥æ·»åŠ åˆ°ä½ çš„githubä¸­</strong></li></ul><h3 id="å…³è”æœ¬åœ°ç½‘ç«™åˆ°githubä»“åº“ä¸­"><a href="#å…³è”æœ¬åœ°ç½‘ç«™åˆ°githubä»“åº“ä¸­" class="headerlink" title="å…³è”æœ¬åœ°ç½‘ç«™åˆ°githubä»“åº“ä¸­"></a>å…³è”æœ¬åœ°ç½‘ç«™åˆ°githubä»“åº“ä¸­</h3><p>åœ¨<code>Hexo</code>çš„é…ç½®æ–‡ä»¶<code>_config.yml</code>ä¸­ä¿®æ”¹å¦‚ä¸‹é…ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  repository: &lt;ä½ çš„githubæ–°å»ºçš„ä»“åº“åœ°å€&gt;</div><div class="line">  branch: master</div></pre></td></tr></table></figure></p><p>ä¿®æ”¹å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ hexo clean</div><div class="line">$ hexo g</div><div class="line">$ hexo d</div></pre></td></tr></table></figure></p><p>å°†ç½‘ç«™éƒ¨ç½²åˆ°githubä¸­ã€‚</p><p>éƒ¨ç½²å®Œæˆä¹‹åä½ å¯ä»¥é€šè¿‡è®¿é—® <a href="https://yourname.github.io" target="_blank" rel="external">https://yourname.github.io</a> åœ°å€ï¼Œå¦‚æœèƒ½å¤Ÿè®¿é—®ï¼Œè¯´æ˜ä½ åœ¨æœ¬åœ°é…ç½®å¥½çš„ç½‘ç«™å·²ç»æˆåŠŸéƒ¨ç½²åˆ°githubä¸­äº†ã€‚</p><h2 id="å¦‚ä½•å¯¹æœ¬åœ°ç½‘ç«™è¿›è¡Œç‰ˆæœ¬æ§åˆ¶"><a href="#å¦‚ä½•å¯¹æœ¬åœ°ç½‘ç«™è¿›è¡Œç‰ˆæœ¬æ§åˆ¶" class="headerlink" title="å¦‚ä½•å¯¹æœ¬åœ°ç½‘ç«™è¿›è¡Œç‰ˆæœ¬æ§åˆ¶"></a>å¦‚ä½•å¯¹æœ¬åœ°ç½‘ç«™è¿›è¡Œç‰ˆæœ¬æ§åˆ¶</h2><p>è¿›è¿‡å¦‚ä¸Šæ­¥éª¤ä¹‹åä½ çš„ç½‘ç«™å·²ç»æˆåŠŸéƒ¨ç½²åˆ°githubä¸­äº†ï¼Œä½†æ˜¯å¦‚æœå¯¹ä½ çš„ç½‘ç«™è¿›è¡Œç‰ˆæœ¬æ§åˆ¶å‘¢ï¼Ÿ</p><p>æˆ‘æ˜¯å‚è€ƒ<a href="http://chitanda.me/2015/06/18/hexo-sync-in-multiple-pc/" target="_blank" rel="external">åˆ©ç”¨gitè§£å†³hexoåšå®¢å¤šPCé—´åŒæ­¥é—®é¢˜</a>è¿™ç¯‡åšå®¢çš„åšæ³•ï¼š<br>åˆ©ç”¨oschinaçš„ç§æœ‰ä»“åº“æ¥è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œåœ¨ç½‘ç«™å·¥ä½œæ ¹è·¯å¾„ä¸‹å°†è¯¥ç›®å½•é‡æ–°åˆå§‹åŒ–æˆæœ¬åœ°gitä»“åº“ï¼Œç„¶åå°†æœ¬åœ°ä»“åº“æäº¤åˆ°oschinaçš„ç§æœ‰ä»“åº“ä¸­ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hexoæ˜¯ä¸€æ¬¾å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ï¼Œç”¨å®ƒæ¥æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»æˆ‘æ˜¯å¦‚ä½•ä½¿ç”¨è¯¥æ¡†æ¶æ¥æ­å»ºè‡ªå·±çš„ä¸ªäººåšå®¢ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="åšå®¢" scheme="http://yoursite.com/categories/%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="blog" scheme="http://yoursite.com/tags/blog/"/>
    
  </entry>
  
</feed>
